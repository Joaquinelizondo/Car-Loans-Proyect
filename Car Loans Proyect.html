<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- saved from url=(1101)https://mail-attachment.googleusercontent.com/attachment/u/2/?ui=2&ik=5113226a7d&attid=0.1&permmsgid=msg-a:r489306242194221422&th=17d741ad8789dc5f&view=att&disp=inline&realattid=f_kwmzmtw65&ser=1&saddbat=ANGjdJ84PnBDA4LbNStn5wChHnm3K_vPuZhVllcGrlOQUI9JnKugcwg0-fy6BrktcTOolNRvffp3YhjKSWZUeUBN0XjzR8iu9Au9AZOiDd8hANRVARh4rEJ1874ffHrQ-ggOs9uc4PrvJAa_9Zun_DkI7KOEoJbTul2oB7yCSzT-QGLKEIu8Dk2vPNrbEk-yIE8ovRwsdS9VzC9ra7iSQjESxcr7NFWdethLSyyfMU_yZXXNfViq3DqMbO5ivNEXCdju7WWPTTNCYDMi3kPYhWb4XJsHW_QnPKI-8j-ld07TdYfkyz5ldItb6N6_fIh-96LGD9QfnuQHf9gM2tLk9fEjxHMZ3oCJ9ikWWoAzbRbG78iYwmasTDlC7ODuw9i85XQGFPVp6Z1WlDk-R0Lg14AIcA0Oncn9oGtwCqct1CX-iUniEuE5bIONSMmFIedePodV3RuCRZGSAfmC2Fy4sg7FurPk8e1vA506ZHTacOLdhOlPPZMef4fcFRMSQ_aYp5uCIfHR-FWyCPMUxUfkvpF42vprc5h_m5wtad4CRuPunhCZpqWuwBjIB3MRSSDKOfxGrTIhLvOtsQx-Q_B6CVuW3k2CnjG56iigBIoKGtyoZ0w4jSXFR5Zw6IakUy-Wf2r8_tS7MHka3cnK4Gbkfu03JMWKKXDYeQylCUpnlluNjhw-BBTo-SGv_RXtfdTiezgC_87gZDXCHq6IyngAjMpyY-%2DrhsyqV4Mw0hbg17t6wYGgllFOqAVCWjWQamzuyk_QVhuMZ9LP4OcjDWrmkc1MgkQqxzZMCfVZn9LRvP9j2upoV-PDVu0r1MK4G30HprPfk8urnwHBTZ__CxQNlTHqOyjkUSp9DCvMQO0WvYzA73Rkr7ATDsHn_Dzm1eg -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style>pre{line-height:125%}td.m_linenos .m_normal{color:inherit;background-color:transparent;padding-left:5px;padding-right:5px}span.m_linenos{color:inherit;background-color:transparent;padding-left:5px;padding-right:5px}td.m_linenos .m_special{color:#000000;background-color:#ffffc0;padding-left:5px;padding-right:5px}span.m_linenos.m_special{color:#000000;background-color:#ffffc0;padding-left:5px;padding-right:5px}.m_highlight .m_hll{background-color:var(--jp-cell-editor-active-background)}.m_highlight{background:var(--jp-cell-editor-background);color:var(--jp-mirror-editor-variable-color)}.m_highlight .m_c{color:var(--jp-mirror-editor-comment-color);font-style:italic}.m_highlight .m_err{color:var(--jp-mirror-editor-error-color)}.m_highlight .m_k{color:var(--jp-mirror-editor-keyword-color);font-weight:bold}.m_highlight .m_o{color:var(--jp-mirror-editor-operator-color);font-weight:bold}.m_highlight .m_p{color:var(--jp-mirror-editor-punctuation-color)}.m_highlight .m_ch{color:var(--jp-mirror-editor-comment-color);font-style:italic}.m_highlight .m_cm{color:var(--jp-mirror-editor-comment-color);font-style:italic}.m_highlight .m_cp{color:var(--jp-mirror-editor-comment-color);font-style:italic}.m_highlight .m_cpf{color:var(--jp-mirror-editor-comment-color);font-style:italic}.m_highlight .m_c1{color:var(--jp-mirror-editor-comment-color);font-style:italic}.m_highlight .m_cs{color:var(--jp-mirror-editor-comment-color);font-style:italic}.m_highlight .m_kc{color:var(--jp-mirror-editor-keyword-color);font-weight:bold}.m_highlight .m_kd{color:var(--jp-mirror-editor-keyword-color);font-weight:bold}.m_highlight .m_kn{color:var(--jp-mirror-editor-keyword-color);font-weight:bold}.m_highlight .m_kp{color:var(--jp-mirror-editor-keyword-color);font-weight:bold}.m_highlight .m_kr{color:var(--jp-mirror-editor-keyword-color);font-weight:bold}.m_highlight .m_kt{color:var(--jp-mirror-editor-keyword-color);font-weight:bold}.m_highlight .m_m{color:var(--jp-mirror-editor-number-color)}.m_highlight .m_s{color:var(--jp-mirror-editor-string-color)}.m_highlight .m_ow{color:var(--jp-mirror-editor-operator-color);font-weight:bold}.m_highlight .m_w{color:var(--jp-mirror-editor-variable-color)}.m_highlight .m_mb{color:var(--jp-mirror-editor-number-color)}.m_highlight .m_mf{color:var(--jp-mirror-editor-number-color)}.m_highlight .m_mh{color:var(--jp-mirror-editor-number-color)}.m_highlight .m_mi{color:var(--jp-mirror-editor-number-color)}.m_highlight .m_mo{color:var(--jp-mirror-editor-number-color)}.m_highlight .m_sa{color:var(--jp-mirror-editor-string-color)}.m_highlight .m_sb{color:var(--jp-mirror-editor-string-color)}.m_highlight .m_sc{color:var(--jp-mirror-editor-string-color)}.m_highlight .m_dl{color:var(--jp-mirror-editor-string-color)}.m_highlight .m_sd{color:var(--jp-mirror-editor-string-color)}.m_highlight .m_s2{color:var(--jp-mirror-editor-string-color)}.m_highlight .m_se{color:var(--jp-mirror-editor-string-color)}.m_highlight .m_sh{color:var(--jp-mirror-editor-string-color)}.m_highlight .m_si{color:var(--jp-mirror-editor-string-color)}.m_highlight .m_sx{color:var(--jp-mirror-editor-string-color)}.m_highlight .m_sr{color:var(--jp-mirror-editor-string-color)}.m_highlight .m_s1{color:var(--jp-mirror-editor-string-color)}.m_highlight .m_ss{color:var(--jp-mirror-editor-string-color)}.m_highlight .m_il{color:var(--jp-mirror-editor-number-color)}</style></head><body><u></u>















    






    
    
    
    
<div class="m_jp-Notebook">

<div class="m_jp-Cell-inputWrapper"><div class="m_jp-InputPrompt m_jp-InputArea-prompt">
</div><div class="m_jp-RenderedHTMLCommon m_jp-RenderedMarkdown m_jp-MarkdownOutput">
<p>PROYECTO CAR LOANS</p>
<p>Carga de las librerias</p>

</div>
</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell m_jp-mod-noOutputs">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_kn">import</span> <span class="m_nn">xgboost</span> <span class="m_k">as</span> <span class="m_nn">xgb</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell m_jp-mod-noOutputs">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_kn">import</span> <span class="m_nn">numpy</span> <span class="m_k">as</span> <span class="m_nn">np</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell m_jp-mod-noOutputs">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_kn">import</span> <span class="m_nn">pandas</span> <span class="m_k">as</span> <span class="m_nn">pd</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell m_jp-mod-noOutputs">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_kn">from</span> <span class="m_nn">sklearn.model_selection</span> <span class="m_kn">import</span> <span class="m_n">train_test_split</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell m_jp-mod-noOutputs">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_kn">from</span> <span class="m_nn">sklearn.metrics</span> <span class="m_kn">import</span> <span class="m_n">balanced_accuracy_score</span><span class="m_p">,</span> <span class="m_n">roc_auc_score</span><span class="m_p">,</span> <span class="m_n">make_scorer</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell m_jp-mod-noOutputs">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_kn">from</span> <span class="m_nn">sklearn.model_selection</span> <span class="m_kn">import</span> <span class="m_n">GridSearchCV</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell m_jp-mod-noOutputs">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_kn">from</span> <span class="m_nn">sklearn.metrics</span> <span class="m_kn">import</span> <span class="m_n">confusion_matrix</span>
<span class="m_kn">from</span> <span class="m_nn">funciones</span> <span class="m_kn">import</span> <span class="m_n">tasa_target_cat</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell m_jp-mod-noOutputs">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_kn">from</span> <span class="m_nn">sklearn.metrics</span> <span class="m_kn">import</span> <span class="m_n">plot_confusion_matrix</span>
<span class="m_kn">import</span> <span class="m_nn">matplotlib.pyplot</span> <span class="m_k">as</span> <span class="m_nn">plt</span> 
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="m_jp-Cell-inputWrapper"><div class="m_jp-InputPrompt m_jp-InputArea-prompt">
</div><div class="m_jp-RenderedHTMLCommon m_jp-RenderedMarkdown m_jp-MarkdownOutput">
<p>Lectura de los ficheros</p>

</div>
</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_n">df</span> <span class="m_o">=</span> <span class="m_n">pd</span><span class="m_o">.</span><span class="m_n">read_csv</span><span class="m_p">(</span><span class="m_s1">'car_loans_<wbr>applications.csv'</span><span class="m_p">)</span>  <span class="m_c1">#lectura de los ficheros</span>
<span class="m_n">df</span><span class="m_o">.</span><span class="m_n">shape</span>
<span class="m_n">comp</span> <span class="m_o">=</span>  <span class="m_n">pd</span><span class="m_o">.</span><span class="m_n">read_csv</span><span class="m_p">(</span><span class="m_s1">'car_loans_<wbr>behaviour.csv'</span><span class="m_p">)</span>  <span class="m_c1">#lectura de los ficheros</span>
<span class="m_nb">print</span><span class="m_p">(</span><span class="m_s2">"Solicitudes: "</span><span class="m_p">,</span> <span class="m_n">df</span><span class="m_o">.</span><span class="m_n">shape</span><span class="m_p">)</span>
<span class="m_nb">print</span><span class="m_p">(</span><span class="m_s2">"Comportamiento: "</span><span class="m_p">,</span> <span class="m_n">comp</span><span class="m_o">.</span><span class="m_n">shape</span><span class="m_p">)</span>

<span class="m_n">df</span><span class="m_o">.</span><span class="m_n">head</span><span class="m_p">(</span><span class="m_mi">10</span><span class="m_p">)</span>  <span class="m_c1"># vistazo a la cabezera del fichero</span>
<span class="m_n">df</span><span class="m_o">.</span><span class="m_n">shape</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt"></div>


<div class="m_jp-RenderedText m_jp-OutputArea-output">
<pre>Solicitudes:  (25585, 23)
Comportamiento:  (25585, 2)
</pre>
</div>
</div>

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>




<div class="m_jp-RenderedText m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<pre>(25585, 23)</pre>
</div>

</div>

</div>

</div>

</div>
<div class="m_jp-Cell-inputWrapper"><div class="m_jp-InputPrompt m_jp-InputArea-prompt">
</div><div class="m_jp-RenderedHTMLCommon m_jp-RenderedMarkdown m_jp-MarkdownOutput">

</div>
</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_n">df</span><span class="m_o">.</span><span class="m_n">describe</span><span class="m_p">()</span> <span class="m_c1"># Resumen sÃ³lo para variables numÃ©ricas</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>



<div class="m_jp-RenderedHTMLCommon m_jp-RenderedHTML m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<div>

<table border="1" class="m_dataframe">
  <thead>
    <tr style="text-align:right">
      <th></th>
      <th>product</th>
      <th>num_interveners</th>
      <th>type_doc</th>
      <th>postal_code</th>
      <th>marital_status</th>
      <th>type_home</th>
      <th>working_industry</th>
      <th>income_i1</th>
      <th>income_i2</th>
      <th>term</th>
      <th>Downpayment_ratio</th>
      <th>type_car</th>
      <th>car_status</th>
      <th>loan_amount</th>
      <th>car_price</th>
      <th>age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>25585.000000</td>
      <td>25585.000000</td>
      <td>25585.000000</td>
      <td>25472.000000</td>
      <td>25585.000000</td>
      <td>25583.000000</td>
      <td>25290.000000</td>
      <td>2.558500e+04</td>
      <td>2.558500e+04</td>
      <td>25585.000000</td>
      <td>25585.000000</td>
      <td>25585.000000</td>
      <td>25585.00000</td>
      <td>25585.000000</td>
      <td>25585.000000</td>
      <td>25585.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>3.977448</td>
      <td>1.362673</td>
      <td>1.027907</td>
      <td>24335.749176</td>
      <td>1.582255</td>
      <td>1.965055</td>
      <td>10.376552</td>
      <td>2.635981e+04</td>
      <td>6.863788e+09</td>
      <td>52.672855</td>
      <td>32.016729</td>
      <td>1.114012</td>
      <td>1.06453</td>
      <td>13081.070276</td>
      <td>19586.330819</td>
      <td>46.397850</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.244865</td>
      <td>0.516449</td>
      <td>0.164710</td>
      <td>13836.091603</td>
      <td>1.115674</td>
      <td>1.128600</td>
      <td>5.790560</td>
      <td>3.932516e+06</td>
      <td>4.639734e+09</td>
      <td>13.601531</td>
      <td>20.107692</td>
      <td>0.327642</td>
      <td>0.32824</td>
      <td>5718.492480</td>
      <td>7018.149182</td>
      <td>12.107418</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1001.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>6.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.00000</td>
      <td>1036.000000</td>
      <td>3400.000000</td>
      <td>5.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>4.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>8950.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>6.000000</td>
      <td>1.024000e+03</td>
      <td>2.000000e+03</td>
      <td>48.000000</td>
      <td>16.000000</td>
      <td>1.000000</td>
      <td>1.00000</td>
      <td>9014.000000</td>
      <td>15129.000000</td>
      <td>37.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>4.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>28027.000000</td>
      <td>1.000000</td>
      <td>2.000000</td>
      <td>10.000000</td>
      <td>1.526000e+03</td>
      <td>1.000000e+10</td>
      <td>49.000000</td>
      <td>31.000000</td>
      <td>1.000000</td>
      <td>1.00000</td>
      <td>11932.000000</td>
      <td>18779.000000</td>
      <td>46.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>4.000000</td>
      <td>2.000000</td>
      <td>1.000000</td>
      <td>32001.000000</td>
      <td>2.000000</td>
      <td>2.000000</td>
      <td>13.000000</td>
      <td>2.114000e+03</td>
      <td>1.000000e+10</td>
      <td>60.000000</td>
      <td>48.000000</td>
      <td>1.000000</td>
      <td>1.00000</td>
      <td>16258.000000</td>
      <td>22453.000000</td>
      <td>55.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>4.000000</td>
      <td>4.000000</td>
      <td>2.000000</td>
      <td>52006.000000</td>
      <td>6.000000</td>
      <td>5.000000</td>
      <td>29.000000</td>
      <td>6.290189e+08</td>
      <td>1.000000e+10</td>
      <td>84.000000</td>
      <td>94.000000</td>
      <td>3.000000</td>
      <td>3.00000</td>
      <td>67626.000000</td>
      <td>108922.000000</td>
      <td>95.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_n">df2</span><span class="m_o">.</span><span class="m_n">head</span><span class="m_p">(</span><span class="m_mi">10</span><span class="m_p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>



<div class="m_jp-RenderedHTMLCommon m_jp-RenderedHTML m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<div>

<table border="1" class="m_dataframe">
  <thead>
    <tr style="text-align:right">
      <th></th>
      <th>con_id</th>
      <th>date</th>
      <th>product</th>
      <th>num_interveners</th>
      <th>type_doc</th>
      <th>postal_code</th>
      <th>marital_status</th>
      <th>type_home</th>
      <th>working_status</th>
      <th>working_industry</th>
      <th>...</th>
      <th>car_status</th>
      <th>date_current_home</th>
      <th>date_current_job</th>
      <th>car_model</th>
      <th>loan_amount</th>
      <th>car_price</th>
      <th>age</th>
      <th>car_brand</th>
      <th>bad</th>
      <th>provincia</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10586c33j51</td>
      <td>23/05/14</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>8230.0</td>
      <td>1</td>
      <td>2.0</td>
      <td>F</td>
      <td>1.0</td>
      <td>...</td>
      <td>2</td>
      <td>01/01/98</td>
      <td>05/01/84</td>
      <td>NaN</td>
      <td>1866</td>
      <td>6866</td>
      <td>57</td>
      <td>STONE</td>
      <td>0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10972i93j52</td>
      <td>05/03/15</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>11500.0</td>
      <td>5</td>
      <td>1.0</td>
      <td>F</td>
      <td>13.0</td>
      <td>...</td>
      <td>2</td>
      <td>15/08/00</td>
      <td>01/01/11</td>
      <td>HAT2</td>
      <td>8068</td>
      <td>8068</td>
      <td>56</td>
      <td>STONE</td>
      <td>0</td>
      <td>11.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11449c34j54</td>
      <td>09/04/13</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>28290.0</td>
      <td>1</td>
      <td>1.0</td>
      <td>F</td>
      <td>17.0</td>
      <td>...</td>
      <td>2</td>
      <td>01/07/00</td>
      <td>10/05/86</td>
      <td>HAT1</td>
      <td>9015</td>
      <td>9204</td>
      <td>48</td>
      <td>STONE</td>
      <td>0</td>
      <td>28.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11700h83j52</td>
      <td>22/08/12</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>15011.0</td>
      <td>1</td>
      <td>1.0</td>
      <td>F</td>
      <td>11.0</td>
      <td>...</td>
      <td>2</td>
      <td>10/02/03</td>
      <td>10/03/93</td>
      <td>HAT3</td>
      <td>9637</td>
      <td>10685</td>
      <td>44</td>
      <td>STONE</td>
      <td>0</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12252d43j53</td>
      <td>29/02/12</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>12580.0</td>
      <td>5</td>
      <td>2.0</td>
      <td>N</td>
      <td>10.0</td>
      <td>...</td>
      <td>1</td>
      <td>01/01/10</td>
      <td>NaN</td>
      <td>HAT2</td>
      <td>9217</td>
      <td>17467</td>
      <td>53</td>
      <td>STONE</td>
      <td>0</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>12467e53j51</td>
      <td>30/01/12</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>28039.0</td>
      <td>1</td>
      <td>2.0</td>
      <td>N</td>
      <td>10.0</td>
      <td>...</td>
      <td>1</td>
      <td>01/11/90</td>
      <td>NaN</td>
      <td>HAT1</td>
      <td>10481</td>
      <td>14481</td>
      <td>52</td>
      <td>STONE</td>
      <td>0</td>
      <td>28.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>12702b23j52</td>
      <td>10/01/12</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>28036.0</td>
      <td>1</td>
      <td>1.0</td>
      <td>N</td>
      <td>10.0</td>
      <td>...</td>
      <td>1</td>
      <td>01/06/99</td>
      <td>NaN</td>
      <td>COM1</td>
      <td>9417</td>
      <td>9417</td>
      <td>39</td>
      <td>STONE</td>
      <td>0</td>
      <td>28.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>12723c33j53</td>
      <td>09/03/12</td>
      <td>4</td>
      <td>3</td>
      <td>1</td>
      <td>46182.0</td>
      <td>1</td>
      <td>1.0</td>
      <td>N</td>
      <td>10.0</td>
      <td>...</td>
      <td>1</td>
      <td>01/09/94</td>
      <td>NaN</td>
      <td>HAT2</td>
      <td>19716</td>
      <td>19716</td>
      <td>53</td>
      <td>STONE</td>
      <td>1</td>
      <td>46.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>12732e53j52</td>
      <td>09/01/12</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>47161.0</td>
      <td>6</td>
      <td>2.0</td>
      <td>F</td>
      <td>16.0</td>
      <td>...</td>
      <td>1</td>
      <td>01/03/89</td>
      <td>21/01/88</td>
      <td>HAT3</td>
      <td>21577</td>
      <td>21577</td>
      <td>46</td>
      <td>STONE</td>
      <td>0</td>
      <td>47.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>12738i93j51</td>
      <td>03/01/12</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>47010.0</td>
      <td>2</td>
      <td>4.0</td>
      <td>T</td>
      <td>9.0</td>
      <td>...</td>
      <td>1</td>
      <td>01/02/85</td>
      <td>12/09/11</td>
      <td>HAT2</td>
      <td>10275</td>
      <td>16845</td>
      <td>25</td>
      <td>STONE</td>
      <td>0</td>
      <td>47.0</td>
    </tr>
  </tbody>
</table>
<p>10 rows Ã 25 columns</p>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="m_jp-Cell-inputWrapper"><div class="m_jp-InputPrompt m_jp-InputArea-prompt">
</div><div class="m_jp-RenderedHTMLCommon m_jp-RenderedMarkdown m_jp-MarkdownOutput">
<p>df['type_doc'].unique()</p>

</div>
</div>
<div class="m_jp-Cell-inputWrapper"><div class="m_jp-InputPrompt m_jp-InputArea-prompt">
</div><div class="m_jp-RenderedHTMLCommon m_jp-RenderedMarkdown m_jp-MarkdownOutput">
<p>Ver Atributos de un Dataframe</p>

</div>
</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_nb">list</span><span class="m_p">(</span><span class="m_n">df</span><span class="m_o">.</span><span class="m_n">columns</span><span class="m_p">)</span> <span class="m_c1"># Para ver la lista de columnas</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>




<div class="m_jp-RenderedText m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<pre>['con_id',
 'date',
 'product',
 'num_interveners',
 'type_doc',
 'postal_code',
 'marital_status',
 'type_home',
 'working_status',
 'working_industry',
 'income_i1',
 'income_i2',
 'term',
 'Downpayment_ratio',
 'type_car',
 'car_status',
 'date_current_home',
 'date_current_job',
 'car_model',
 'loan_amount',
 'car_price',
 'age',
 'car_brand']</pre>
</div>

</div>

</div>

</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_n">df</span><span class="m_o">.</span><span class="m_n">dtypes</span> <span class="m_c1"># Para ver los tipos de las variables que tenemos</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>




<div class="m_jp-RenderedText m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<pre>con_id                object
date                  object
product                int64
num_interveners        int64
type_doc               int64
postal_code          float64
marital_status         int64
type_home            float64
working_status        object
working_industry     float64
income_i1              int64
income_i2              int64
term                   int64
Downpayment_ratio      int64
type_car               int64
car_status             int64
date_current_home     object
date_current_job      object
car_model             object
loan_amount            int64
car_price              int64
age                    int64
car_brand             object
dtype: object</pre>
</div>

</div>

</div>

</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_n">df</span><span class="m_o">.</span><span class="m_n">info</span><span class="m_p">()</span> <span class="m_c1"># MÃ©todo para ver todo junto</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt"></div>


<div class="m_jp-RenderedText m_jp-OutputArea-output">
<pre>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 25585 entries, 0 to 25584
Data columns (total 23 columns):
 #   Column             Non-Null Count  Dtype  
---  ------             --------------  -----  
 0   con_id             25585 non-null  object 
 1   date               25585 non-null  object 
 2   product            25585 non-null  int64  
 3   num_interveners    25585 non-null  int64  
 4   type_doc           25585 non-null  int64  
 5   postal_code        25472 non-null  float64
 6   marital_status     25585 non-null  int64  
 7   type_home          25583 non-null  float64
 8   working_status     25585 non-null  object 
 9   working_industry   25290 non-null  float64
 10  income_i1          25585 non-null  int64  
 11  income_i2          25585 non-null  int64  
 12  term               25585 non-null  int64  
 13  Downpayment_ratio  25585 non-null  int64  
 14  type_car           25585 non-null  int64  
 15  car_status         25585 non-null  int64  
 16  date_current_home  25579 non-null  object 
 17  date_current_job   20751 non-null  object 
 18  car_model          21982 non-null  object 
 19  loan_amount        25585 non-null  int64  
 20  car_price          25585 non-null  int64  
 21  age                25585 non-null  int64  
 22  car_brand          25573 non-null  object 
dtypes: float64(3), int64(13), object(7)
memory usage: 4.5+ MB
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="m_jp-Cell-inputWrapper"><div class="m_jp-InputPrompt m_jp-InputArea-prompt">
</div><div class="m_jp-RenderedHTMLCommon m_jp-RenderedMarkdown m_jp-MarkdownOutput">

</div>
</div>
<div class="m_jp-Cell-inputWrapper"><div class="m_jp-InputPrompt m_jp-InputArea-prompt">
</div><div class="m_jp-RenderedHTMLCommon m_jp-RenderedMarkdown m_jp-MarkdownOutput">
<p>Acceso a informacion concreta dentro del fichero</p>

</div>
</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_n">df</span><span class="m_o">.</span><span class="m_n">loc</span><span class="m_p">[</span><span class="m_mi">9</span><span class="m_p">]</span> <span class="m_c1"># Para acceder a toda la informaciÃ³n del cliente 9 con toda la informacion</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>




<div class="m_jp-RenderedText m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<pre>con_id               12738i93j51
date                    03/01/12
product                        4
num_interveners                2
type_doc                       1
postal_code              47010.0
marital_status                 2
type_home                    4.0
working_status                 T
working_industry             9.0
income_i1                   1400
income_i2                    995
term                          60
Downpayment_ratio             39
type_car                       1
car_status                     1
date_current_home       01/02/85
date_current_job        12/09/11
car_model                   HAT2
loan_amount                10275
car_price                  16845
age                           25
car_brand                  STONE
Name: 9, dtype: object</pre>
</div>

</div>

</div>

</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_n">df</span><span class="m_o">.</span><span class="m_n">loc</span><span class="m_p">[</span><span class="m_mi">4</span><span class="m_p">][</span><span class="m_s1">'car_price'</span><span class="m_p">]</span> <span class="m_c1"># Para acceder al precio del automovil del pasajero 4.</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>




<div class="m_jp-RenderedText m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<pre>17467</pre>
</div>

</div>

</div>

</div>

</div>
<div class="m_jp-Cell-inputWrapper"><div class="m_jp-InputPrompt m_jp-InputArea-prompt">
</div><div class="m_jp-RenderedHTMLCommon m_jp-RenderedMarkdown m_jp-MarkdownOutput">
<p>Estadisticos basicos de variables</p>

</div>
</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_n">df</span><span class="m_p">[</span><span class="m_s1">'car_price'</span><span class="m_p">]</span><span class="m_o">.</span><span class="m_n">mean</span><span class="m_p">()</span> <span class="m_c1"># Precio medio pagado por los automoviles</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>




<div class="m_jp-RenderedText m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<pre>19586.330818839164</pre>
</div>

</div>

</div>

</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_n">df</span><span class="m_p">[</span><span class="m_s1">'age'</span><span class="m_p">]</span><span class="m_o">.</span><span class="m_n">max</span><span class="m_p">()</span> <span class="m_c1"># Edad maxima registrada de cliente</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>




<div class="m_jp-RenderedText m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<pre>95</pre>
</div>

</div>

</div>

</div>

</div>
<div class="m_jp-Cell-inputWrapper"><div class="m_jp-InputPrompt m_jp-InputArea-prompt">
</div><div class="m_jp-RenderedHTMLCommon m_jp-RenderedMarkdown m_jp-MarkdownOutput">
<p>Manipulacion de DATAFRAME</p>

</div>
</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_n">df2</span> <span class="m_o">=</span> <span class="m_n">pd</span><span class="m_o">.</span><span class="m_n">merge</span><span class="m_p">(</span><span class="m_n">df</span><span class="m_p">,</span> <span class="m_n">comp</span><span class="m_p">,</span> <span class="m_n">on</span> <span class="m_o">=</span> <span class="m_s1">'con_id'</span><span class="m_p">)</span>
<span class="m_n">df2</span><span class="m_o">.</span><span class="m_n">head</span><span class="m_p">(</span><span class="m_mi">10</span><span class="m_p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>



<div class="m_jp-RenderedHTMLCommon m_jp-RenderedHTML m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<div>

<table border="1" class="m_dataframe">
  <thead>
    <tr style="text-align:right">
      <th></th>
      <th>con_id</th>
      <th>date</th>
      <th>product</th>
      <th>num_interveners</th>
      <th>type_doc</th>
      <th>postal_code</th>
      <th>marital_status</th>
      <th>type_home</th>
      <th>working_status</th>
      <th>working_industry</th>
      <th>...</th>
      <th>type_car</th>
      <th>car_status</th>
      <th>date_current_home</th>
      <th>date_current_job</th>
      <th>car_model</th>
      <th>loan_amount</th>
      <th>car_price</th>
      <th>age</th>
      <th>car_brand</th>
      <th>bad</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10586c33j51</td>
      <td>23/05/14</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>8230.0</td>
      <td>1</td>
      <td>2.0</td>
      <td>F</td>
      <td>1.0</td>
      <td>...</td>
      <td>2</td>
      <td>2</td>
      <td>01/01/98</td>
      <td>05/01/84</td>
      <td>NaN</td>
      <td>1866</td>
      <td>6866</td>
      <td>57</td>
      <td>STONE</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10972i93j52</td>
      <td>05/03/15</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>11500.0</td>
      <td>5</td>
      <td>1.0</td>
      <td>F</td>
      <td>13.0</td>
      <td>...</td>
      <td>1</td>
      <td>2</td>
      <td>15/08/00</td>
      <td>01/01/11</td>
      <td>HAT2</td>
      <td>8068</td>
      <td>8068</td>
      <td>56</td>
      <td>STONE</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11449c34j54</td>
      <td>09/04/13</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>28290.0</td>
      <td>1</td>
      <td>1.0</td>
      <td>F</td>
      <td>17.0</td>
      <td>...</td>
      <td>1</td>
      <td>2</td>
      <td>01/07/00</td>
      <td>10/05/86</td>
      <td>HAT1</td>
      <td>9015</td>
      <td>9204</td>
      <td>48</td>
      <td>STONE</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11700h83j52</td>
      <td>22/08/12</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>15011.0</td>
      <td>1</td>
      <td>1.0</td>
      <td>F</td>
      <td>11.0</td>
      <td>...</td>
      <td>1</td>
      <td>2</td>
      <td>10/02/03</td>
      <td>10/03/93</td>
      <td>HAT3</td>
      <td>9637</td>
      <td>10685</td>
      <td>44</td>
      <td>STONE</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12252d43j53</td>
      <td>29/02/12</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>12580.0</td>
      <td>5</td>
      <td>2.0</td>
      <td>N</td>
      <td>10.0</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>01/01/10</td>
      <td>NaN</td>
      <td>HAT2</td>
      <td>9217</td>
      <td>17467</td>
      <td>53</td>
      <td>STONE</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>12467e53j51</td>
      <td>30/01/12</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>28039.0</td>
      <td>1</td>
      <td>2.0</td>
      <td>N</td>
      <td>10.0</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>01/11/90</td>
      <td>NaN</td>
      <td>HAT1</td>
      <td>10481</td>
      <td>14481</td>
      <td>52</td>
      <td>STONE</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>12702b23j52</td>
      <td>10/01/12</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>28036.0</td>
      <td>1</td>
      <td>1.0</td>
      <td>N</td>
      <td>10.0</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>01/06/99</td>
      <td>NaN</td>
      <td>COM1</td>
      <td>9417</td>
      <td>9417</td>
      <td>39</td>
      <td>STONE</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>12723c33j53</td>
      <td>09/03/12</td>
      <td>4</td>
      <td>3</td>
      <td>1</td>
      <td>46182.0</td>
      <td>1</td>
      <td>1.0</td>
      <td>N</td>
      <td>10.0</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>01/09/94</td>
      <td>NaN</td>
      <td>HAT2</td>
      <td>19716</td>
      <td>19716</td>
      <td>53</td>
      <td>STONE</td>
      <td>1</td>
    </tr>
    <tr>
      <th>8</th>
      <td>12732e53j52</td>
      <td>09/01/12</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>47161.0</td>
      <td>6</td>
      <td>2.0</td>
      <td>F</td>
      <td>16.0</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>01/03/89</td>
      <td>21/01/88</td>
      <td>HAT3</td>
      <td>21577</td>
      <td>21577</td>
      <td>46</td>
      <td>STONE</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>12738i93j51</td>
      <td>03/01/12</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>47010.0</td>
      <td>2</td>
      <td>4.0</td>
      <td>T</td>
      <td>9.0</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>01/02/85</td>
      <td>12/09/11</td>
      <td>HAT2</td>
      <td>10275</td>
      <td>16845</td>
      <td>25</td>
      <td>STONE</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>10 rows Ã 24 columns</p>
</div>
</div>

</div>

</div>

</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_n">df2</span><span class="m_o">.</span><span class="m_n">describe</span><span class="m_p">(</span><span class="m_n">include</span><span class="m_o">=</span><span class="m_s1">'all'</span><span class="m_p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>



<div class="m_jp-RenderedHTMLCommon m_jp-RenderedHTML m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<div>

<table border="1" class="m_dataframe">
  <thead>
    <tr style="text-align:right">
      <th></th>
      <th>con_id</th>
      <th>date</th>
      <th>product</th>
      <th>num_interveners</th>
      <th>type_doc</th>
      <th>postal_code</th>
      <th>marital_status</th>
      <th>type_home</th>
      <th>working_status</th>
      <th>working_industry</th>
      <th>...</th>
      <th>type_car</th>
      <th>car_status</th>
      <th>date_current_home</th>
      <th>date_current_job</th>
      <th>car_model</th>
      <th>loan_amount</th>
      <th>car_price</th>
      <th>age</th>
      <th>car_brand</th>
      <th>bad</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>25585</td>
      <td>25585</td>
      <td>25585.000000</td>
      <td>25585.000000</td>
      <td>25585.000000</td>
      <td>25472.000000</td>
      <td>25585.000000</td>
      <td>25583.000000</td>
      <td>25585</td>
      <td>25290.000000</td>
      <td>...</td>
      <td>25585.000000</td>
      <td>25585.00000</td>
      <td>25579</td>
      <td>20751</td>
      <td>21982</td>
      <td>25585.000000</td>
      <td>25585.000000</td>
      <td>25585.000000</td>
      <td>25573</td>
      <td>25585.000000</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>25585</td>
      <td>1493</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7238</td>
      <td>6713</td>
      <td>14</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>top</th>
      <td>24623b23j50</td>
      <td>30/10/14</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>F</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>01/01/00</td>
      <td>01/01/00</td>
      <td>HAT2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>STONE</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>1</td>
      <td>87</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15332</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>974</td>
      <td>256</td>
      <td>6527</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>24286</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.977448</td>
      <td>1.362673</td>
      <td>1.027907</td>
      <td>24335.749176</td>
      <td>1.582255</td>
      <td>1.965055</td>
      <td>NaN</td>
      <td>10.376552</td>
      <td>...</td>
      <td>1.114012</td>
      <td>1.06453</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>13081.070276</td>
      <td>19586.330819</td>
      <td>46.397850</td>
      <td>NaN</td>
      <td>0.015282</td>
    </tr>
    <tr>
      <th>std</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.244865</td>
      <td>0.516449</td>
      <td>0.164710</td>
      <td>13836.091603</td>
      <td>1.115674</td>
      <td>1.128600</td>
      <td>NaN</td>
      <td>5.790560</td>
      <td>...</td>
      <td>0.327642</td>
      <td>0.32824</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5718.492480</td>
      <td>7018.149182</td>
      <td>12.107418</td>
      <td>NaN</td>
      <td>0.122676</td>
    </tr>
    <tr>
      <th>min</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1001.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>NaN</td>
      <td>1.000000</td>
      <td>...</td>
      <td>1.000000</td>
      <td>1.00000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1036.000000</td>
      <td>3400.000000</td>
      <td>5.000000</td>
      <td>NaN</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>8950.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>NaN</td>
      <td>6.000000</td>
      <td>...</td>
      <td>1.000000</td>
      <td>1.00000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>9014.000000</td>
      <td>15129.000000</td>
      <td>37.000000</td>
      <td>NaN</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>28027.000000</td>
      <td>1.000000</td>
      <td>2.000000</td>
      <td>NaN</td>
      <td>10.000000</td>
      <td>...</td>
      <td>1.000000</td>
      <td>1.00000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>11932.000000</td>
      <td>18779.000000</td>
      <td>46.000000</td>
      <td>NaN</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.000000</td>
      <td>2.000000</td>
      <td>1.000000</td>
      <td>32001.000000</td>
      <td>2.000000</td>
      <td>2.000000</td>
      <td>NaN</td>
      <td>13.000000</td>
      <td>...</td>
      <td>1.000000</td>
      <td>1.00000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>16258.000000</td>
      <td>22453.000000</td>
      <td>55.000000</td>
      <td>NaN</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.000000</td>
      <td>4.000000</td>
      <td>2.000000</td>
      <td>52006.000000</td>
      <td>6.000000</td>
      <td>5.000000</td>
      <td>NaN</td>
      <td>29.000000</td>
      <td>...</td>
      <td>3.000000</td>
      <td>3.00000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>67626.000000</td>
      <td>108922.000000</td>
      <td>95.000000</td>
      <td>NaN</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
<p>11 rows Ã 24 columns</p>
</div>
</div>

</div>

</div>

</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_c1">#Cual es la distribucion de "malos"</span>
<span class="m_n">df2</span><span class="m_p">[</span><span class="m_n">df2</span><span class="m_p">[</span><span class="m_s1">'bad'</span><span class="m_p">]</span><span class="m_o">==</span><span class="m_mi">1</span><span class="m_p">][</span><span class="m_s1">'bad'</span><span class="m_p">]</span><span class="m_o">.</span><span class="m_n">coun<wbr>t</span><span class="m_p">()</span>
<span class="m_n">df2</span><span class="m_p">[</span><span class="m_s1">'bad'</span><span class="m_p">]</span><span class="m_o">.</span><span class="m_n">sum</span><span class="m_p">()</span> <span class="m_c1">#otra forma de hacerlo</span>
<span class="m_n">df2</span><span class="m_p">[</span><span class="m_s1">'bad'</span><span class="m_p">]</span><span class="m_o">.</span><span class="m_n">value_counts</span><span class="m_p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>




<div class="m_jp-RenderedText m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<pre>0    25194
1      391
Name: bad, dtype: int64</pre>
</div>

</div>

</div>

</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_c1">#Ahora observamos los missing values</span>
<span class="m_n">df2</span><span class="m_o">.</span><span class="m_n">isnull</span><span class="m_p">()</span><span class="m_o">.</span><span class="m_n">sum</span><span class="m_p">()</span><span class="m_o">/</span><span class="m_nb">len</span><span class="m_p">(</span><span class="m_n">df2</span><span class="m_p">)</span><span class="m_o">*</span><span class="m_mi">10<wbr>0</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>




<div class="m_jp-RenderedText m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<pre>con_id                0.000000
date                  0.000000
product               0.000000
num_interveners       0.000000
type_doc              0.000000
postal_code           0.441665
marital_status        0.000000
type_home             0.007817
working_status        0.000000
working_industry      1.153019
income_i1             0.000000
income_i2             0.000000
term                  0.000000
Downpayment_ratio     0.000000
type_car              0.000000
car_status            0.000000
date_current_home     0.023451
date_current_job     18.893883
car_model            14.082470
loan_amount           0.000000
car_price             0.000000
age                   0.000000
car_brand             0.046902
bad                   0.000000
dtype: float64</pre>
</div>

</div>

</div>

</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_c1">#Obervamos valores de codigo postal</span>
<span class="m_n">df2</span><span class="m_p">[</span><span class="m_s1">'postal_code'</span><span class="m_p">]</span><span class="m_o">.</span><span class="m_n">value_<wbr>counts</span><span class="m_p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>




<div class="m_jp-RenderedText m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<pre>11500.0    146
11100.0    133
28050.0    126
28850.0    117
28035.0     96
          ... 
43774.0      1
8717.0       1
32701.0      1
36863.0      1
28492.0      1
Name: postal_code, Length: 3775, dtype: int64</pre>
</div>

</div>

</div>

</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_n">df2</span><span class="m_p">[</span><span class="m_s1">'postal_code'</span><span class="m_p">]</span><span class="m_o">.</span><span class="m_n">dtype</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>




<div class="m_jp-RenderedText m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<pre>dtype('float64')</pre>
</div>

</div>

</div>

</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell m_jp-mod-noOutputs">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_c1">#Observamos los missing values de postal code a la provincia de Madrid</span>
<span class="m_n">df2</span><span class="m_p">[</span><span class="m_s1">'provincia'</span><span class="m_p">]</span><span class="m_o">=</span><span class="m_n">np</span><span class="m_o">.</span><span class="m_n">floor</span><span class="m_p">(</span><span class="m_n">df2</span><span class="m_p">[</span><span class="m_s1"><wbr>'postal_code'</span><span class="m_p">]</span><span class="m_o">/</span><span class="m_mi">1000</span><span class="m_p">)</span><span class="m_o">.</span><span class="m_n">fillna</span><span class="m_p">(</span><span class="m_mi">28</span><span class="m_p"><wbr>)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_n">df2</span><span class="m_p">[</span><span class="m_s1">'provincia'</span><span class="m_p">]</span><span class="m_o">.</span><span class="m_n">value_counts</span><span class="m_p">(<wbr>)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>




<div class="m_jp-RenderedText m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<pre>28.0    6174
8.0     4000
41.0    1306
46.0    1175
11.0    1015
7.0      788
15.0     738
29.0     669
3.0      665
48.0     586
43.0     554
17.0     531
30.0     449
50.0     396
33.0     395
39.0     366
6.0      350
18.0     347
36.0     333
14.0     317
31.0     310
45.0     287
12.0     254
21.0     252
20.0     249
4.0      249
1.0      248
24.0     246
26.0     194
47.0     179
32.0     173
25.0     172
19.0     162
9.0      153
37.0     118
35.0     116
13.0     102
23.0     101
2.0       98
10.0      95
27.0      94
22.0      87
38.0      86
5.0       75
51.0      62
49.0      50
40.0      47
34.0      47
44.0      43
52.0      42
42.0      20
16.0      20
Name: provincia, dtype: int64</pre>
</div>

</div>

</div>

</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_n">tasa_target_cat</span><span class="m_p">(</span><span class="m_n">dataframe</span><span class="m_o">=</span><span class="m_n">df2</span><span class="m_p">,</span> <span class="m_n">variable</span><span class="m_o">=</span><span class="m_s1">'type_doc'</span><span class="m_p">,</span> <span class="m_n">target</span><span class="m_o">=</span><span class="m_s1">'bad'</span><span class="m_p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>



<div class="m_jp-RenderedHTMLCommon m_jp-RenderedHTML m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<div>

<table border="1" class="m_dataframe">
  <thead>
    <tr style="text-align:right">
      <th></th>
      <th># Tot</th>
      <th># Target</th>
      <th>Target Rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>24871</td>
      <td>371</td>
      <td>0.014917</td>
    </tr>
    <tr>
      <th>2</th>
      <td>714</td>
      <td>20</td>
      <td>0.028011</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_c1">#Probamos con la variable Product</span>
<span class="m_n">tasa_target_cat</span><span class="m_p">(</span><span class="m_n">dataframe</span><span class="m_o">=</span><span class="m_n">df2</span><span class="m_p">,</span> <span class="m_n">variable</span><span class="m_o">=</span><span class="m_s1">'product'</span><span class="m_p">,</span> <span class="m_n">target</span><span class="m_o">=</span><span class="m_s1">'bad'</span><span class="m_p">)</span> 
<span class="m_c1">#Leasing y renting tienen una tasa de impago mas alta que el sistema normal</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>



<div class="m_jp-RenderedHTMLCommon m_jp-RenderedHTML m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<div>

<table border="1" class="m_dataframe">
  <thead>
    <tr style="text-align:right">
      <th></th>
      <th># Tot</th>
      <th># Target</th>
      <th>Target Rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>131</td>
      <td>3</td>
      <td>0.022901</td>
    </tr>
    <tr>
      <th>2</th>
      <td>92</td>
      <td>5</td>
      <td>0.054348</td>
    </tr>
    <tr>
      <th>4</th>
      <td>25362</td>
      <td>383</td>
      <td>0.015101</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_c1">#Observamos segun car_status</span>
<span class="m_n">tasa_target_cat</span><span class="m_p">(</span><span class="m_n">dataframe</span><span class="m_o">=</span><span class="m_n">df2</span><span class="m_p">,</span> <span class="m_n">variable</span><span class="m_o">=</span><span class="m_s1">'car_status'</span><span class="m_p">,</span> <span class="m_n">target</span><span class="m_o">=</span><span class="m_s1">'bad'</span><span class="m_p">)</span> 
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>



<div class="m_jp-RenderedHTMLCommon m_jp-RenderedHTML m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<div>

<table border="1" class="m_dataframe">
  <thead>
    <tr style="text-align:right">
      <th></th>
      <th># Tot</th>
      <th># Target</th>
      <th>Target Rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>24540</td>
      <td>358</td>
      <td>0.014588</td>
    </tr>
    <tr>
      <th>2</th>
      <td>439</td>
      <td>17</td>
      <td>0.038724</td>
    </tr>
    <tr>
      <th>3</th>
      <td>606</td>
      <td>16</td>
      <td>0.026403</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="m_jp-Cell-inputWrapper"><div class="m_jp-InputPrompt m_jp-InputArea-prompt">
</div><div class="m_jp-RenderedHTMLCommon m_jp-RenderedMarkdown m_jp-MarkdownOutput">

</div>
</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_c1">#Segun Marital Status</span>
<span class="m_n">tasa_target_cat</span><span class="m_p">(</span><span class="m_n">dataframe</span><span class="m_o">=</span><span class="m_n">df2</span><span class="m_p">,</span> <span class="m_n">variable</span><span class="m_o">=</span><span class="m_s1">'marital_status'</span><span class="m_p">,</span> <span class="m_n">target</span><span class="m_o">=</span><span class="m_s1">'bad'</span><span class="m_p">)</span> 
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>



<div class="m_jp-RenderedHTMLCommon m_jp-RenderedHTML m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<div>

<table border="1" class="m_dataframe">
  <thead>
    <tr style="text-align:right">
      <th></th>
      <th># Tot</th>
      <th># Target</th>
      <th>Target Rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>17204</td>
      <td>219</td>
      <td>0.012730</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5788</td>
      <td>124</td>
      <td>0.021424</td>
    </tr>
    <tr>
      <th>3</th>
      <td>605</td>
      <td>7</td>
      <td>0.011570</td>
    </tr>
    <tr>
      <th>4</th>
      <td>490</td>
      <td>7</td>
      <td>0.014286</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1061</td>
      <td>23</td>
      <td>0.021678</td>
    </tr>
    <tr>
      <th>6</th>
      <td>437</td>
      <td>11</td>
      <td>0.025172</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="m_jp-Cell-inputWrapper"><div class="m_jp-InputPrompt m_jp-InputArea-prompt">
</div><div class="m_jp-RenderedHTMLCommon m_jp-RenderedMarkdown m_jp-MarkdownOutput">
<p>En este caso observamos que la variable marital status es sensible segun el tipo a riesgo de impago, ya que vemos diferencias notorias por tipo de marital status.
Por ejemplo, en promedio, el tipo 6 duplica al tipo 1 en riesgo de impago.</p>

</div>
</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_n">tasa_target_cat</span><span class="m_p">(</span><span class="m_n">dataframe</span><span class="m_o">=</span><span class="m_n">df2</span><span class="m_p">,</span> <span class="m_n">variable</span><span class="m_o">=</span><span class="m_s1">'car_brand'</span><span class="m_p">,</span> <span class="m_n">target</span><span class="m_o">=</span><span class="m_s1">'bad'</span><span class="m_p">)</span> 
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>



<div class="m_jp-RenderedHTMLCommon m_jp-RenderedHTML m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<div>

<table border="1" class="m_dataframe">
  <thead>
    <tr style="text-align:right">
      <th></th>
      <th># Tot</th>
      <th># Target</th>
      <th>Target Rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>PLIC</th>
      <td>1287</td>
      <td>15</td>
      <td>0.011655</td>
    </tr>
    <tr>
      <th>STONE</th>
      <td>24286</td>
      <td>376</td>
      <td>0.015482</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="m_jp-Cell-inputWrapper"><div class="m_jp-InputPrompt m_jp-InputArea-prompt">
</div><div class="m_jp-RenderedHTMLCommon m_jp-RenderedMarkdown m_jp-MarkdownOutput">
<p>En este caso vemos que la variabla num_interveners es sensible al aumento de los solicitantes, ya que a medida que aumenta la cantidad de solicitantes el riesgo de impago aumenta.</p>

</div>
</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_n">tasa_target_cat</span><span class="m_p">(</span><span class="m_n">dataframe</span><span class="m_o">=</span><span class="m_n">df2</span><span class="m_p">,</span> <span class="m_n">variable</span><span class="m_o">=</span><span class="m_s1">'num_interveners'</span><span class="m_p">,</span> <span class="m_n">target</span><span class="m_o">=</span><span class="m_s1">'bad'</span><span class="m_p">)</span> 
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>



<div class="m_jp-RenderedHTMLCommon m_jp-RenderedHTML m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<div>

<table border="1" class="m_dataframe">
  <thead>
    <tr style="text-align:right">
      <th></th>
      <th># Tot</th>
      <th># Target</th>
      <th>Target Rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>16752</td>
      <td>193.0</td>
      <td>0.011521</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8396</td>
      <td>187.0</td>
      <td>0.022273</td>
    </tr>
    <tr>
      <th>3</th>
      <td>428</td>
      <td>11.0</td>
      <td>0.025701</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="m_jp-Cell-inputWrapper"><div class="m_jp-InputPrompt m_jp-InputArea-prompt">
</div><div class="m_jp-RenderedHTMLCommon m_jp-RenderedMarkdown m_jp-MarkdownOutput">
<p>En este caso, obervamos que la variable num_interveners puede ayudar  a explicar el modelo, ya que por ejemplo el riesgo de impago del tipo 1, es la mitad del tipo 3.</p>

</div>
</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_n">tasa_target_cat</span><span class="m_p">(</span><span class="m_n">dataframe</span><span class="m_o">=</span><span class="m_n">df2</span><span class="m_p">,</span> <span class="m_n">variable</span><span class="m_o">=</span><span class="m_s1">'type_car'</span><span class="m_p">,</span> <span class="m_n">target</span><span class="m_o">=</span><span class="m_s1">'bad'</span><span class="m_p">)</span> 
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>



<div class="m_jp-RenderedHTMLCommon m_jp-RenderedHTML m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<div>

<table border="1" class="m_dataframe">
  <thead>
    <tr style="text-align:right">
      <th></th>
      <th># Tot</th>
      <th># Target</th>
      <th>Target Rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>22749</td>
      <td>359</td>
      <td>0.015781</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2755</td>
      <td>29</td>
      <td>0.010526</td>
    </tr>
    <tr>
      <th>3</th>
      <td>81</td>
      <td>3</td>
      <td>0.037037</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="m_jp-Cell-inputWrapper"><div class="m_jp-InputPrompt m_jp-InputArea-prompt">
</div><div class="m_jp-RenderedHTMLCommon m_jp-RenderedMarkdown m_jp-MarkdownOutput">
<p>En este caso vemos que el riesgo de impago aumenta  a medida que aumenta el plazo del prestamo a traves de la variable "term".</p>

</div>
</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_n">tasa_target_cat</span><span class="m_p">(</span><span class="m_n">dataframe</span><span class="m_o">=</span><span class="m_n">df2</span><span class="m_p">,</span> <span class="m_n">variable</span><span class="m_o">=</span><span class="m_s1">'term'</span><span class="m_p">,</span> <span class="m_n">target</span><span class="m_o">=</span><span class="m_s1">'bad'</span><span class="m_p">)</span> 
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>



<div class="m_jp-RenderedHTMLCommon m_jp-RenderedHTML m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<div>

<table border="1" class="m_dataframe">
  <thead>
    <tr style="text-align:right">
      <th></th>
      <th># Tot</th>
      <th># Target</th>
      <th>Target Rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>6</th>
      <td>2</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>12</th>
      <td>118</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>13</th>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>15</th>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>17</th>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>20</th>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>23</th>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>24</th>
      <td>305</td>
      <td>1.0</td>
      <td>0.003279</td>
    </tr>
    <tr>
      <th>25</th>
      <td>143</td>
      <td>1.0</td>
      <td>0.006993</td>
    </tr>
    <tr>
      <th>26</th>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>27</th>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>31</th>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>36</th>
      <td>593</td>
      <td>3.0</td>
      <td>0.005059</td>
    </tr>
    <tr>
      <th>37</th>
      <td>2538</td>
      <td>18.0</td>
      <td>0.007092</td>
    </tr>
    <tr>
      <th>38</th>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>41</th>
      <td>2</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>45</th>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>48</th>
      <td>5930</td>
      <td>24.0</td>
      <td>0.004047</td>
    </tr>
    <tr>
      <th>49</th>
      <td>8839</td>
      <td>98.0</td>
      <td>0.011087</td>
    </tr>
    <tr>
      <th>51</th>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>60</th>
      <td>3300</td>
      <td>64.0</td>
      <td>0.019394</td>
    </tr>
    <tr>
      <th>71</th>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>72</th>
      <td>1288</td>
      <td>42.0</td>
      <td>0.032609</td>
    </tr>
    <tr>
      <th>78</th>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>84</th>
      <td>2512</td>
      <td>140.0</td>
      <td>0.055732</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="m_jp-Cell-inputWrapper"><div class="m_jp-InputPrompt m_jp-InputArea-prompt">
</div><div class="m_jp-RenderedHTMLCommon m_jp-RenderedMarkdown m_jp-MarkdownOutput">
<p>En el caso de la variable Downpayment_ratio no vemos resultados concluyentes al respecto para determinar si aumenta o baja la tasa de impago.</p>

</div>
</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_n">tasa_target_cat</span><span class="m_p">(</span><span class="m_n">dataframe</span><span class="m_o">=</span><span class="m_n">df2</span><span class="m_p">,</span> <span class="m_n">variable</span><span class="m_o">=</span><span class="m_s1">'Downpayment_ratio'</span><span class="m_p">,</span> <span class="m_n">target</span><span class="m_o">=</span><span class="m_s1">'bad'</span><span class="m_p">)</span> 
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>



<div class="m_jp-RenderedHTMLCommon m_jp-RenderedHTML m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<div>

<table border="1" class="m_dataframe">
  <thead>
    <tr style="text-align:right">
      <th></th>
      <th># Tot</th>
      <th># Target</th>
      <th>Target Rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1952</td>
      <td>114.0</td>
      <td>0.058402</td>
    </tr>
    <tr>
      <th>1</th>
      <td>208</td>
      <td>10.0</td>
      <td>0.048077</td>
    </tr>
    <tr>
      <th>2</th>
      <td>265</td>
      <td>15.0</td>
      <td>0.056604</td>
    </tr>
    <tr>
      <th>3</th>
      <td>248</td>
      <td>12.0</td>
      <td>0.048387</td>
    </tr>
    <tr>
      <th>4</th>
      <td>198</td>
      <td>9.0</td>
      <td>0.045455</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>90</th>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>91</th>
      <td>2</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>92</th>
      <td>5</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>93</th>
      <td>9</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>94</th>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>95 rows Ã 3 columns</p>
</div>
</div>

</div>

</div>

</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_n">tasa_target_cat</span><span class="m_p">(</span><span class="m_n">dataframe</span><span class="m_o">=</span><span class="m_n">df2</span><span class="m_p">,</span> <span class="m_n">variable</span><span class="m_o">=</span><span class="m_s1">'age'</span><span class="m_p">,</span> <span class="m_n">target</span><span class="m_o">=</span><span class="m_s1">'bad'</span><span class="m_p">)</span> 
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>



<div class="m_jp-RenderedHTMLCommon m_jp-RenderedHTML m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<div>

<table border="1" class="m_dataframe">
  <thead>
    <tr style="text-align:right">
      <th></th>
      <th># Tot</th>
      <th># Target</th>
      <th>Target Rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>18</th>
      <td>40</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>19</th>
      <td>24</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>20</th>
      <td>30</td>
      <td>2.0</td>
      <td>0.066667</td>
    </tr>
    <tr>
      <th>21</th>
      <td>46</td>
      <td>1.0</td>
      <td>0.021739</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>88</th>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>89</th>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>90</th>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>91</th>
      <td>2</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>95</th>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>76 rows Ã 3 columns</p>
</div>
</div>

</div>

</div>

</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_n">tasa_target_cat</span><span class="m_p">(</span><span class="m_n">dataframe</span><span class="m_o">=</span><span class="m_n">df2</span><span class="m_p">,</span> <span class="m_n">variable</span><span class="m_o">=</span><span class="m_s1">'working_industry'</span><span class="m_p">,</span> <span class="m_n">target</span><span class="m_o">=</span><span class="m_s1">'bad'</span><span class="m_p">)</span> 
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>



<div class="m_jp-RenderedHTMLCommon m_jp-RenderedHTML m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<div>

<table border="1" class="m_dataframe">
  <thead>
    <tr style="text-align:right">
      <th></th>
      <th># Tot</th>
      <th># Target</th>
      <th>Target Rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1.0</th>
      <td>1941</td>
      <td>17.0</td>
      <td>0.008758</td>
    </tr>
    <tr>
      <th>2.0</th>
      <td>444</td>
      <td>12.0</td>
      <td>0.027027</td>
    </tr>
    <tr>
      <th>3.0</th>
      <td>234</td>
      <td>1.0</td>
      <td>0.004274</td>
    </tr>
    <tr>
      <th>4.0</th>
      <td>1792</td>
      <td>43.0</td>
      <td>0.023996</td>
    </tr>
    <tr>
      <th>5.0</th>
      <td>353</td>
      <td>4.0</td>
      <td>0.011331</td>
    </tr>
    <tr>
      <th>6.0</th>
      <td>1666</td>
      <td>10.0</td>
      <td>0.006002</td>
    </tr>
    <tr>
      <th>7.0</th>
      <td>788</td>
      <td>31.0</td>
      <td>0.039340</td>
    </tr>
    <tr>
      <th>8.0</th>
      <td>2500</td>
      <td>36.0</td>
      <td>0.014400</td>
    </tr>
    <tr>
      <th>9.0</th>
      <td>757</td>
      <td>5.0</td>
      <td>0.006605</td>
    </tr>
    <tr>
      <th>10.0</th>
      <td>4959</td>
      <td>43.0</td>
      <td>0.008671</td>
    </tr>
    <tr>
      <th>11.0</th>
      <td>1303</td>
      <td>19.0</td>
      <td>0.014582</td>
    </tr>
    <tr>
      <th>12.0</th>
      <td>39</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>13.0</th>
      <td>2247</td>
      <td>28.0</td>
      <td>0.012461</td>
    </tr>
    <tr>
      <th>14.0</th>
      <td>322</td>
      <td>3.0</td>
      <td>0.009317</td>
    </tr>
    <tr>
      <th>15.0</th>
      <td>661</td>
      <td>16.0</td>
      <td>0.024206</td>
    </tr>
    <tr>
      <th>16.0</th>
      <td>3032</td>
      <td>56.0</td>
      <td>0.018470</td>
    </tr>
    <tr>
      <th>17.0</th>
      <td>96</td>
      <td>1.0</td>
      <td>0.010417</td>
    </tr>
    <tr>
      <th>18.0</th>
      <td>226</td>
      <td>1.0</td>
      <td>0.004425</td>
    </tr>
    <tr>
      <th>19.0</th>
      <td>168</td>
      <td>6.0</td>
      <td>0.035714</td>
    </tr>
    <tr>
      <th>20.0</th>
      <td>13</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>21.0</th>
      <td>92</td>
      <td>3.0</td>
      <td>0.032609</td>
    </tr>
    <tr>
      <th>22.0</th>
      <td>192</td>
      <td>5.0</td>
      <td>0.026042</td>
    </tr>
    <tr>
      <th>23.0</th>
      <td>916</td>
      <td>49.0</td>
      <td>0.053493</td>
    </tr>
    <tr>
      <th>24.0</th>
      <td>16</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>25.0</th>
      <td>56</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>26.0</th>
      <td>274</td>
      <td>1.0</td>
      <td>0.003650</td>
    </tr>
    <tr>
      <th>28.0</th>
      <td>74</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>29.0</th>
      <td>129</td>
      <td>1.0</td>
      <td>0.007752</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="m_jp-Cell-inputWrapper"><div class="m_jp-InputPrompt m_jp-InputArea-prompt">
</div><div class="m_jp-RenderedHTMLCommon m_jp-RenderedMarkdown m_jp-MarkdownOutput">
<p>Aqui observamos con respecto a la variable working status que la categoria A es la que mayor riesgo de impago tiene.</p>

</div>
</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_n">tasa_target_cat</span><span class="m_p">(</span><span class="m_n">dataframe</span><span class="m_o">=</span><span class="m_n">df2</span><span class="m_p">,</span> <span class="m_n">variable</span><span class="m_o">=</span><span class="m_s1">'working_status'</span><span class="m_p">,</span> <span class="m_n">target</span><span class="m_o">=</span><span class="m_s1">'bad'</span><span class="m_p">)</span> 
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>



<div class="m_jp-RenderedHTMLCommon m_jp-RenderedHTML m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<div>

<table border="1" class="m_dataframe">
  <thead>
    <tr style="text-align:right">
      <th></th>
      <th># Tot</th>
      <th># Target</th>
      <th>Target Rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>3641</td>
      <td>122</td>
      <td>0.033507</td>
    </tr>
    <tr>
      <th>F</th>
      <td>15332</td>
      <td>202</td>
      <td>0.013175</td>
    </tr>
    <tr>
      <th>N</th>
      <td>4993</td>
      <td>44</td>
      <td>0.008812</td>
    </tr>
    <tr>
      <th>O</th>
      <td>417</td>
      <td>3</td>
      <td>0.007194</td>
    </tr>
    <tr>
      <th>T</th>
      <td>1202</td>
      <td>20</td>
      <td>0.016639</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_n">df3</span> <span class="m_o">=</span> <span class="m_n">df2</span><span class="m_p">[[</span><span class="m_s1">'working_status'</span><span class="m_p">,</span><span class="m_s1">'<wbr>working_industry'</span><span class="m_p">,</span> <span class="m_s1">'term'</span><span class="m_p">,</span> <span class="m_s1">'product'</span><span class="m_p">,</span> <span class="m_s1">'car_status'</span><span class="m_p">,</span> <span class="m_s1">'num_interveners'</span><span class="m_p">,</span> <span class="m_s1">'type_car'</span><span class="m_p">,</span> <span class="m_s1">'Downpayment_ratio'</span><span class="m_p">,</span>  <span class="m_s1">'bad'</span><span class="m_p">]]</span>
<span class="m_n">df3</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>



<div class="m_jp-RenderedHTMLCommon m_jp-RenderedHTML m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<div>

<table border="1" class="m_dataframe">
  <thead>
    <tr style="text-align:right">
      <th></th>
      <th>working_status</th>
      <th>working_industry</th>
      <th>term</th>
      <th>product</th>
      <th>car_status</th>
      <th>num_interveners</th>
      <th>type_car</th>
      <th>Downpayment_ratio</th>
      <th>bad</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>F</td>
      <td>1.0</td>
      <td>6</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>73</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>F</td>
      <td>13.0</td>
      <td>36</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>F</td>
      <td>17.0</td>
      <td>25</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>F</td>
      <td>11.0</td>
      <td>71</td>
      <td>4</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>10</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>N</td>
      <td>10.0</td>
      <td>84</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>47</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>25580</th>
      <td>F</td>
      <td>16.0</td>
      <td>49</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>39</td>
      <td>0</td>
    </tr>
    <tr>
      <th>25581</th>
      <td>F</td>
      <td>1.0</td>
      <td>49</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>23</td>
      <td>0</td>
    </tr>
    <tr>
      <th>25582</th>
      <td>F</td>
      <td>8.0</td>
      <td>49</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>19</td>
      <td>0</td>
    </tr>
    <tr>
      <th>25583</th>
      <td>N</td>
      <td>10.0</td>
      <td>27</td>
      <td>4</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>31</td>
      <td>0</td>
    </tr>
    <tr>
      <th>25584</th>
      <td>A</td>
      <td>16.0</td>
      <td>20</td>
      <td>4</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>35</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>25585 rows Ã 9 columns</p>
</div>
</div>

</div>

</div>

</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell m_jp-mod-noOutputs">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_n">df3</span><span class="m_o">.</span><span class="m_n">to_csv</span><span class="m_p">(</span><span class="m_s1">'car_loans_clean.<wbr>csv'</span><span class="m_p">,</span> <span class="m_n">index</span> <span class="m_o">=</span> <span class="m_kc">False</span><span class="m_p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_n">pd</span><span class="m_o">.</span><span class="m_n">read_csv</span><span class="m_p">(</span><span class="m_s2">"car_loans_clean.<wbr>csv"</span><span class="m_p">,</span> <span class="m_n">encoding</span><span class="m_o">=</span><span class="m_s1">'ISO-8859â1'</span><span class="m_p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>



<div class="m_jp-RenderedHTMLCommon m_jp-RenderedHTML m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<div>

<table border="1" class="m_dataframe">
  <thead>
    <tr style="text-align:right">
      <th></th>
      <th>working_status</th>
      <th>working_industry</th>
      <th>term</th>
      <th>product</th>
      <th>car_status</th>
      <th>num_interveners</th>
      <th>type_car</th>
      <th>Downpayment_ratio</th>
      <th>bad</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>F</td>
      <td>1.0</td>
      <td>6</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>73</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>F</td>
      <td>13.0</td>
      <td>36</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>F</td>
      <td>17.0</td>
      <td>25</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>F</td>
      <td>11.0</td>
      <td>71</td>
      <td>4</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>10</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>N</td>
      <td>10.0</td>
      <td>84</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>47</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>25580</th>
      <td>F</td>
      <td>16.0</td>
      <td>49</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>39</td>
      <td>0</td>
    </tr>
    <tr>
      <th>25581</th>
      <td>F</td>
      <td>1.0</td>
      <td>49</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>23</td>
      <td>0</td>
    </tr>
    <tr>
      <th>25582</th>
      <td>F</td>
      <td>8.0</td>
      <td>49</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>19</td>
      <td>0</td>
    </tr>
    <tr>
      <th>25583</th>
      <td>N</td>
      <td>10.0</td>
      <td>27</td>
      <td>4</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>31</td>
      <td>0</td>
    </tr>
    <tr>
      <th>25584</th>
      <td>A</td>
      <td>16.0</td>
      <td>20</td>
      <td>4</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>35</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>25585 rows Ã 9 columns</p>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="m_jp-Cell-inputWrapper"><div class="m_jp-InputPrompt m_jp-InputArea-prompt">
</div><div class="m_jp-RenderedHTMLCommon m_jp-RenderedMarkdown m_jp-MarkdownOutput">
<h1 id="m_ML-Supervisado:-Modelos-de-clasificación">ML Supervisado: Modelos de clasificación<a class="m_anchor-link" href="https://mail-attachment.googleusercontent.com/attachment/u/2/?ui=2&amp;ik=5113226a7d&amp;attid=0.1&amp;permmsgid=msg-a:r489306242194221422&amp;th=17d741ad8789dc5f&amp;view=att&amp;disp=inline&amp;realattid=f_kwmzmtw65&amp;ser=1&amp;saddbat=ANGjdJ84PnBDA4LbNStn5wChHnm3K_vPuZhVllcGrlOQUI9JnKugcwg0-fy6BrktcTOolNRvffp3YhjKSWZUeUBN0XjzR8iu9Au9AZOiDd8hANRVARh4rEJ1874ffHrQ-ggOs9uc4PrvJAa_9Zun_DkI7KOEoJbTul2oB7yCSzT-QGLKEIu8Dk2vPNrbEk-yIE8ovRwsdS9VzC9ra7iSQjESxcr7NFWdethLSyyfMU_yZXXNfViq3DqMbO5ivNEXCdju7WWPTTNCYDMi3kPYhWb4XJsHW_QnPKI-8j-ld07TdYfkyz5ldItb6N6_fIh-96LGD9QfnuQHf9gM2tLk9fEjxHMZ3oCJ9ikWWoAzbRbG78iYwmasTDlC7ODuw9i85XQGFPVp6Z1WlDk-R0Lg14AIcA0Oncn9oGtwCqct1CX-iUniEuE5bIONSMmFIedePodV3RuCRZGSAfmC2Fy4sg7FurPk8e1vA506ZHTacOLdhOlPPZMef4fcFRMSQ_aYp5uCIfHR-FWyCPMUxUfkvpF42vprc5h_m5wtad4CRuPunhCZpqWuwBjIB3MRSSDKOfxGrTIhLvOtsQx-Q_B6CVuW3k2CnjG56iigBIoKGtyoZ0w4jSXFR5Zw6IakUy-Wf2r8_tS7MHka3cnK4Gbkfu03JMWKKXDYeQylCUpnlluNjhw-BBTo-SGv_RXtfdTiezgC_87gZDXCHq6IyngAjMpyY--rhsyqV4Mw0hbg17t6wYGgllFOqAVCWjWQamzuyk_QVhuMZ9LP4OcjDWrmkc1MgkQqxzZMCfVZn9LRvP9j2upoV-PDVu0r1MK4G30HprPfk8urnwHBTZ__CxQNlTHqOyjkUSp9DCvMQO0WvYzA73Rkr7ATDsHn_Dzm1eg#m__ML-Supervisado:-Modelos-de-clasificaci%C3%B3n" rel="noreferrer">¶</a></h1><h2 id="m_Importación-de-librerías-y-carga-del-fichero-limpio">Importación de librerías y carga del fichero limpio<a class="m_anchor-link" href="https://mail-attachment.googleusercontent.com/attachment/u/2/?ui=2&amp;ik=5113226a7d&amp;attid=0.1&amp;permmsgid=msg-a:r489306242194221422&amp;th=17d741ad8789dc5f&amp;view=att&amp;disp=inline&amp;realattid=f_kwmzmtw65&amp;ser=1&amp;saddbat=ANGjdJ84PnBDA4LbNStn5wChHnm3K_vPuZhVllcGrlOQUI9JnKugcwg0-fy6BrktcTOolNRvffp3YhjKSWZUeUBN0XjzR8iu9Au9AZOiDd8hANRVARh4rEJ1874ffHrQ-ggOs9uc4PrvJAa_9Zun_DkI7KOEoJbTul2oB7yCSzT-QGLKEIu8Dk2vPNrbEk-yIE8ovRwsdS9VzC9ra7iSQjESxcr7NFWdethLSyyfMU_yZXXNfViq3DqMbO5ivNEXCdju7WWPTTNCYDMi3kPYhWb4XJsHW_QnPKI-8j-ld07TdYfkyz5ldItb6N6_fIh-96LGD9QfnuQHf9gM2tLk9fEjxHMZ3oCJ9ikWWoAzbRbG78iYwmasTDlC7ODuw9i85XQGFPVp6Z1WlDk-R0Lg14AIcA0Oncn9oGtwCqct1CX-iUniEuE5bIONSMmFIedePodV3RuCRZGSAfmC2Fy4sg7FurPk8e1vA506ZHTacOLdhOlPPZMef4fcFRMSQ_aYp5uCIfHR-FWyCPMUxUfkvpF42vprc5h_m5wtad4CRuPunhCZpqWuwBjIB3MRSSDKOfxGrTIhLvOtsQx-Q_B6CVuW3k2CnjG56iigBIoKGtyoZ0w4jSXFR5Zw6IakUy-Wf2r8_tS7MHka3cnK4Gbkfu03JMWKKXDYeQylCUpnlluNjhw-BBTo-SGv_RXtfdTiezgC_87gZDXCHq6IyngAjMpyY--rhsyqV4Mw0hbg17t6wYGgllFOqAVCWjWQamzuyk_QVhuMZ9LP4OcjDWrmkc1MgkQqxzZMCfVZn9LRvP9j2upoV-PDVu0r1MK4G30HprPfk8urnwHBTZ__CxQNlTHqOyjkUSp9DCvMQO0WvYzA73Rkr7ATDsHn_Dzm1eg#m__Importaci%C3%B3n-de-librer%C3%ADas-y-carga-del-fichero-limpio" rel="noreferrer">¶</a></h2>
</div>
</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell m_jp-mod-noOutputs">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_kn">import</span> <span class="m_nn">pandas</span> <span class="m_k">as</span> <span class="m_nn">pd</span> <span class="m_c1"># Para tratar datos en forma de DataFrame</span>
<span class="m_kn">import</span> <span class="m_nn">numpy</span> <span class="m_k">as</span> <span class="m_nn">np</span> <span class="m_c1"># Para disponer de ciertas funciones matemÃ¡ticas</span>



<span class="m_n">df</span> <span class="m_o">=</span> <span class="m_n">pd</span><span class="m_o">.</span><span class="m_n">read_csv</span><span class="m_p">(</span><span class="m_s2">"car_loans_clean.<wbr>csv"</span><span class="m_p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell m_jp-mod-noOutputs">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_kn">from</span> <span class="m_nn">sklearn.model_selection</span> <span class="m_kn">import</span> <span class="m_n">train_test_split</span>
<span class="m_kn">from</span> <span class="m_nn">sklearn.linear_model</span> <span class="m_kn">import</span> <span class="m_n">LogisticRegression</span>
<span class="m_kn">from</span> <span class="m_nn">sklearn.svm</span> <span class="m_kn">import</span> <span class="m_n">SVC</span>
<span class="m_kn">from</span> <span class="m_nn">sklearn.neighbors</span> <span class="m_kn">import</span> <span class="m_n">KNeighborsClassifier</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_n">df</span><span class="m_o">.</span><span class="m_n">head</span><span class="m_p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>



<div class="m_jp-RenderedHTMLCommon m_jp-RenderedHTML m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<div>

<table border="1" class="m_dataframe">
  <thead>
    <tr style="text-align:right">
      <th></th>
      <th>working_status</th>
      <th>working_industry</th>
      <th>term</th>
      <th>product</th>
      <th>car_status</th>
      <th>num_interveners</th>
      <th>type_car</th>
      <th>Downpayment_ratio</th>
      <th>bad</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>F</td>
      <td>1.0</td>
      <td>6</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>73</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>F</td>
      <td>13.0</td>
      <td>36</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>F</td>
      <td>17.0</td>
      <td>25</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>F</td>
      <td>11.0</td>
      <td>71</td>
      <td>4</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>10</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>N</td>
      <td>10.0</td>
      <td>84</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>47</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="m_jp-Cell-inputWrapper"><div class="m_jp-InputPrompt m_jp-InputArea-prompt">
</div><div class="m_jp-RenderedHTMLCommon m_jp-RenderedMarkdown m_jp-MarkdownOutput">
<h2 id="m_Conversión-de-todas-las-variables-a-numéricas-y-dummies">Conversión de todas las variables a numéricas y dummies<a class="m_anchor-link" href="https://mail-attachment.googleusercontent.com/attachment/u/2/?ui=2&amp;ik=5113226a7d&amp;attid=0.1&amp;permmsgid=msg-a:r489306242194221422&amp;th=17d741ad8789dc5f&amp;view=att&amp;disp=inline&amp;realattid=f_kwmzmtw65&amp;ser=1&amp;saddbat=ANGjdJ84PnBDA4LbNStn5wChHnm3K_vPuZhVllcGrlOQUI9JnKugcwg0-fy6BrktcTOolNRvffp3YhjKSWZUeUBN0XjzR8iu9Au9AZOiDd8hANRVARh4rEJ1874ffHrQ-ggOs9uc4PrvJAa_9Zun_DkI7KOEoJbTul2oB7yCSzT-QGLKEIu8Dk2vPNrbEk-yIE8ovRwsdS9VzC9ra7iSQjESxcr7NFWdethLSyyfMU_yZXXNfViq3DqMbO5ivNEXCdju7WWPTTNCYDMi3kPYhWb4XJsHW_QnPKI-8j-ld07TdYfkyz5ldItb6N6_fIh-96LGD9QfnuQHf9gM2tLk9fEjxHMZ3oCJ9ikWWoAzbRbG78iYwmasTDlC7ODuw9i85XQGFPVp6Z1WlDk-R0Lg14AIcA0Oncn9oGtwCqct1CX-iUniEuE5bIONSMmFIedePodV3RuCRZGSAfmC2Fy4sg7FurPk8e1vA506ZHTacOLdhOlPPZMef4fcFRMSQ_aYp5uCIfHR-FWyCPMUxUfkvpF42vprc5h_m5wtad4CRuPunhCZpqWuwBjIB3MRSSDKOfxGrTIhLvOtsQx-Q_B6CVuW3k2CnjG56iigBIoKGtyoZ0w4jSXFR5Zw6IakUy-Wf2r8_tS7MHka3cnK4Gbkfu03JMWKKXDYeQylCUpnlluNjhw-BBTo-SGv_RXtfdTiezgC_87gZDXCHq6IyngAjMpyY--rhsyqV4Mw0hbg17t6wYGgllFOqAVCWjWQamzuyk_QVhuMZ9LP4OcjDWrmkc1MgkQqxzZMCfVZn9LRvP9j2upoV-PDVu0r1MK4G30HprPfk8urnwHBTZ__CxQNlTHqOyjkUSp9DCvMQO0WvYzA73Rkr7ATDsHn_Dzm1eg#m__Conversi%C3%B3n-de-todas-las-variables-a-num%C3%A9ricas-y-dummies" rel="noreferrer">¶</a></h2><p>La mayorÃ­a de algoritmos de clasificaciÃ³n no entienden variables de tipo "str". Los modelos son matemÃ¡ticos, por lo que necesitan nÃºmeros. Las variables numÃ©ricas ya lo son de base, pero las categÃ³ricas necesitan ser transformadas en "dummies"</p>

</div>
</div>
<div class="m_jp-Cell-inputWrapper"><div class="m_jp-InputPrompt m_jp-InputArea-prompt">
</div><div class="m_jp-RenderedHTMLCommon m_jp-RenderedMarkdown m_jp-MarkdownOutput">
<p>Seleccion de las variables finales y correlacion de las mismas</p>

</div>
</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_n">variables_categoricas</span> <span class="m_o">=</span> <span class="m_p">[</span><span class="m_s1">'working_industry'</span><span class="m_p">,</span> <span class="m_s1">'term'</span><span class="m_p">,</span><span class="m_s1">'product'</span><span class="m_p">,</span> <span class="m_s1">'car_status'</span><span class="m_p">,</span> <span class="m_s1">'type_car'</span><span class="m_p">,</span> <span class="m_s1">'num_interveners'</span><span class="m_p">,</span> <span class="m_s1">'Downpayment_ratio'</span><span class="m_p">,</span> <span class="m_s1">'working_status'</span><span class="m_p">]</span>
<span class="m_n">df_dummies</span> <span class="m_o">=</span> <span class="m_n">pd</span><span class="m_o">.</span><span class="m_n">get_dummies</span><span class="m_p">(</span><span class="m_n">df</span><span class="m_p">,</span> <span class="m_n">columns</span> <span class="m_o">=</span> <span class="m_n">variables_categoricas</span><span class="m_p">)</span>
<span class="m_n">df_dummies</span><span class="m_o">.</span><span class="m_n">head</span><span class="m_p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>



<div class="m_jp-RenderedHTMLCommon m_jp-RenderedHTML m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<div>

<table border="1" class="m_dataframe">
  <thead>
    <tr style="text-align:right">
      <th></th>
      <th>bad</th>
      <th>working_industry_1.0</th>
      <th>working_industry_2.0</th>
      <th>working_industry_3.0</th>
      <th>working_industry_4.0</th>
      <th>working_industry_5.0</th>
      <th>working_industry_6.0</th>
      <th>working_industry_7.0</th>
      <th>working_industry_8.0</th>
      <th>working_industry_9.0</th>
      <th>...</th>
      <th>Downpayment_ratio_90</th>
      <th>Downpayment_ratio_91</th>
      <th>Downpayment_ratio_92</th>
      <th>Downpayment_ratio_93</th>
      <th>Downpayment_ratio_94</th>
      <th>working_status_A</th>
      <th>working_status_F</th>
      <th>working_status_N</th>
      <th>working_status_O</th>
      <th>working_status_T</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows Ã 167 columns</p>
</div>
</div>

</div>

</div>

</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_n">df</span><span class="m_p">[[</span><span class="m_s1">'working_industry'</span><span class="m_p">,</span> <span class="m_s1">'term'</span><span class="m_p">,</span><span class="m_s1">'product'</span><span class="m_p">,</span> <span class="m_s1">'car_status'</span><span class="m_p">,</span> <span class="m_s1">'type_car'</span><span class="m_p">,</span> <span class="m_s1">'num_interveners'</span><span class="m_p">,</span> <span class="m_s1">'Downpayment_ratio'</span><span class="m_p">,</span> <span class="m_s1">'working_status'</span><span class="m_p">]]</span><span class="m_o">.</span><span class="m_n">corr</span><span class="m_p">()</span> <span class="m_c1"># Exploramos las correlaciones</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>



<div class="m_jp-RenderedHTMLCommon m_jp-RenderedHTML m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<div>

<table border="1" class="m_dataframe">
  <thead>
    <tr style="text-align:right">
      <th></th>
      <th>working_industry</th>
      <th>term</th>
      <th>product</th>
      <th>car_status</th>
      <th>type_car</th>
      <th>num_interveners</th>
      <th>Downpayment_ratio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>working_industry</th>
      <td>1.000000</td>
      <td>0.050287</td>
      <td>-0.023811</td>
      <td>-0.001064</td>
      <td>-0.026599</td>
      <td>0.002342</td>
      <td>-0.048027</td>
    </tr>
    <tr>
      <th>term</th>
      <td>0.050287</td>
      <td>1.000000</td>
      <td>-0.007461</td>
      <td>-0.011074</td>
      <td>-0.026056</td>
      <td>0.152206</td>
      <td>-0.396712</td>
    </tr>
    <tr>
      <th>product</th>
      <td>-0.023811</td>
      <td>-0.007461</td>
      <td>1.000000</td>
      <td>0.014217</td>
      <td>-0.083903</td>
      <td>-0.004555</td>
      <td>0.101587</td>
    </tr>
    <tr>
      <th>car_status</th>
      <td>-0.001064</td>
      <td>-0.011074</td>
      <td>0.014217</td>
      <td>1.000000</td>
      <td>-0.030251</td>
      <td>-0.003868</td>
      <td>-0.006708</td>
    </tr>
    <tr>
      <th>type_car</th>
      <td>-0.026599</td>
      <td>-0.026056</td>
      <td>-0.083903</td>
      <td>-0.030251</td>
      <td>1.000000</td>
      <td>0.028431</td>
      <td>0.086960</td>
    </tr>
    <tr>
      <th>num_interveners</th>
      <td>0.002342</td>
      <td>0.152206</td>
      <td>-0.004555</td>
      <td>-0.003868</td>
      <td>0.028431</td>
      <td>1.000000</td>
      <td>-0.224689</td>
    </tr>
    <tr>
      <th>Downpayment_ratio</th>
      <td>-0.048027</td>
      <td>-0.396712</td>
      <td>0.101587</td>
      <td>-0.006708</td>
      <td>0.086960</td>
      <td>-0.224689</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_n">df</span><span class="m_p">[</span><span class="m_s1">'bad'</span><span class="m_p">]</span><span class="m_o">.</span><span class="m_n">value_counts</span><span class="m_p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>




<div class="m_jp-RenderedText m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<pre>0    25194
1      391
Name: bad, dtype: int64</pre>
</div>

</div>

</div>

</div>

</div>
<div class="m_jp-Cell-inputWrapper"><div class="m_jp-InputPrompt m_jp-InputArea-prompt">
</div><div class="m_jp-RenderedHTMLCommon m_jp-RenderedMarkdown m_jp-MarkdownOutput">
<p>En este caso vemos que la gran mayoria de los clientes, no se encuentran dentro de la categoria "bad". Solo 391 casos si se encuentran dentro de esta categoria.</p>

</div>
</div>
<div class="m_jp-Cell-inputWrapper"><div class="m_jp-InputPrompt m_jp-InputArea-prompt">
</div><div class="m_jp-RenderedHTMLCommon m_jp-RenderedMarkdown m_jp-MarkdownOutput">
<h2 id="m_Creación-de-muestras-Train-y-Test">Creación de muestras Train y Test<a class="m_anchor-link" href="https://mail-attachment.googleusercontent.com/attachment/u/2/?ui=2&amp;ik=5113226a7d&amp;attid=0.1&amp;permmsgid=msg-a:r489306242194221422&amp;th=17d741ad8789dc5f&amp;view=att&amp;disp=inline&amp;realattid=f_kwmzmtw65&amp;ser=1&amp;saddbat=ANGjdJ84PnBDA4LbNStn5wChHnm3K_vPuZhVllcGrlOQUI9JnKugcwg0-fy6BrktcTOolNRvffp3YhjKSWZUeUBN0XjzR8iu9Au9AZOiDd8hANRVARh4rEJ1874ffHrQ-ggOs9uc4PrvJAa_9Zun_DkI7KOEoJbTul2oB7yCSzT-QGLKEIu8Dk2vPNrbEk-yIE8ovRwsdS9VzC9ra7iSQjESxcr7NFWdethLSyyfMU_yZXXNfViq3DqMbO5ivNEXCdju7WWPTTNCYDMi3kPYhWb4XJsHW_QnPKI-8j-ld07TdYfkyz5ldItb6N6_fIh-96LGD9QfnuQHf9gM2tLk9fEjxHMZ3oCJ9ikWWoAzbRbG78iYwmasTDlC7ODuw9i85XQGFPVp6Z1WlDk-R0Lg14AIcA0Oncn9oGtwCqct1CX-iUniEuE5bIONSMmFIedePodV3RuCRZGSAfmC2Fy4sg7FurPk8e1vA506ZHTacOLdhOlPPZMef4fcFRMSQ_aYp5uCIfHR-FWyCPMUxUfkvpF42vprc5h_m5wtad4CRuPunhCZpqWuwBjIB3MRSSDKOfxGrTIhLvOtsQx-Q_B6CVuW3k2CnjG56iigBIoKGtyoZ0w4jSXFR5Zw6IakUy-Wf2r8_tS7MHka3cnK4Gbkfu03JMWKKXDYeQylCUpnlluNjhw-BBTo-SGv_RXtfdTiezgC_87gZDXCHq6IyngAjMpyY--rhsyqV4Mw0hbg17t6wYGgllFOqAVCWjWQamzuyk_QVhuMZ9LP4OcjDWrmkc1MgkQqxzZMCfVZn9LRvP9j2upoV-PDVu0r1MK4G30HprPfk8urnwHBTZ__CxQNlTHqOyjkUSp9DCvMQO0WvYzA73Rkr7ATDsHn_Dzm1eg#m__Creaci%C3%B3n-de-muestras-Train-y-Test" rel="noreferrer">¶</a></h2><p>Es necesario dividir la muestra en un set de desarrollo (train) y otro de validaciÃ³n (test) para evitar el sobreajuste.</p>

</div>
</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell m_jp-mod-noOutputs">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_kn">from</span> <span class="m_nn">sklearn.metrics</span> <span class="m_kn">import</span> <span class="m_n">roc_auc_score</span><span class="m_p">,</span> <span class="m_n">plot_roc_curve</span>
<span class="m_kn">from</span> <span class="m_nn">sklearn.metrics</span> <span class="m_kn">import</span> <span class="m_n">confusion_matrix</span><span class="m_p">,</span> <span class="m_n">plot_confusion_matrix</span>
<span class="m_kn">from</span> <span class="m_nn">sklearn.metrics</span> <span class="m_kn">import</span> <span class="m_n">classification_report</span>
<span class="m_kn">import</span> <span class="m_nn">matplotlib.pyplot</span> <span class="m_k">as</span> <span class="m_nn">plt</span>
<span class="m_kn">import</span> <span class="m_nn">seaborn</span> <span class="m_k">as</span> <span class="m_nn">sns</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell m_jp-mod-noOutputs">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_kn">from</span> <span class="m_nn">sklearn.model_selection</span> <span class="m_kn">import</span> <span class="m_n">train_test_split</span>

<span class="m_c1"># Dividimos la muestra en train/test</span>
<span class="m_n">df_train</span><span class="m_p">,</span> <span class="m_n">df_test</span> <span class="m_o">=</span> <span class="m_n">train_test_split</span><span class="m_p">(</span><span class="m_n">df_dummies</span><span class="m_p">,</span> <span class="m_n">test_size</span> <span class="m_o">=</span> <span class="m_mf">0.3</span><span class="m_p">,</span> <span class="m_n">random_state</span> <span class="m_o">=</span> <span class="m_mi">1</span><span class="m_p">)</span>

<span class="m_n">x_train</span> <span class="m_o">=</span> <span class="m_n">df_train</span><span class="m_o">.</span><span class="m_n">drop</span><span class="m_p">(</span><span class="m_n">columns</span> <span class="m_o">=</span> <span class="m_s1">'bad'</span><span class="m_p">)</span>
<span class="m_n">y_train</span> <span class="m_o">=</span> <span class="m_n">df_train</span><span class="m_p">[</span><span class="m_s1">'bad'</span><span class="m_p">]</span>

<span class="m_n">x_test</span> <span class="m_o">=</span> <span class="m_n">df_test</span><span class="m_o">.</span><span class="m_n">drop</span><span class="m_p">(</span><span class="m_n">columns</span> <span class="m_o">=</span> <span class="m_s1">'bad'</span><span class="m_p">)</span>
<span class="m_n">y_test</span> <span class="m_o">=</span> <span class="m_n">df_test</span><span class="m_p">[</span><span class="m_s1">'bad'</span><span class="m_p">]</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_c1">#Verifico los estadisticos del Dataset</span>
<span class="m_nb">print</span><span class="m_p">(</span><span class="m_s1">'Estadisticos del Dataset:'</span><span class="m_p">)</span>
<span class="m_nb">print</span><span class="m_p">(</span><span class="m_n">df_train</span><span class="m_o">.</span><span class="m_n">describe</span><span class="m_p">())</span>
<span class="m_nb">print</span><span class="m_p">(</span><span class="m_n">df_test</span><span class="m_o">.</span><span class="m_n">describe</span><span class="m_p">())</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt"></div>


<div class="m_jp-RenderedText m_jp-OutputArea-output">
<pre>Estadisticos del Dataset:
                bad  working_industry_1.0  working_industry_2.0  \
count  17909.000000          17909.000000          17909.000000   
mean       0.015635              0.074208              0.017254   
std        0.124061              0.262117              0.130220   
min        0.000000              0.000000              0.000000   
25%        0.000000              0.000000              0.000000   
50%        0.000000              0.000000              0.000000   
75%        0.000000              0.000000              0.000000   
max        1.000000              1.000000              1.000000   

       working_industry_3.0  working_industry_4.0  working_industry_5.0  \
count          17909.000000          17909.000000          17909.000000   
mean               0.008543              0.070467              0.014183   
std                0.092036              0.255940              0.118247   
min                0.000000              0.000000              0.000000   
25%                0.000000              0.000000              0.000000   
50%                0.000000              0.000000              0.000000   
75%                0.000000              0.000000              0.000000   
max                1.000000              1.000000              1.000000   

       working_industry_6.0  working_industry_7.0  working_industry_8.0  \
count          17909.000000          17909.000000          17909.000000   
mean               0.066615              0.030878              0.096320   
std                0.249360              0.172993              0.295038   
min                0.000000              0.000000              0.000000   
25%                0.000000              0.000000              0.000000   
50%                0.000000              0.000000              0.000000   
75%                0.000000              0.000000              0.000000   
max                1.000000              1.000000              1.000000   

       working_industry_9.0  ...  Downpayment_ratio_90  Downpayment_ratio_91  \
count          17909.000000  ...          17909.000000          17909.000000   
mean               0.030152  ...              0.000056              0.000056   
std                0.171011  ...              0.007472              0.007472   
min                0.000000  ...              0.000000              0.000000   
25%                0.000000  ...              0.000000              0.000000   
50%                0.000000  ...              0.000000              0.000000   
75%                0.000000  ...              0.000000              0.000000   
max                1.000000  ...              1.000000              1.000000   

       Downpayment_ratio_92  Downpayment_ratio_93  Downpayment_ratio_94  \
count          17909.000000          17909.000000               17909.0   
mean               0.000168              0.000335                   0.0   
std                0.012942              0.018301                   0.0   
min                0.000000              0.000000                   0.0   
25%                0.000000              0.000000                   0.0   
50%                0.000000              0.000000                   0.0   
75%                0.000000              0.000000                   0.0   
max                1.000000              1.000000                   0.0   

       working_status_A  working_status_F  working_status_N  working_status_O  \
count      17909.000000      17909.000000      17909.000000      17909.000000   
mean           0.141437          0.600983          0.194260          0.016081   
std            0.348482          0.489710          0.395641          0.125792   
min            0.000000          0.000000          0.000000          0.000000   
25%            0.000000          0.000000          0.000000          0.000000   
50%            0.000000          1.000000          0.000000          0.000000   
75%            0.000000          1.000000          0.000000          0.000000   
max            1.000000          1.000000          1.000000          1.000000   

       working_status_T  
count      17909.000000  
mean           0.047239  
std            0.212155  
min            0.000000  
25%            0.000000  
50%            0.000000  
75%            0.000000  
max            1.000000  

[8 rows x 167 columns]
               bad  working_industry_1.0  working_industry_2.0  \
count  7676.000000           7676.000000           7676.000000   
mean      0.014461              0.079729              0.017587   
std       0.119388              0.270891              0.131454   
min       0.000000              0.000000              0.000000   
25%       0.000000              0.000000              0.000000   
50%       0.000000              0.000000              0.000000   
75%       0.000000              0.000000              0.000000   
max       1.000000              1.000000              1.000000   

       working_industry_3.0  working_industry_4.0  working_industry_5.0  \
count           7676.000000           7676.000000           7676.000000   
mean               0.010552              0.069046              0.012897   
std                0.102188              0.253550              0.112839   
min                0.000000              0.000000              0.000000   
25%                0.000000              0.000000              0.000000   
50%                0.000000              0.000000              0.000000   
75%                0.000000              0.000000              0.000000   
max                1.000000              1.000000              1.000000   

       working_industry_6.0  working_industry_7.0  working_industry_8.0  \
count           7676.000000           7676.000000           7676.000000   
mean               0.061621              0.030615              0.100964   
std                0.240481              0.172283              0.301301   
min                0.000000              0.000000              0.000000   
25%                0.000000              0.000000              0.000000   
50%                0.000000              0.000000              0.000000   
75%                0.000000              0.000000              0.000000   
max                1.000000              1.000000              1.000000   

       working_industry_9.0  ...  Downpayment_ratio_90  Downpayment_ratio_91  \
count           7676.000000  ...           7676.000000           7676.000000   
mean               0.028270  ...              0.000261              0.000130   
std                0.165754  ...              0.016141              0.011414   
min                0.000000  ...              0.000000              0.000000   
25%                0.000000  ...              0.000000              0.000000   
50%                0.000000  ...              0.000000              0.000000   
75%                0.000000  ...              0.000000              0.000000   
max                1.000000  ...              1.000000              1.000000   

       Downpayment_ratio_92  Downpayment_ratio_93  Downpayment_ratio_94  \
count           7676.000000           7676.000000           7676.000000   
mean               0.000261              0.000391              0.000391   
std                0.016141              0.019767              0.019767   
min                0.000000              0.000000              0.000000   
25%                0.000000              0.000000              0.000000   
50%                0.000000              0.000000              0.000000   
75%                0.000000              0.000000              0.000000   
max                1.000000              1.000000              1.000000   

       working_status_A  working_status_F  working_status_N  working_status_O  \
count       7676.000000       7676.000000       7676.000000       7676.000000   
mean           0.144346          0.595232          0.197238          0.016806   
std            0.351463          0.490879          0.397940          0.128551   
min            0.000000          0.000000          0.000000          0.000000   
25%            0.000000          0.000000          0.000000          0.000000   
50%            0.000000          1.000000          0.000000          0.000000   
75%            0.000000          1.000000          0.000000          0.000000   
max            1.000000          1.000000          1.000000          1.000000   

       working_status_T  
count       7676.000000  
mean           0.046378  
std            0.210317  
min            0.000000  
25%            0.000000  
50%            0.000000  
75%            0.000000  
max            1.000000  

[8 rows x 167 columns]
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="m_jp-Cell-inputWrapper"><div class="m_jp-InputPrompt m_jp-InputArea-prompt">
</div><div class="m_jp-RenderedHTMLCommon m_jp-RenderedMarkdown m_jp-MarkdownOutput">
<h2 id="m_Modelos-de-clasificación">Modelos de clasificación<a class="m_anchor-link" href="https://mail-attachment.googleusercontent.com/attachment/u/2/?ui=2&amp;ik=5113226a7d&amp;attid=0.1&amp;permmsgid=msg-a:r489306242194221422&amp;th=17d741ad8789dc5f&amp;view=att&amp;disp=inline&amp;realattid=f_kwmzmtw65&amp;ser=1&amp;saddbat=ANGjdJ84PnBDA4LbNStn5wChHnm3K_vPuZhVllcGrlOQUI9JnKugcwg0-fy6BrktcTOolNRvffp3YhjKSWZUeUBN0XjzR8iu9Au9AZOiDd8hANRVARh4rEJ1874ffHrQ-ggOs9uc4PrvJAa_9Zun_DkI7KOEoJbTul2oB7yCSzT-QGLKEIu8Dk2vPNrbEk-yIE8ovRwsdS9VzC9ra7iSQjESxcr7NFWdethLSyyfMU_yZXXNfViq3DqMbO5ivNEXCdju7WWPTTNCYDMi3kPYhWb4XJsHW_QnPKI-8j-ld07TdYfkyz5ldItb6N6_fIh-96LGD9QfnuQHf9gM2tLk9fEjxHMZ3oCJ9ikWWoAzbRbG78iYwmasTDlC7ODuw9i85XQGFPVp6Z1WlDk-R0Lg14AIcA0Oncn9oGtwCqct1CX-iUniEuE5bIONSMmFIedePodV3RuCRZGSAfmC2Fy4sg7FurPk8e1vA506ZHTacOLdhOlPPZMef4fcFRMSQ_aYp5uCIfHR-FWyCPMUxUfkvpF42vprc5h_m5wtad4CRuPunhCZpqWuwBjIB3MRSSDKOfxGrTIhLvOtsQx-Q_B6CVuW3k2CnjG56iigBIoKGtyoZ0w4jSXFR5Zw6IakUy-Wf2r8_tS7MHka3cnK4Gbkfu03JMWKKXDYeQylCUpnlluNjhw-BBTo-SGv_RXtfdTiezgC_87gZDXCHq6IyngAjMpyY--rhsyqV4Mw0hbg17t6wYGgllFOqAVCWjWQamzuyk_QVhuMZ9LP4OcjDWrmkc1MgkQqxzZMCfVZn9LRvP9j2upoV-PDVu0r1MK4G30HprPfk8urnwHBTZ__CxQNlTHqOyjkUSp9DCvMQO0WvYzA73Rkr7ATDsHn_Dzm1eg#m__Modelos-de-clasificaci%C3%B3n" rel="noreferrer">¶</a></h2><p>Importamos librerÃ­as varias para generar los modelos y obtener resultados</p>

</div>
</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell m_jp-mod-noOutputs">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_kn">from</span> <span class="m_nn">sklearn.metrics</span> <span class="m_kn">import</span> <span class="m_n">roc_auc_score</span><span class="m_p">,</span> <span class="m_n">plot_roc_curve</span>
<span class="m_kn">from</span> <span class="m_nn">sklearn.metrics</span> <span class="m_kn">import</span> <span class="m_n">confusion_matrix</span><span class="m_p">,</span> <span class="m_n">plot_confusion_matrix</span>
<span class="m_kn">from</span> <span class="m_nn">sklearn.metrics</span> <span class="m_kn">import</span> <span class="m_n">classification_report</span>
<span class="m_kn">import</span> <span class="m_nn">matplotlib.pyplot</span> <span class="m_k">as</span> <span class="m_nn">plt</span>
<span class="m_kn">import</span> <span class="m_nn">seaborn</span> <span class="m_k">as</span> <span class="m_nn">sns</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_nb">print</span><span class="m_p">(</span><span class="m_n">df</span><span class="m_o">.</span><span class="m_n">shape</span><span class="m_p">)</span>
<span class="m_nb">print</span><span class="m_p">(</span><span class="m_n">pd</span><span class="m_o">.</span><span class="m_n">value_counts</span><span class="m_p">(</span><span class="m_n">df</span><span class="m_p">[</span><span class="m_s1">'bad'</span><span class="m_p"><wbr>],</span> <span class="m_n">sort</span> <span class="m_o">=</span> <span class="m_kc">True</span><span class="m_p">))</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt"></div>


<div class="m_jp-RenderedText m_jp-OutputArea-output">
<pre>(25585, 9)
0    25194
1      391
Name: bad, dtype: int64
</pre>
</div>
</div>

</div>

</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_n">count_totbads</span> <span class="m_o">=</span> <span class="m_n">pd</span><span class="m_o">.</span><span class="m_n">value_counts</span><span class="m_p">(</span><span class="m_n">df</span><span class="m_p">[</span><span class="m_s1">'bad'</span><span class="m_p">],</span> <span class="m_n">sort</span> <span class="m_o">=</span> <span class="m_kc">True</span><span class="m_p">)</span>
<span class="m_n">count_totbads</span><span class="m_o">.</span><span class="m_n">plot</span><span class="m_p">(</span><span class="m_n">kind</span> <span class="m_o">=</span> <span class="m_s1">'bar'</span><span class="m_p">,</span> <span class="m_n">rot</span> <span class="m_o">=</span> <span class="m_mi">0</span><span class="m_p">,</span> <span class="m_n">color</span> <span class="m_o">=</span> <span class="m_s1">'purple'</span><span class="m_p">,</span> <span class="m_n">title</span> <span class="m_o">=</span> <span class="m_s1">'Numero total casos Pagos cotra Impagos'</span><span class="m_p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>




<div class="m_jp-RenderedText m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<pre>&lt;AxesSubplot:title={'center':'<wbr>Numero total casos Pagos cotra Impagos'}&gt;</pre>
</div>

</div>

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt"></div>




<div class="m_jp-RenderedImage m_jp-OutputArea-output">
<img>
</div>

</div>

</div>

</div>

</div>
<div class="m_jp-Cell-inputWrapper"><div class="m_jp-InputPrompt m_jp-InputArea-prompt">
</div><div class="m_jp-RenderedHTMLCommon m_jp-RenderedMarkdown m_jp-MarkdownOutput">
<h2 id="m_Modelo-de-árbol-de-decisión">Modelo de árbol de decisión<a class="m_anchor-link" href="https://mail-attachment.googleusercontent.com/attachment/u/2/?ui=2&amp;ik=5113226a7d&amp;attid=0.1&amp;permmsgid=msg-a:r489306242194221422&amp;th=17d741ad8789dc5f&amp;view=att&amp;disp=inline&amp;realattid=f_kwmzmtw65&amp;ser=1&amp;saddbat=ANGjdJ84PnBDA4LbNStn5wChHnm3K_vPuZhVllcGrlOQUI9JnKugcwg0-fy6BrktcTOolNRvffp3YhjKSWZUeUBN0XjzR8iu9Au9AZOiDd8hANRVARh4rEJ1874ffHrQ-ggOs9uc4PrvJAa_9Zun_DkI7KOEoJbTul2oB7yCSzT-QGLKEIu8Dk2vPNrbEk-yIE8ovRwsdS9VzC9ra7iSQjESxcr7NFWdethLSyyfMU_yZXXNfViq3DqMbO5ivNEXCdju7WWPTTNCYDMi3kPYhWb4XJsHW_QnPKI-8j-ld07TdYfkyz5ldItb6N6_fIh-96LGD9QfnuQHf9gM2tLk9fEjxHMZ3oCJ9ikWWoAzbRbG78iYwmasTDlC7ODuw9i85XQGFPVp6Z1WlDk-R0Lg14AIcA0Oncn9oGtwCqct1CX-iUniEuE5bIONSMmFIedePodV3RuCRZGSAfmC2Fy4sg7FurPk8e1vA506ZHTacOLdhOlPPZMef4fcFRMSQ_aYp5uCIfHR-FWyCPMUxUfkvpF42vprc5h_m5wtad4CRuPunhCZpqWuwBjIB3MRSSDKOfxGrTIhLvOtsQx-Q_B6CVuW3k2CnjG56iigBIoKGtyoZ0w4jSXFR5Zw6IakUy-Wf2r8_tS7MHka3cnK4Gbkfu03JMWKKXDYeQylCUpnlluNjhw-BBTo-SGv_RXtfdTiezgC_87gZDXCHq6IyngAjMpyY--rhsyqV4Mw0hbg17t6wYGgllFOqAVCWjWQamzuyk_QVhuMZ9LP4OcjDWrmkc1MgkQqxzZMCfVZn9LRvP9j2upoV-PDVu0r1MK4G30HprPfk8urnwHBTZ__CxQNlTHqOyjkUSp9DCvMQO0WvYzA73Rkr7ATDsHn_Dzm1eg#m__Modelo-de-%C3%A1rbol-de-decisi%C3%B3n" rel="noreferrer">¶</a></h2><h3 id="m_Ejecución-del-modelo">Ejecución del modelo<a class="m_anchor-link" href="https://mail-attachment.googleusercontent.com/attachment/u/2/?ui=2&amp;ik=5113226a7d&amp;attid=0.1&amp;permmsgid=msg-a:r489306242194221422&amp;th=17d741ad8789dc5f&amp;view=att&amp;disp=inline&amp;realattid=f_kwmzmtw65&amp;ser=1&amp;saddbat=ANGjdJ84PnBDA4LbNStn5wChHnm3K_vPuZhVllcGrlOQUI9JnKugcwg0-fy6BrktcTOolNRvffp3YhjKSWZUeUBN0XjzR8iu9Au9AZOiDd8hANRVARh4rEJ1874ffHrQ-ggOs9uc4PrvJAa_9Zun_DkI7KOEoJbTul2oB7yCSzT-QGLKEIu8Dk2vPNrbEk-yIE8ovRwsdS9VzC9ra7iSQjESxcr7NFWdethLSyyfMU_yZXXNfViq3DqMbO5ivNEXCdju7WWPTTNCYDMi3kPYhWb4XJsHW_QnPKI-8j-ld07TdYfkyz5ldItb6N6_fIh-96LGD9QfnuQHf9gM2tLk9fEjxHMZ3oCJ9ikWWoAzbRbG78iYwmasTDlC7ODuw9i85XQGFPVp6Z1WlDk-R0Lg14AIcA0Oncn9oGtwCqct1CX-iUniEuE5bIONSMmFIedePodV3RuCRZGSAfmC2Fy4sg7FurPk8e1vA506ZHTacOLdhOlPPZMef4fcFRMSQ_aYp5uCIfHR-FWyCPMUxUfkvpF42vprc5h_m5wtad4CRuPunhCZpqWuwBjIB3MRSSDKOfxGrTIhLvOtsQx-Q_B6CVuW3k2CnjG56iigBIoKGtyoZ0w4jSXFR5Zw6IakUy-Wf2r8_tS7MHka3cnK4Gbkfu03JMWKKXDYeQylCUpnlluNjhw-BBTo-SGv_RXtfdTiezgC_87gZDXCHq6IyngAjMpyY--rhsyqV4Mw0hbg17t6wYGgllFOqAVCWjWQamzuyk_QVhuMZ9LP4OcjDWrmkc1MgkQqxzZMCfVZn9LRvP9j2upoV-PDVu0r1MK4G30HprPfk8urnwHBTZ__CxQNlTHqOyjkUSp9DCvMQO0WvYzA73Rkr7ATDsHn_Dzm1eg#m__Ejecuci%C3%B3n-del-modelo" rel="noreferrer">¶</a></h3>
</div>
</div>
<div class="m_jp-Cell-inputWrapper"><div class="m_jp-InputPrompt m_jp-InputArea-prompt">
</div><div class="m_jp-RenderedHTMLCommon m_jp-RenderedMarkdown m_jp-MarkdownOutput">
<p>El modelo de  Ã¡rbol de decisiÃ³n en Machine Learning consiste en una estructura de Ã¡rbol similar a un diagrama de flujo donde un nodo interno representa una caracterÃ­stica o atributo, mientras que la rama representa una regla de decisiÃ³n y cada nodo hoja representa el resultado.
Como modelo para utilizar em Machine Learning tiene diversos beneficios como por ejemplo que mapean muy bien las relaciones no lineales, a diferencia por ejemplo de los modelos lineales, y se adaptan a cualquier tipo de problema.</p>

</div>
</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_kn">from</span> <span class="m_nn">sklearn.tree</span> <span class="m_kn">import</span> <span class="m_n">DecisionTreeClassifier</span>
<span class="m_kn">from</span> <span class="m_nn">sklearn.tree</span> <span class="m_kn">import</span> <span class="m_n">plot_tree</span>

<span class="m_c1"># Ãrbol de decisiÃ³n</span>
<span class="m_n">parametros</span> <span class="m_o">=</span> <span class="m_p">{</span>
    <span class="m_s1">'max_depth'</span><span class="m_p">:</span><span class="m_mi">4</span><span class="m_p">,</span>
    <span class="m_s1">'min_samples_leaf'</span><span class="m_p">:</span><span class="m_mi">20</span>
<span class="m_p">}</span>

<span class="m_n">tree</span> <span class="m_o">=</span> <span class="m_n">DecisionTreeClassifier</span><span class="m_p">(</span><span class="m_o">**</span><span class="m_n">param<wbr>etros</span><span class="m_p">)</span>
<span class="m_c1">#tree  = DecisionTreeClassifier(max_<wbr>depth=3, min_samples_leaf=20) ## Con asteriscos</span>
<span class="m_c1">#tree = DecisionTreeClassifier({'max_<wbr>depth':3, 'min_samples_leaf':20}) ## Sin asteriscos</span>

<span class="m_n">tree</span><span class="m_o">.</span><span class="m_n">fit</span><span class="m_p">(</span><span class="m_n">x_train</span><span class="m_p">,</span> <span class="m_n">y_train</span><span class="m_p">)</span>

<span class="m_c1"># Predecimos las probabilidades</span>
<span class="m_n">pred_proba_train</span> <span class="m_o">=</span> <span class="m_n">tree</span><span class="m_o">.</span><span class="m_n">predict_proba</span><span class="m_p">(</span><span class="m_n">x_train</span><span class="m_p">)</span>
<span class="m_n">prob_train_tree</span> <span class="m_o">=</span> <span class="m_n">tree</span><span class="m_o">.</span><span class="m_n">predict_proba</span><span class="m_p">(</span><span class="m_n">x_train</span><span class="m_p">)[:,</span><span class="m_mi"><wbr>1</span><span class="m_p">]</span>
<span class="m_n">prob_test_tree</span> <span class="m_o">=</span> <span class="m_n">tree</span><span class="m_o">.</span><span class="m_n">predict_proba</span><span class="m_p">(</span><span class="m_n">x_test</span><span class="m_p">)[:,</span><span class="m_mi">1</span><span class="m_p"><wbr>]</span>

<span class="m_c1"># Predecimos el resultado</span>
<span class="m_n">pred_test_tree</span> <span class="m_o">=</span> <span class="m_n">tree</span><span class="m_o">.</span><span class="m_n">predict</span><span class="m_p">(</span><span class="m_n">x_test</span><span class="m_p">)</span>

<span class="m_c1"># Pintamos el Ã¡rbol</span>
<span class="m_n">plt</span><span class="m_o">.</span><span class="m_n">figure</span><span class="m_p">(</span><span class="m_n">figsize</span><span class="m_o">=</span><span class="m_p">(</span><span class="m_mi">25</span><span class="m_p">,</span><span class="m_mi">20</span><span class="m_p">))</span>
<span class="m_n">plot_tree</span><span class="m_p">(</span><span class="m_n">tree</span><span class="m_p">,</span> <span class="m_n">feature_names</span> <span class="m_o">=</span> <span class="m_n">x_train</span><span class="m_o">.</span><span class="m_n">columns</span><span class="m_p">,</span> <span class="m_n">class_names</span> <span class="m_o">=</span> <span class="m_p">[</span><span class="m_s2">"0"</span><span class="m_p">,</span> <span class="m_s2">"1"</span><span class="m_p">],</span> <span class="m_n">filled</span><span class="m_o">=</span><span class="m_kc">True</span><span class="m_p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>




<div class="m_jp-RenderedText m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<pre>[Text(697.5, 978.48, 'term_84 &lt;= 0.5\ngini = 0.031\nsamples = 17909\nvalue = [17629, 280]\nclass = 0'),
 Text(348.75, 761.0400000000001, 'Downpayment_ratio_0 &lt;= 0.5\ngini = 0.022\nsamples = 16178\nvalue = [15997, 181]\nclass = 0'),
 Text(174.375, 543.6, 'term_72 &lt;= 0.5\ngini = 0.019\nsamples = 15268\nvalue = [15122, 146]\nclass = 0'),
 Text(87.1875, 326.1600000000001, 'Downpayment_ratio_2 &lt;= 0.5\ngini = 0.017\nsamples = 14473\nvalue = [14351, 122]\nclass = 0'),
 Text(43.59375, 108.72000000000003, 'gini = 0.016\nsamples = 14373\nvalue = [14257, 116]\nclass = 0'),
 Text(130.78125, 108.72000000000003, 'gini = 0.113\nsamples = 100\nvalue = [94, 6]\nclass = 0'),
 Text(261.5625, 326.1600000000001, 'car_status_2 &lt;= 0.5\ngini = 0.059\nsamples = 795\nvalue = [771, 24]\nclass = 0'),
 Text(217.96875, 108.72000000000003, 'gini = 0.052\nsamples = 754\nvalue = [734, 20]\nclass = 0'),
 Text(305.15625, 108.72000000000003, 'gini = 0.176\nsamples = 41\nvalue = [37, 4]\nclass = 0'),
 Text(523.125, 543.6, 'working_industry_16.0 &lt;= 0.5\ngini = 0.074\nsamples = 910\nvalue = [875, 35]\nclass = 0'),
 Text(435.9375, 326.1600000000001, 'product_2 &lt;= 0.5\ngini = 0.065\nsamples = 779\nvalue = [753, 26]\nclass = 0'),
 Text(392.34375, 108.72000000000003, 'gini = 0.058\nsamples = 733\nvalue = [711, 22]\nclass = 0'),
 Text(479.53125, 108.72000000000003, 'gini = 0.159\nsamples = 46\nvalue = [42, 4]\nclass = 0'),
 Text(610.3125, 326.1600000000001, 'num_interveners_1 &lt;= 0.5\ngini = 0.128\nsamples = 131\nvalue = [122, 9]\nclass = 0'),
 Text(566.71875, 108.72000000000003, 'gini = 0.054\nsamples = 72\nvalue = [70, 2]\nclass = 0'),
 Text(653.90625, 108.72000000000003, 'gini = 0.209\nsamples = 59\nvalue = [52, 7]\nclass = 0'),
 Text(1046.25, 761.0400000000001, 'working_status_A &lt;= 0.5\ngini = 0.108\nsamples = 1731\nvalue = [1632, 99]\nclass = 0'),
 Text(871.875, 543.6, 'working_industry_7.0 &lt;= 0.5\ngini = 0.09\nsamples = 1376\nvalue = [1311, 65]\nclass = 0'),
 Text(784.6875, 326.1600000000001, 'Downpayment_ratio_0 &lt;= 0.5\ngini = 0.085\nsamples = 1325\nvalue = [1266, 59]\nclass = 0'),
 Text(741.09375, 108.72000000000003, 'gini = 0.072\nsamples = 992\nvalue = [955, 37]\nclass = 0'),
 Text(828.28125, 108.72000000000003, 'gini = 0.123\nsamples = 333\nvalue = [311, 22]\nclass = 0'),
 Text(959.0625, 326.1600000000001, 'num_interveners_2 &lt;= 0.5\ngini = 0.208\nsamples = 51\nvalue = [45, 6]\nclass = 0'),
 Text(915.46875, 108.72000000000003, 'gini = 0.133\nsamples = 28\nvalue = [26, 2]\nclass = 0'),
 Text(1002.65625, 108.72000000000003, 'gini = 0.287\nsamples = 23\nvalue = [19, 4]\nclass = 0'),
 Text(1220.625, 543.6, 'Downpayment_ratio_0 &lt;= 0.5\ngini = 0.173\nsamples = 355\nvalue = [321, 34]\nclass = 0'),
 Text(1133.4375, 326.1600000000001, 'num_interveners_1 &lt;= 0.5\ngini = 0.124\nsamples = 257\nvalue = [240, 17]\nclass = 0'),
 Text(1089.84375, 108.72000000000003, 'gini = 0.176\nsamples = 123\nvalue = [111, 12]\nclass = 0'),
 Text(1177.03125, 108.72000000000003, 'gini = 0.072\nsamples = 134\nvalue = [129, 5]\nclass = 0'),
 Text(1307.8125, 326.1600000000001, 'num_interveners_2 &lt;= 0.5\ngini = 0.287\nsamples = 98\nvalue = [81, 17]\nclass = 0'),
 Text(1264.21875, 108.72000000000003, 'gini = 0.315\nsamples = 46\nvalue = [37, 9]\nclass = 0'),
 Text(1351.40625, 108.72000000000003, 'gini = 0.26\nsamples = 52\nvalue = [44, 8]\nclass = 0')]</pre>
</div>

</div>

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt"></div>




<div class="m_jp-RenderedImage m_jp-OutputArea-output">
<img>
</div>

</div>

</div>

</div>

</div>
<div class="m_jp-Cell-inputWrapper"><div class="m_jp-InputPrompt m_jp-InputArea-prompt">
</div><div class="m_jp-RenderedHTMLCommon m_jp-RenderedMarkdown m_jp-MarkdownOutput">
<h3 id="m_Evaluación-del-modelo:-Matriz-de-confusión">Evaluación del modelo: Matriz de confusión<a class="m_anchor-link" href="https://mail-attachment.googleusercontent.com/attachment/u/2/?ui=2&amp;ik=5113226a7d&amp;attid=0.1&amp;permmsgid=msg-a:r489306242194221422&amp;th=17d741ad8789dc5f&amp;view=att&amp;disp=inline&amp;realattid=f_kwmzmtw65&amp;ser=1&amp;saddbat=ANGjdJ84PnBDA4LbNStn5wChHnm3K_vPuZhVllcGrlOQUI9JnKugcwg0-fy6BrktcTOolNRvffp3YhjKSWZUeUBN0XjzR8iu9Au9AZOiDd8hANRVARh4rEJ1874ffHrQ-ggOs9uc4PrvJAa_9Zun_DkI7KOEoJbTul2oB7yCSzT-QGLKEIu8Dk2vPNrbEk-yIE8ovRwsdS9VzC9ra7iSQjESxcr7NFWdethLSyyfMU_yZXXNfViq3DqMbO5ivNEXCdju7WWPTTNCYDMi3kPYhWb4XJsHW_QnPKI-8j-ld07TdYfkyz5ldItb6N6_fIh-96LGD9QfnuQHf9gM2tLk9fEjxHMZ3oCJ9ikWWoAzbRbG78iYwmasTDlC7ODuw9i85XQGFPVp6Z1WlDk-R0Lg14AIcA0Oncn9oGtwCqct1CX-iUniEuE5bIONSMmFIedePodV3RuCRZGSAfmC2Fy4sg7FurPk8e1vA506ZHTacOLdhOlPPZMef4fcFRMSQ_aYp5uCIfHR-FWyCPMUxUfkvpF42vprc5h_m5wtad4CRuPunhCZpqWuwBjIB3MRSSDKOfxGrTIhLvOtsQx-Q_B6CVuW3k2CnjG56iigBIoKGtyoZ0w4jSXFR5Zw6IakUy-Wf2r8_tS7MHka3cnK4Gbkfu03JMWKKXDYeQylCUpnlluNjhw-BBTo-SGv_RXtfdTiezgC_87gZDXCHq6IyngAjMpyY--rhsyqV4Mw0hbg17t6wYGgllFOqAVCWjWQamzuyk_QVhuMZ9LP4OcjDWrmkc1MgkQqxzZMCfVZn9LRvP9j2upoV-PDVu0r1MK4G30HprPfk8urnwHBTZ__CxQNlTHqOyjkUSp9DCvMQO0WvYzA73Rkr7ATDsHn_Dzm1eg#m__Evaluaci%C3%B3n-del-modelo:-Matriz-de-confusi%C3%B3n" rel="noreferrer">¶</a></h3>
</div>
</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_c1"># Pintamos la matriz de confusiÃ³n</span>
<span class="m_nb">print</span><span class="m_p">(</span><span class="m_n">confusion_matrix</span><span class="m_p">(</span><span class="m_n">y_test</span><span class="m_p">,</span> <span class="m_n">pred_test_tree</span><span class="m_p">))</span>
<span class="m_nb">print</span><span class="m_p">(</span><span class="m_n">classification_report</span><span class="m_p">(</span><span class="m_n">y_<wbr>test</span><span class="m_p">,</span> <span class="m_n">pred_test_tree</span><span class="m_p">))</span>
<span class="m_n">plot_confusion_matrix</span><span class="m_p">(</span><span class="m_n">tree</span><span class="m_p">,</span> <span class="m_n">x_test</span><span class="m_p">,</span> <span class="m_n">y_test</span><span class="m_p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt"></div>


<div class="m_jp-RenderedText m_jp-OutputArea-output">
<pre>[[7565    0]
 [ 111    0]]
              precision    recall  f1-score   support

           0       0.99      1.00      0.99      7565
           1       0.00      0.00      0.00       111

    accuracy                           0.99      7676
   macro avg       0.49      0.50      0.50      7676
weighted avg       0.97      0.99      0.98      7676

</pre>
</div>
</div>

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt"></div>


<div class="m_jp-RenderedText m_jp-OutputArea-output">
<pre>C:\Users\Usuario\anaconda3\<wbr>lib\site-packages\sklearn\<wbr>metrics\_classification.py:<wbr>1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
C:\Users\Usuario\anaconda3\<wbr>lib\site-packages\sklearn\<wbr>metrics\_classification.py:<wbr>1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
C:\Users\Usuario\anaconda3\<wbr>lib\site-packages\sklearn\<wbr>metrics\_classification.py:<wbr>1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
</pre>
</div>
</div>

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>




<div class="m_jp-RenderedText m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<pre>&lt;sklearn.metrics._plot.<wbr>confusion_matrix.<wbr>ConfusionMatrixDisplay at 0x24ef4c2b8e0&gt;</pre>
</div>

</div>

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt"></div>




<div class="m_jp-RenderedImage m_jp-OutputArea-output">
<img>
</div>

</div>

</div>

</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_c1"># Sacamos los Gini y la curva ROC</span>
<span class="m_nb">print</span><span class="m_p">(</span><span class="m_s2">"Gini Train: "</span><span class="m_p">,</span> <span class="m_mi">100</span><span class="m_o">*</span><span class="m_p">(</span><span class="m_mi">2</span><span class="m_o">*</span><span class="m_n">roc_auc_score</span><span class="m_p">(</span><span class="m_n">y_train</span><span class="m_p">,</span> <span class="m_n">prob_train_tree</span><span class="m_p">)</span><span class="m_o">-</span><span class="m_mi">1</span><span class="m_p">))</span>
<span class="m_nb">print</span><span class="m_p">(</span><span class="m_s2">"Gini Test: "</span><span class="m_p">,</span> <span class="m_mi">100</span><span class="m_o">*</span><span class="m_p">(</span><span class="m_mi">2</span><span class="m_o">*</span><span class="m_n">roc_auc_score</span><span class="m_p">(</span><span class="m_n">y_test</span><span class="m_p">,</span> <span class="m_n">prob_test_tree</span><span class="m_p">)</span><span class="m_o">-</span><span class="m_mi">1</span><span class="m_p">))</span>
<span class="m_n">plot_roc_curve</span><span class="m_p">(</span><span class="m_n">tree</span><span class="m_p">,</span> <span class="m_n">x_test</span><span class="m_p">,</span> <span class="m_n">y_test</span><span class="m_p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt"></div>


<div class="m_jp-RenderedText m_jp-OutputArea-output">
<pre>Gini Train:  42.845412996442576
Gini Test:  43.411276444984324
</pre>
</div>
</div>

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>




<div class="m_jp-RenderedText m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<pre>&lt;sklearn.metrics._plot.roc_<wbr>curve.RocCurveDisplay at 0x24ef5489490&gt;</pre>
</div>

</div>

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt"></div>




<div class="m_jp-RenderedImage m_jp-OutputArea-output">
<img>
</div>

</div>

</div>

</div>

</div>
<div class="m_jp-Cell-inputWrapper"><div class="m_jp-InputPrompt m_jp-InputArea-prompt">
</div><div class="m_jp-RenderedHTMLCommon m_jp-RenderedMarkdown m_jp-MarkdownOutput">
<p>Como conclusion del modelo de Arbol de Decision, podemos decir que los indicadores de Gini tanto en train como en test, son de 
42.84 Vs 43.41 respectivamente, y en donde el AUC = 0.72, lo que se considera un AUC aceptable.</p>

</div>
</div>
<div class="m_jp-Cell-inputWrapper"><div class="m_jp-InputPrompt m_jp-InputArea-prompt">
</div><div class="m_jp-RenderedHTMLCommon m_jp-RenderedMarkdown m_jp-MarkdownOutput">
<h2 id="m_Modelo-de-regresión-logística">Modelo de regresión logística<a class="m_anchor-link" href="https://mail-attachment.googleusercontent.com/attachment/u/2/?ui=2&amp;ik=5113226a7d&amp;attid=0.1&amp;permmsgid=msg-a:r489306242194221422&amp;th=17d741ad8789dc5f&amp;view=att&amp;disp=inline&amp;realattid=f_kwmzmtw65&amp;ser=1&amp;saddbat=ANGjdJ84PnBDA4LbNStn5wChHnm3K_vPuZhVllcGrlOQUI9JnKugcwg0-fy6BrktcTOolNRvffp3YhjKSWZUeUBN0XjzR8iu9Au9AZOiDd8hANRVARh4rEJ1874ffHrQ-ggOs9uc4PrvJAa_9Zun_DkI7KOEoJbTul2oB7yCSzT-QGLKEIu8Dk2vPNrbEk-yIE8ovRwsdS9VzC9ra7iSQjESxcr7NFWdethLSyyfMU_yZXXNfViq3DqMbO5ivNEXCdju7WWPTTNCYDMi3kPYhWb4XJsHW_QnPKI-8j-ld07TdYfkyz5ldItb6N6_fIh-96LGD9QfnuQHf9gM2tLk9fEjxHMZ3oCJ9ikWWoAzbRbG78iYwmasTDlC7ODuw9i85XQGFPVp6Z1WlDk-R0Lg14AIcA0Oncn9oGtwCqct1CX-iUniEuE5bIONSMmFIedePodV3RuCRZGSAfmC2Fy4sg7FurPk8e1vA506ZHTacOLdhOlPPZMef4fcFRMSQ_aYp5uCIfHR-FWyCPMUxUfkvpF42vprc5h_m5wtad4CRuPunhCZpqWuwBjIB3MRSSDKOfxGrTIhLvOtsQx-Q_B6CVuW3k2CnjG56iigBIoKGtyoZ0w4jSXFR5Zw6IakUy-Wf2r8_tS7MHka3cnK4Gbkfu03JMWKKXDYeQylCUpnlluNjhw-BBTo-SGv_RXtfdTiezgC_87gZDXCHq6IyngAjMpyY--rhsyqV4Mw0hbg17t6wYGgllFOqAVCWjWQamzuyk_QVhuMZ9LP4OcjDWrmkc1MgkQqxzZMCfVZn9LRvP9j2upoV-PDVu0r1MK4G30HprPfk8urnwHBTZ__CxQNlTHqOyjkUSp9DCvMQO0WvYzA73Rkr7ATDsHn_Dzm1eg#m__Modelo-de-regresi%C3%B3n-log%C3%ADstica" rel="noreferrer">¶</a></h2><h3 id="m_Ejecución-de-modelo">Ejecución de modelo<a class="m_anchor-link" href="https://mail-attachment.googleusercontent.com/attachment/u/2/?ui=2&amp;ik=5113226a7d&amp;attid=0.1&amp;permmsgid=msg-a:r489306242194221422&amp;th=17d741ad8789dc5f&amp;view=att&amp;disp=inline&amp;realattid=f_kwmzmtw65&amp;ser=1&amp;saddbat=ANGjdJ84PnBDA4LbNStn5wChHnm3K_vPuZhVllcGrlOQUI9JnKugcwg0-fy6BrktcTOolNRvffp3YhjKSWZUeUBN0XjzR8iu9Au9AZOiDd8hANRVARh4rEJ1874ffHrQ-ggOs9uc4PrvJAa_9Zun_DkI7KOEoJbTul2oB7yCSzT-QGLKEIu8Dk2vPNrbEk-yIE8ovRwsdS9VzC9ra7iSQjESxcr7NFWdethLSyyfMU_yZXXNfViq3DqMbO5ivNEXCdju7WWPTTNCYDMi3kPYhWb4XJsHW_QnPKI-8j-ld07TdYfkyz5ldItb6N6_fIh-96LGD9QfnuQHf9gM2tLk9fEjxHMZ3oCJ9ikWWoAzbRbG78iYwmasTDlC7ODuw9i85XQGFPVp6Z1WlDk-R0Lg14AIcA0Oncn9oGtwCqct1CX-iUniEuE5bIONSMmFIedePodV3RuCRZGSAfmC2Fy4sg7FurPk8e1vA506ZHTacOLdhOlPPZMef4fcFRMSQ_aYp5uCIfHR-FWyCPMUxUfkvpF42vprc5h_m5wtad4CRuPunhCZpqWuwBjIB3MRSSDKOfxGrTIhLvOtsQx-Q_B6CVuW3k2CnjG56iigBIoKGtyoZ0w4jSXFR5Zw6IakUy-Wf2r8_tS7MHka3cnK4Gbkfu03JMWKKXDYeQylCUpnlluNjhw-BBTo-SGv_RXtfdTiezgC_87gZDXCHq6IyngAjMpyY--rhsyqV4Mw0hbg17t6wYGgllFOqAVCWjWQamzuyk_QVhuMZ9LP4OcjDWrmkc1MgkQqxzZMCfVZn9LRvP9j2upoV-PDVu0r1MK4G30HprPfk8urnwHBTZ__CxQNlTHqOyjkUSp9DCvMQO0WvYzA73Rkr7ATDsHn_Dzm1eg#m__Ejecuci%C3%B3n-de-modelo" rel="noreferrer">¶</a></h3>
</div>
</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_kn">from</span> <span class="m_nn">sklearn.linear_model</span> <span class="m_kn">import</span> <span class="m_n">LogisticRegression</span>

<span class="m_c1"># RegresiÃ³n logÃ­stica</span>
<span class="m_n">logreg</span> <span class="m_o">=</span> <span class="m_n">LogisticRegression</span><span class="m_p">()</span>
<span class="m_n">logreg</span><span class="m_o">.</span><span class="m_n">fit</span><span class="m_p">(</span><span class="m_n">x_train</span><span class="m_p">,</span> <span class="m_n">y_train</span><span class="m_p">)</span>

<span class="m_c1"># Predecimos las probabilidades</span>
<span class="m_n">prob_train_logreg</span> <span class="m_o">=</span> <span class="m_n">logreg</span><span class="m_o">.</span><span class="m_n">predict_proba</span><span class="m_p">(</span><span class="m_n">x_train</span><span class="m_p">)[<wbr>:,</span><span class="m_mi">1</span><span class="m_p">]</span>
<span class="m_n">prob_test_logreg</span> <span class="m_o">=</span> <span class="m_n">logreg</span><span class="m_o">.</span><span class="m_n">predict_proba</span><span class="m_p">(</span><span class="m_n">x_test</span><span class="m_p">)[:<wbr>,</span><span class="m_mi">1</span><span class="m_p">]</span>

<span class="m_c1"># Predecimos el resultado</span>
<span class="m_n">pred_test_logreg</span> <span class="m_o">=</span> <span class="m_n">logreg</span><span class="m_o">.</span><span class="m_n">predict</span><span class="m_p">(</span><span class="m_n">x_test</span><span class="m_p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt"></div>


<div class="m_jp-RenderedText m_jp-OutputArea-output">
<pre>C:\Users\Usuario\anaconda3\<wbr>lib\site-packages\sklearn\<wbr>linear_model\_logistic.py:763: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    <a href="https://www.google.com/url?q=https://scikit-learn.org/stable/modules/preprocessing.html&amp;source=gmail-html&amp;ust=1660823776004000&amp;usg=AOvVaw1bAmyqrgmxdQ0R0lJWKwov" target="_blank" rel="noreferrer">https://scikit-learn.org/<wbr>stable/modules/preprocessing.<wbr>html</a>
Please also refer to the documentation for alternative solver options:
    <a href="https://www.google.com/url?q=https://scikit-learn.org/stable/modules/linear_model.html%23logistic-regression&amp;source=gmail-html&amp;ust=1660823776004000&amp;usg=AOvVaw1uV9bJftRnzILrMBI8zN4L" target="_blank" rel="noreferrer">https://scikit-learn.org/<wbr>stable/modules/linear_model.<wbr>html#logistic-regression</a>
  n_iter_i = _check_optimize_result(
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="m_jp-Cell-inputWrapper"><div class="m_jp-InputPrompt m_jp-InputArea-prompt">
</div><div class="m_jp-RenderedHTMLCommon m_jp-RenderedMarkdown m_jp-MarkdownOutput">
<h3 id="m_Evaluación-del-modelo:-Matriz-de-confusión">Evaluación del modelo: Matriz de confusión<a class="m_anchor-link" href="https://mail-attachment.googleusercontent.com/attachment/u/2/?ui=2&amp;ik=5113226a7d&amp;attid=0.1&amp;permmsgid=msg-a:r489306242194221422&amp;th=17d741ad8789dc5f&amp;view=att&amp;disp=inline&amp;realattid=f_kwmzmtw65&amp;ser=1&amp;saddbat=ANGjdJ84PnBDA4LbNStn5wChHnm3K_vPuZhVllcGrlOQUI9JnKugcwg0-fy6BrktcTOolNRvffp3YhjKSWZUeUBN0XjzR8iu9Au9AZOiDd8hANRVARh4rEJ1874ffHrQ-ggOs9uc4PrvJAa_9Zun_DkI7KOEoJbTul2oB7yCSzT-QGLKEIu8Dk2vPNrbEk-yIE8ovRwsdS9VzC9ra7iSQjESxcr7NFWdethLSyyfMU_yZXXNfViq3DqMbO5ivNEXCdju7WWPTTNCYDMi3kPYhWb4XJsHW_QnPKI-8j-ld07TdYfkyz5ldItb6N6_fIh-96LGD9QfnuQHf9gM2tLk9fEjxHMZ3oCJ9ikWWoAzbRbG78iYwmasTDlC7ODuw9i85XQGFPVp6Z1WlDk-R0Lg14AIcA0Oncn9oGtwCqct1CX-iUniEuE5bIONSMmFIedePodV3RuCRZGSAfmC2Fy4sg7FurPk8e1vA506ZHTacOLdhOlPPZMef4fcFRMSQ_aYp5uCIfHR-FWyCPMUxUfkvpF42vprc5h_m5wtad4CRuPunhCZpqWuwBjIB3MRSSDKOfxGrTIhLvOtsQx-Q_B6CVuW3k2CnjG56iigBIoKGtyoZ0w4jSXFR5Zw6IakUy-Wf2r8_tS7MHka3cnK4Gbkfu03JMWKKXDYeQylCUpnlluNjhw-BBTo-SGv_RXtfdTiezgC_87gZDXCHq6IyngAjMpyY--rhsyqV4Mw0hbg17t6wYGgllFOqAVCWjWQamzuyk_QVhuMZ9LP4OcjDWrmkc1MgkQqxzZMCfVZn9LRvP9j2upoV-PDVu0r1MK4G30HprPfk8urnwHBTZ__CxQNlTHqOyjkUSp9DCvMQO0WvYzA73Rkr7ATDsHn_Dzm1eg#m__Evaluaci%C3%B3n-del-modelo:-Matriz-de-confusi%C3%B3n" rel="noreferrer">¶</a></h3>
</div>
</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_c1"># Pintamos la matriz de confusiÃ³n</span>
<span class="m_nb">print</span><span class="m_p">(</span><span class="m_n">confusion_matrix</span><span class="m_p">(</span><span class="m_n">y_test</span><span class="m_p">,</span> <span class="m_n">pred_test_logreg</span><span class="m_p">))</span>
<span class="m_nb">print</span><span class="m_p">(</span><span class="m_n">classification_report</span><span class="m_p">(</span><span class="m_n">y_<wbr>test</span><span class="m_p">,</span> <span class="m_n">pred_test_logreg</span><span class="m_p">))</span>
<span class="m_n">plot_confusion_matrix</span><span class="m_p">(</span><span class="m_n">logreg</span><span class="m_p">,</span> <span class="m_n">x_test</span><span class="m_p">,</span> <span class="m_n">y_test</span><span class="m_p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt"></div>


<div class="m_jp-RenderedText m_jp-OutputArea-output">
<pre>[[7565    0]
 [ 111    0]]
              precision    recall  f1-score   support

           0       0.99      1.00      0.99      7565
           1       0.00      0.00      0.00       111

    accuracy                           0.99      7676
   macro avg       0.49      0.50      0.50      7676
weighted avg       0.97      0.99      0.98      7676

</pre>
</div>
</div>

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt"></div>


<div class="m_jp-RenderedText m_jp-OutputArea-output">
<pre>C:\Users\Usuario\anaconda3\<wbr>lib\site-packages\sklearn\<wbr>metrics\_classification.py:<wbr>1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
C:\Users\Usuario\anaconda3\<wbr>lib\site-packages\sklearn\<wbr>metrics\_classification.py:<wbr>1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
C:\Users\Usuario\anaconda3\<wbr>lib\site-packages\sklearn\<wbr>metrics\_classification.py:<wbr>1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
</pre>
</div>
</div>

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>




<div class="m_jp-RenderedText m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<pre>&lt;sklearn.metrics._plot.<wbr>confusion_matrix.<wbr>ConfusionMatrixDisplay at 0x24ef55fa9a0&gt;</pre>
</div>

</div>

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt"></div>




<div class="m_jp-RenderedImage m_jp-OutputArea-output">
<img>
</div>

</div>

</div>

</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_c1"># Sacamos los Gini y la curva ROC</span>
<span class="m_nb">print</span><span class="m_p">(</span><span class="m_s2">"Gini Train: "</span><span class="m_p">,</span> <span class="m_mi">100</span><span class="m_o">*</span><span class="m_p">(</span><span class="m_mi">2</span><span class="m_o">*</span><span class="m_n">roc_auc_score</span><span class="m_p">(</span><span class="m_n">y_train</span><span class="m_p">,</span> <span class="m_n">prob_train_logreg</span><span class="m_p">)</span><span class="m_o">-</span><span class="m_mi">1</span><span class="m_p">))</span>
<span class="m_nb">print</span><span class="m_p">(</span><span class="m_s2">"Gini Test: "</span><span class="m_p">,</span> <span class="m_mi">100</span><span class="m_o">*</span><span class="m_p">(</span><span class="m_mi">2</span><span class="m_o">*</span><span class="m_n">roc_auc_score</span><span class="m_p">(</span><span class="m_n">y_test</span><span class="m_p">,</span> <span class="m_n">prob_test_logreg</span><span class="m_p">)</span><span class="m_o">-</span><span class="m_mi">1</span><span class="m_p">))</span>
<span class="m_n">plot_roc_curve</span><span class="m_p">(</span><span class="m_n">logreg</span><span class="m_p">,</span> <span class="m_n">x_test</span><span class="m_p">,</span> <span class="m_n">y_test</span><span class="m_p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt"></div>


<div class="m_jp-RenderedText m_jp-OutputArea-output">
<pre>Gini Train:  68.1789543203974
Gini Test:  62.636251585359304
</pre>
</div>
</div>

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>




<div class="m_jp-RenderedText m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<pre>&lt;sklearn.metrics._plot.roc_<wbr>curve.RocCurveDisplay at 0x24ef3411df0&gt;</pre>
</div>

</div>

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt"></div>




<div class="m_jp-RenderedImage m_jp-OutputArea-output">
<img>
</div>

</div>

</div>

</div>

</div>
<div class="m_jp-Cell-inputWrapper"><div class="m_jp-InputPrompt m_jp-InputArea-prompt">
</div><div class="m_jp-RenderedHTMLCommon m_jp-RenderedMarkdown m_jp-MarkdownOutput">
<h1 id="m_Modelo-de-Random-Forest">Modelo de Random Forest<a class="m_anchor-link" href="https://mail-attachment.googleusercontent.com/attachment/u/2/?ui=2&amp;ik=5113226a7d&amp;attid=0.1&amp;permmsgid=msg-a:r489306242194221422&amp;th=17d741ad8789dc5f&amp;view=att&amp;disp=inline&amp;realattid=f_kwmzmtw65&amp;ser=1&amp;saddbat=ANGjdJ84PnBDA4LbNStn5wChHnm3K_vPuZhVllcGrlOQUI9JnKugcwg0-fy6BrktcTOolNRvffp3YhjKSWZUeUBN0XjzR8iu9Au9AZOiDd8hANRVARh4rEJ1874ffHrQ-ggOs9uc4PrvJAa_9Zun_DkI7KOEoJbTul2oB7yCSzT-QGLKEIu8Dk2vPNrbEk-yIE8ovRwsdS9VzC9ra7iSQjESxcr7NFWdethLSyyfMU_yZXXNfViq3DqMbO5ivNEXCdju7WWPTTNCYDMi3kPYhWb4XJsHW_QnPKI-8j-ld07TdYfkyz5ldItb6N6_fIh-96LGD9QfnuQHf9gM2tLk9fEjxHMZ3oCJ9ikWWoAzbRbG78iYwmasTDlC7ODuw9i85XQGFPVp6Z1WlDk-R0Lg14AIcA0Oncn9oGtwCqct1CX-iUniEuE5bIONSMmFIedePodV3RuCRZGSAfmC2Fy4sg7FurPk8e1vA506ZHTacOLdhOlPPZMef4fcFRMSQ_aYp5uCIfHR-FWyCPMUxUfkvpF42vprc5h_m5wtad4CRuPunhCZpqWuwBjIB3MRSSDKOfxGrTIhLvOtsQx-Q_B6CVuW3k2CnjG56iigBIoKGtyoZ0w4jSXFR5Zw6IakUy-Wf2r8_tS7MHka3cnK4Gbkfu03JMWKKXDYeQylCUpnlluNjhw-BBTo-SGv_RXtfdTiezgC_87gZDXCHq6IyngAjMpyY--rhsyqV4Mw0hbg17t6wYGgllFOqAVCWjWQamzuyk_QVhuMZ9LP4OcjDWrmkc1MgkQqxzZMCfVZn9LRvP9j2upoV-PDVu0r1MK4G30HprPfk8urnwHBTZ__CxQNlTHqOyjkUSp9DCvMQO0WvYzA73Rkr7ATDsHn_Dzm1eg#m__Modelo-de-Random-Forest" rel="noreferrer">¶</a></h1><h2 id="m_Ejecución-del-modelo">Ejecución del modelo<a class="m_anchor-link" href="https://mail-attachment.googleusercontent.com/attachment/u/2/?ui=2&amp;ik=5113226a7d&amp;attid=0.1&amp;permmsgid=msg-a:r489306242194221422&amp;th=17d741ad8789dc5f&amp;view=att&amp;disp=inline&amp;realattid=f_kwmzmtw65&amp;ser=1&amp;saddbat=ANGjdJ84PnBDA4LbNStn5wChHnm3K_vPuZhVllcGrlOQUI9JnKugcwg0-fy6BrktcTOolNRvffp3YhjKSWZUeUBN0XjzR8iu9Au9AZOiDd8hANRVARh4rEJ1874ffHrQ-ggOs9uc4PrvJAa_9Zun_DkI7KOEoJbTul2oB7yCSzT-QGLKEIu8Dk2vPNrbEk-yIE8ovRwsdS9VzC9ra7iSQjESxcr7NFWdethLSyyfMU_yZXXNfViq3DqMbO5ivNEXCdju7WWPTTNCYDMi3kPYhWb4XJsHW_QnPKI-8j-ld07TdYfkyz5ldItb6N6_fIh-96LGD9QfnuQHf9gM2tLk9fEjxHMZ3oCJ9ikWWoAzbRbG78iYwmasTDlC7ODuw9i85XQGFPVp6Z1WlDk-R0Lg14AIcA0Oncn9oGtwCqct1CX-iUniEuE5bIONSMmFIedePodV3RuCRZGSAfmC2Fy4sg7FurPk8e1vA506ZHTacOLdhOlPPZMef4fcFRMSQ_aYp5uCIfHR-FWyCPMUxUfkvpF42vprc5h_m5wtad4CRuPunhCZpqWuwBjIB3MRSSDKOfxGrTIhLvOtsQx-Q_B6CVuW3k2CnjG56iigBIoKGtyoZ0w4jSXFR5Zw6IakUy-Wf2r8_tS7MHka3cnK4Gbkfu03JMWKKXDYeQylCUpnlluNjhw-BBTo-SGv_RXtfdTiezgC_87gZDXCHq6IyngAjMpyY--rhsyqV4Mw0hbg17t6wYGgllFOqAVCWjWQamzuyk_QVhuMZ9LP4OcjDWrmkc1MgkQqxzZMCfVZn9LRvP9j2upoV-PDVu0r1MK4G30HprPfk8urnwHBTZ__CxQNlTHqOyjkUSp9DCvMQO0WvYzA73Rkr7ATDsHn_Dzm1eg#m__Ejecuci%C3%B3n-del-modelo" rel="noreferrer">¶</a></h2>
</div>
</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell m_jp-mod-noOutputs">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_kn">from</span> <span class="m_nn">sklearn.ensemble</span> <span class="m_kn">import</span> <span class="m_n">RandomForestClassifier</span>

<span class="m_c1"># Random Forest</span>
<span class="m_n">parametros</span> <span class="m_o">=</span> <span class="m_p">{</span>
    <span class="m_s1">'n_estimators'</span><span class="m_p">:</span><span class="m_mi">100</span><span class="m_p">,</span>
    <span class="m_s1">'max_depth'</span><span class="m_p">:</span><span class="m_mi">4</span><span class="m_p">,</span>
    <span class="m_s1">'min_samples_leaf'</span><span class="m_p">:</span><span class="m_mi">20</span>
<span class="m_p">}</span>

<span class="m_n">rf</span> <span class="m_o">=</span> <span class="m_n">RandomForestClassifier</span><span class="m_p">(</span><span class="m_o">**</span><span class="m_n">param<wbr>etros</span><span class="m_p">)</span>
<span class="m_n">rf</span><span class="m_o">.</span><span class="m_n">fit</span><span class="m_p">(</span><span class="m_n">x_train</span><span class="m_p">,</span> <span class="m_n">y_train</span><span class="m_p">)</span>

<span class="m_c1"># Predecimos las probabilidades</span>
<span class="m_n">prob_train_rf</span> <span class="m_o">=</span> <span class="m_n">rf</span><span class="m_o">.</span><span class="m_n">predict_proba</span><span class="m_p">(</span><span class="m_n">x_train</span><span class="m_p">)[:,</span><span class="m_mi">1</span><span class="m_p">]</span>
<span class="m_n">prob_test_rf</span> <span class="m_o">=</span> <span class="m_n">rf</span><span class="m_o">.</span><span class="m_n">predict_proba</span><span class="m_p">(</span><span class="m_n">x_test</span><span class="m_p">)[:,</span><span class="m_mi">1</span><span class="m_p">]</span>

<span class="m_c1"># Predecimos el resultado</span>
<span class="m_n">pred_test_rf</span> <span class="m_o">=</span> <span class="m_n">rf</span><span class="m_o">.</span><span class="m_n">predict</span><span class="m_p">(</span><span class="m_n">x_test</span><span class="m_p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="m_jp-Cell-inputWrapper"><div class="m_jp-InputPrompt m_jp-InputArea-prompt">
</div><div class="m_jp-RenderedHTMLCommon m_jp-RenderedMarkdown m_jp-MarkdownOutput">
<h3 id="m_Evaluación-del-modelo:-Matriz-de-confusión">Evaluación del modelo: Matriz de confusión<a class="m_anchor-link" href="https://mail-attachment.googleusercontent.com/attachment/u/2/?ui=2&amp;ik=5113226a7d&amp;attid=0.1&amp;permmsgid=msg-a:r489306242194221422&amp;th=17d741ad8789dc5f&amp;view=att&amp;disp=inline&amp;realattid=f_kwmzmtw65&amp;ser=1&amp;saddbat=ANGjdJ84PnBDA4LbNStn5wChHnm3K_vPuZhVllcGrlOQUI9JnKugcwg0-fy6BrktcTOolNRvffp3YhjKSWZUeUBN0XjzR8iu9Au9AZOiDd8hANRVARh4rEJ1874ffHrQ-ggOs9uc4PrvJAa_9Zun_DkI7KOEoJbTul2oB7yCSzT-QGLKEIu8Dk2vPNrbEk-yIE8ovRwsdS9VzC9ra7iSQjESxcr7NFWdethLSyyfMU_yZXXNfViq3DqMbO5ivNEXCdju7WWPTTNCYDMi3kPYhWb4XJsHW_QnPKI-8j-ld07TdYfkyz5ldItb6N6_fIh-96LGD9QfnuQHf9gM2tLk9fEjxHMZ3oCJ9ikWWoAzbRbG78iYwmasTDlC7ODuw9i85XQGFPVp6Z1WlDk-R0Lg14AIcA0Oncn9oGtwCqct1CX-iUniEuE5bIONSMmFIedePodV3RuCRZGSAfmC2Fy4sg7FurPk8e1vA506ZHTacOLdhOlPPZMef4fcFRMSQ_aYp5uCIfHR-FWyCPMUxUfkvpF42vprc5h_m5wtad4CRuPunhCZpqWuwBjIB3MRSSDKOfxGrTIhLvOtsQx-Q_B6CVuW3k2CnjG56iigBIoKGtyoZ0w4jSXFR5Zw6IakUy-Wf2r8_tS7MHka3cnK4Gbkfu03JMWKKXDYeQylCUpnlluNjhw-BBTo-SGv_RXtfdTiezgC_87gZDXCHq6IyngAjMpyY--rhsyqV4Mw0hbg17t6wYGgllFOqAVCWjWQamzuyk_QVhuMZ9LP4OcjDWrmkc1MgkQqxzZMCfVZn9LRvP9j2upoV-PDVu0r1MK4G30HprPfk8urnwHBTZ__CxQNlTHqOyjkUSp9DCvMQO0WvYzA73Rkr7ATDsHn_Dzm1eg#m__Evaluaci%C3%B3n-del-modelo:-Matriz-de-confusi%C3%B3n" rel="noreferrer">¶</a></h3>
</div>
</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_c1"># Pintamos la matriz de confusiÃ³n</span>
<span class="m_nb">print</span><span class="m_p">(</span><span class="m_n">confusion_matrix</span><span class="m_p">(</span><span class="m_n">y_test</span><span class="m_p">,</span> <span class="m_n">pred_test_rf</span><span class="m_p">))</span>
<span class="m_nb">print</span><span class="m_p">(</span><span class="m_n">classification_report</span><span class="m_p">(</span><span class="m_n">y_<wbr>test</span><span class="m_p">,</span> <span class="m_n">pred_test_rf</span><span class="m_p">))</span>
<span class="m_n">plot_confusion_matrix</span><span class="m_p">(</span><span class="m_n">rf</span><span class="m_p">,</span> <span class="m_n">x_test</span><span class="m_p">,</span> <span class="m_n">y_test</span><span class="m_p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt"></div>


<div class="m_jp-RenderedText m_jp-OutputArea-output">
<pre>[[7565    0]
 [ 111    0]]
              precision    recall  f1-score   support

           0       0.99      1.00      0.99      7565
           1       0.00      0.00      0.00       111

    accuracy                           0.99      7676
   macro avg       0.49      0.50      0.50      7676
weighted avg       0.97      0.99      0.98      7676

</pre>
</div>
</div>

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt"></div>


<div class="m_jp-RenderedText m_jp-OutputArea-output">
<pre>C:\Users\Usuario\anaconda3\<wbr>lib\site-packages\sklearn\<wbr>metrics\_classification.py:<wbr>1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
C:\Users\Usuario\anaconda3\<wbr>lib\site-packages\sklearn\<wbr>metrics\_classification.py:<wbr>1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
C:\Users\Usuario\anaconda3\<wbr>lib\site-packages\sklearn\<wbr>metrics\_classification.py:<wbr>1245: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
</pre>
</div>
</div>

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>




<div class="m_jp-RenderedText m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<pre>&lt;sklearn.metrics._plot.<wbr>confusion_matrix.<wbr>ConfusionMatrixDisplay at 0x24ef5493670&gt;</pre>
</div>

</div>

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt"></div>




<div class="m_jp-RenderedImage m_jp-OutputArea-output">
<img>
</div>

</div>

</div>

</div>

</div>
<div class="m_jp-Cell-inputWrapper"><div class="m_jp-InputPrompt m_jp-InputArea-prompt">
</div><div class="m_jp-RenderedHTMLCommon m_jp-RenderedMarkdown m_jp-MarkdownOutput">
<h3 id="m_Evaluación-del-modelo:-Gini-(AUC)-y-curva-ROC">Evaluación del modelo: Gini (AUC) y curva ROC<a class="m_anchor-link" href="https://mail-attachment.googleusercontent.com/attachment/u/2/?ui=2&amp;ik=5113226a7d&amp;attid=0.1&amp;permmsgid=msg-a:r489306242194221422&amp;th=17d741ad8789dc5f&amp;view=att&amp;disp=inline&amp;realattid=f_kwmzmtw65&amp;ser=1&amp;saddbat=ANGjdJ84PnBDA4LbNStn5wChHnm3K_vPuZhVllcGrlOQUI9JnKugcwg0-fy6BrktcTOolNRvffp3YhjKSWZUeUBN0XjzR8iu9Au9AZOiDd8hANRVARh4rEJ1874ffHrQ-ggOs9uc4PrvJAa_9Zun_DkI7KOEoJbTul2oB7yCSzT-QGLKEIu8Dk2vPNrbEk-yIE8ovRwsdS9VzC9ra7iSQjESxcr7NFWdethLSyyfMU_yZXXNfViq3DqMbO5ivNEXCdju7WWPTTNCYDMi3kPYhWb4XJsHW_QnPKI-8j-ld07TdYfkyz5ldItb6N6_fIh-96LGD9QfnuQHf9gM2tLk9fEjxHMZ3oCJ9ikWWoAzbRbG78iYwmasTDlC7ODuw9i85XQGFPVp6Z1WlDk-R0Lg14AIcA0Oncn9oGtwCqct1CX-iUniEuE5bIONSMmFIedePodV3RuCRZGSAfmC2Fy4sg7FurPk8e1vA506ZHTacOLdhOlPPZMef4fcFRMSQ_aYp5uCIfHR-FWyCPMUxUfkvpF42vprc5h_m5wtad4CRuPunhCZpqWuwBjIB3MRSSDKOfxGrTIhLvOtsQx-Q_B6CVuW3k2CnjG56iigBIoKGtyoZ0w4jSXFR5Zw6IakUy-Wf2r8_tS7MHka3cnK4Gbkfu03JMWKKXDYeQylCUpnlluNjhw-BBTo-SGv_RXtfdTiezgC_87gZDXCHq6IyngAjMpyY--rhsyqV4Mw0hbg17t6wYGgllFOqAVCWjWQamzuyk_QVhuMZ9LP4OcjDWrmkc1MgkQqxzZMCfVZn9LRvP9j2upoV-PDVu0r1MK4G30HprPfk8urnwHBTZ__CxQNlTHqOyjkUSp9DCvMQO0WvYzA73Rkr7ATDsHn_Dzm1eg#m__Evaluaci%C3%B3n-del-modelo:-Gini-(AUC)-y-curva-ROC" rel="noreferrer">¶</a></h3>
</div>
</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_c1"># Sacamos los Gini y la curva ROC</span>
<span class="m_nb">print</span><span class="m_p">(</span><span class="m_s2">"Gini Train: "</span><span class="m_p">,</span> <span class="m_mi">100</span><span class="m_o">*</span><span class="m_p">(</span><span class="m_mi">2</span><span class="m_o">*</span><span class="m_n">roc_auc_score</span><span class="m_p">(</span><span class="m_n">y_train</span><span class="m_p">,</span> <span class="m_n">prob_train_rf</span><span class="m_p">)</span><span class="m_o">-</span><span class="m_mi">1</span><span class="m_p">))</span>
<span class="m_nb">print</span><span class="m_p">(</span><span class="m_s2">"Gini Test: "</span><span class="m_p">,</span> <span class="m_mi">100</span><span class="m_o">*</span><span class="m_p">(</span><span class="m_mi">2</span><span class="m_o">*</span><span class="m_n">roc_auc_score</span><span class="m_p">(</span><span class="m_n">y_test</span><span class="m_p">,</span> <span class="m_n">prob_test_rf</span><span class="m_p">)</span><span class="m_o">-</span><span class="m_mi">1</span><span class="m_p">))</span>
<span class="m_n">plot_roc_curve</span><span class="m_p">(</span><span class="m_n">rf</span><span class="m_p">,</span> <span class="m_n">x_test</span><span class="m_p">,</span> <span class="m_n">y_test</span><span class="m_p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt"></div>


<div class="m_jp-RenderedText m_jp-OutputArea-output">
<pre>Gini Train:  64.4606897725339
Gini Test:  60.92174130508563
</pre>
</div>
</div>

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>




<div class="m_jp-RenderedText m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<pre>&lt;sklearn.metrics._plot.roc_<wbr>curve.RocCurveDisplay at 0x24ef3418220&gt;</pre>
</div>

</div>

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt"></div>




<div class="m_jp-RenderedImage m_jp-OutputArea-output">
<img>
</div>

</div>

</div>

</div>

</div>
<div class="m_jp-Cell-inputWrapper"><div class="m_jp-InputPrompt m_jp-InputArea-prompt">
</div><div class="m_jp-RenderedHTMLCommon m_jp-RenderedMarkdown m_jp-MarkdownOutput">
<h1 id="m_Modelo-de-XGBoost">Modelo de XGBoost<a class="m_anchor-link" href="https://mail-attachment.googleusercontent.com/attachment/u/2/?ui=2&amp;ik=5113226a7d&amp;attid=0.1&amp;permmsgid=msg-a:r489306242194221422&amp;th=17d741ad8789dc5f&amp;view=att&amp;disp=inline&amp;realattid=f_kwmzmtw65&amp;ser=1&amp;saddbat=ANGjdJ84PnBDA4LbNStn5wChHnm3K_vPuZhVllcGrlOQUI9JnKugcwg0-fy6BrktcTOolNRvffp3YhjKSWZUeUBN0XjzR8iu9Au9AZOiDd8hANRVARh4rEJ1874ffHrQ-ggOs9uc4PrvJAa_9Zun_DkI7KOEoJbTul2oB7yCSzT-QGLKEIu8Dk2vPNrbEk-yIE8ovRwsdS9VzC9ra7iSQjESxcr7NFWdethLSyyfMU_yZXXNfViq3DqMbO5ivNEXCdju7WWPTTNCYDMi3kPYhWb4XJsHW_QnPKI-8j-ld07TdYfkyz5ldItb6N6_fIh-96LGD9QfnuQHf9gM2tLk9fEjxHMZ3oCJ9ikWWoAzbRbG78iYwmasTDlC7ODuw9i85XQGFPVp6Z1WlDk-R0Lg14AIcA0Oncn9oGtwCqct1CX-iUniEuE5bIONSMmFIedePodV3RuCRZGSAfmC2Fy4sg7FurPk8e1vA506ZHTacOLdhOlPPZMef4fcFRMSQ_aYp5uCIfHR-FWyCPMUxUfkvpF42vprc5h_m5wtad4CRuPunhCZpqWuwBjIB3MRSSDKOfxGrTIhLvOtsQx-Q_B6CVuW3k2CnjG56iigBIoKGtyoZ0w4jSXFR5Zw6IakUy-Wf2r8_tS7MHka3cnK4Gbkfu03JMWKKXDYeQylCUpnlluNjhw-BBTo-SGv_RXtfdTiezgC_87gZDXCHq6IyngAjMpyY--rhsyqV4Mw0hbg17t6wYGgllFOqAVCWjWQamzuyk_QVhuMZ9LP4OcjDWrmkc1MgkQqxzZMCfVZn9LRvP9j2upoV-PDVu0r1MK4G30HprPfk8urnwHBTZ__CxQNlTHqOyjkUSp9DCvMQO0WvYzA73Rkr7ATDsHn_Dzm1eg#m__Modelo-de-XGBoost" rel="noreferrer">¶</a></h1><h2 id="m_Ejecución-de-modelo">Ejecución de modelo<a class="m_anchor-link" href="https://mail-attachment.googleusercontent.com/attachment/u/2/?ui=2&amp;ik=5113226a7d&amp;attid=0.1&amp;permmsgid=msg-a:r489306242194221422&amp;th=17d741ad8789dc5f&amp;view=att&amp;disp=inline&amp;realattid=f_kwmzmtw65&amp;ser=1&amp;saddbat=ANGjdJ84PnBDA4LbNStn5wChHnm3K_vPuZhVllcGrlOQUI9JnKugcwg0-fy6BrktcTOolNRvffp3YhjKSWZUeUBN0XjzR8iu9Au9AZOiDd8hANRVARh4rEJ1874ffHrQ-ggOs9uc4PrvJAa_9Zun_DkI7KOEoJbTul2oB7yCSzT-QGLKEIu8Dk2vPNrbEk-yIE8ovRwsdS9VzC9ra7iSQjESxcr7NFWdethLSyyfMU_yZXXNfViq3DqMbO5ivNEXCdju7WWPTTNCYDMi3kPYhWb4XJsHW_QnPKI-8j-ld07TdYfkyz5ldItb6N6_fIh-96LGD9QfnuQHf9gM2tLk9fEjxHMZ3oCJ9ikWWoAzbRbG78iYwmasTDlC7ODuw9i85XQGFPVp6Z1WlDk-R0Lg14AIcA0Oncn9oGtwCqct1CX-iUniEuE5bIONSMmFIedePodV3RuCRZGSAfmC2Fy4sg7FurPk8e1vA506ZHTacOLdhOlPPZMef4fcFRMSQ_aYp5uCIfHR-FWyCPMUxUfkvpF42vprc5h_m5wtad4CRuPunhCZpqWuwBjIB3MRSSDKOfxGrTIhLvOtsQx-Q_B6CVuW3k2CnjG56iigBIoKGtyoZ0w4jSXFR5Zw6IakUy-Wf2r8_tS7MHka3cnK4Gbkfu03JMWKKXDYeQylCUpnlluNjhw-BBTo-SGv_RXtfdTiezgC_87gZDXCHq6IyngAjMpyY--rhsyqV4Mw0hbg17t6wYGgllFOqAVCWjWQamzuyk_QVhuMZ9LP4OcjDWrmkc1MgkQqxzZMCfVZn9LRvP9j2upoV-PDVu0r1MK4G30HprPfk8urnwHBTZ__CxQNlTHqOyjkUSp9DCvMQO0WvYzA73Rkr7ATDsHn_Dzm1eg#m__Ejecuci%C3%B3n-de-modelo" rel="noreferrer">¶</a></h2>
</div>
</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell m_jp-mod-noOutputs">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_kn">import</span> <span class="m_nn">xgboost</span> <span class="m_k">as</span> <span class="m_nn">xgb</span>

<span class="m_c1"># XGBoost</span>
<span class="m_n">parametros</span> <span class="m_o">=</span> <span class="m_p">{</span>
    <span class="m_s1">'use_label_encoder'</span><span class="m_p">:</span><span class="m_kc">False</span><span class="m_p">,</span>
    <span class="m_s1">'objective'</span><span class="m_p">:</span> <span class="m_s1">'binary:logistic'</span><span class="m_p">,</span>
    <span class="m_s1">'eval_metric'</span><span class="m_p">:</span> <span class="m_s1">'auc'</span><span class="m_p">,</span>
    <span class="m_s1">'learning_rate'</span><span class="m_p">:</span> <span class="m_mf">0.3</span><span class="m_p">,</span>
    <span class="m_s1">'max_depth'</span><span class="m_p">:</span> <span class="m_mi">4</span><span class="m_p">,</span>
    <span class="m_s1">'min_child_weight'</span><span class="m_p">:</span> <span class="m_mi">11</span><span class="m_p">,</span>
    <span class="m_s1">'subsample'</span><span class="m_p">:</span> <span class="m_mf">0.6</span><span class="m_p">,</span>
    <span class="m_s1">'colsample_bytree'</span><span class="m_p">:</span> <span class="m_mf">0.6</span><span class="m_p">,</span>
    <span class="m_s1">'scale_pos_weight'</span><span class="m_p">:</span> <span class="m_mi">3</span>
<span class="m_p">}</span>

<span class="m_n">xgbm</span> <span class="m_o">=</span> <span class="m_n">xgb</span><span class="m_o">.</span><span class="m_n">XGBClassifier</span><span class="m_p">(</span><span class="m_o">**</span><span class="m_n">parametros</span><span class="m_p"><wbr>)</span>
<span class="m_n">xgbm</span><span class="m_o">.</span><span class="m_n">fit</span><span class="m_p">(</span><span class="m_n">x_train</span><span class="m_p">,</span> <span class="m_n">y_train</span><span class="m_p">)</span>

<span class="m_c1"># Predecimos las probabilidades</span>
<span class="m_n">prob_train_xgbm</span> <span class="m_o">=</span> <span class="m_n">xgbm</span><span class="m_o">.</span><span class="m_n">predict_proba</span><span class="m_p">(</span><span class="m_n">x_train</span><span class="m_p">)[:,</span><span class="m_mi"><wbr>1</span><span class="m_p">]</span>
<span class="m_n">prob_test_xgbm</span> <span class="m_o">=</span> <span class="m_n">xgbm</span><span class="m_o">.</span><span class="m_n">predict_proba</span><span class="m_p">(</span><span class="m_n">x_test</span><span class="m_p">)[:,</span><span class="m_mi">1</span><span class="m_p"><wbr>]</span>

<span class="m_c1"># Predecimos el resultado</span>
<span class="m_n">pred_test_xgbm</span> <span class="m_o">=</span> <span class="m_n">xgbm</span><span class="m_o">.</span><span class="m_n">predict</span><span class="m_p">(</span><span class="m_n">x_test</span><span class="m_p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="m_jp-Cell-inputWrapper"><div class="m_jp-InputPrompt m_jp-InputArea-prompt">
</div><div class="m_jp-RenderedHTMLCommon m_jp-RenderedMarkdown m_jp-MarkdownOutput">
<h3 id="m_Evaluación-del-modelo:-Matriz-de-confusión">Evaluación del modelo: Matriz de confusión<a class="m_anchor-link" href="https://mail-attachment.googleusercontent.com/attachment/u/2/?ui=2&amp;ik=5113226a7d&amp;attid=0.1&amp;permmsgid=msg-a:r489306242194221422&amp;th=17d741ad8789dc5f&amp;view=att&amp;disp=inline&amp;realattid=f_kwmzmtw65&amp;ser=1&amp;saddbat=ANGjdJ84PnBDA4LbNStn5wChHnm3K_vPuZhVllcGrlOQUI9JnKugcwg0-fy6BrktcTOolNRvffp3YhjKSWZUeUBN0XjzR8iu9Au9AZOiDd8hANRVARh4rEJ1874ffHrQ-ggOs9uc4PrvJAa_9Zun_DkI7KOEoJbTul2oB7yCSzT-QGLKEIu8Dk2vPNrbEk-yIE8ovRwsdS9VzC9ra7iSQjESxcr7NFWdethLSyyfMU_yZXXNfViq3DqMbO5ivNEXCdju7WWPTTNCYDMi3kPYhWb4XJsHW_QnPKI-8j-ld07TdYfkyz5ldItb6N6_fIh-96LGD9QfnuQHf9gM2tLk9fEjxHMZ3oCJ9ikWWoAzbRbG78iYwmasTDlC7ODuw9i85XQGFPVp6Z1WlDk-R0Lg14AIcA0Oncn9oGtwCqct1CX-iUniEuE5bIONSMmFIedePodV3RuCRZGSAfmC2Fy4sg7FurPk8e1vA506ZHTacOLdhOlPPZMef4fcFRMSQ_aYp5uCIfHR-FWyCPMUxUfkvpF42vprc5h_m5wtad4CRuPunhCZpqWuwBjIB3MRSSDKOfxGrTIhLvOtsQx-Q_B6CVuW3k2CnjG56iigBIoKGtyoZ0w4jSXFR5Zw6IakUy-Wf2r8_tS7MHka3cnK4Gbkfu03JMWKKXDYeQylCUpnlluNjhw-BBTo-SGv_RXtfdTiezgC_87gZDXCHq6IyngAjMpyY--rhsyqV4Mw0hbg17t6wYGgllFOqAVCWjWQamzuyk_QVhuMZ9LP4OcjDWrmkc1MgkQqxzZMCfVZn9LRvP9j2upoV-PDVu0r1MK4G30HprPfk8urnwHBTZ__CxQNlTHqOyjkUSp9DCvMQO0WvYzA73Rkr7ATDsHn_Dzm1eg#m__Evaluaci%C3%B3n-del-modelo:-Matriz-de-confusi%C3%B3n" rel="noreferrer">¶</a></h3>
</div>
</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_c1"># Pintamos la matriz de confusiÃ³n</span>
<span class="m_nb">print</span><span class="m_p">(</span><span class="m_n">confusion_matrix</span><span class="m_p">(</span><span class="m_n">y_test</span><span class="m_p">,</span> <span class="m_n">pred_test_xgbm</span><span class="m_p">))</span>
<span class="m_nb">print</span><span class="m_p">(</span><span class="m_n">classification_report</span><span class="m_p">(</span><span class="m_n">y_<wbr>test</span><span class="m_p">,</span> <span class="m_n">pred_test_xgbm</span><span class="m_p">))</span>
<span class="m_n">plot_confusion_matrix</span><span class="m_p">(</span><span class="m_n">xgbm</span><span class="m_p">,</span> <span class="m_n">x_test</span><span class="m_p">,</span> <span class="m_n">y_test</span><span class="m_p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt"></div>


<div class="m_jp-RenderedText m_jp-OutputArea-output">
<pre>[[7562    3]
 [ 111    0]]
              precision    recall  f1-score   support

           0       0.99      1.00      0.99      7565
           1       0.00      0.00      0.00       111

    accuracy                           0.99      7676
   macro avg       0.49      0.50      0.50      7676
weighted avg       0.97      0.99      0.98      7676

</pre>
</div>
</div>

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>




<div class="m_jp-RenderedText m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<pre>&lt;sklearn.metrics._plot.<wbr>confusion_matrix.<wbr>ConfusionMatrixDisplay at 0x24ef6ae33d0&gt;</pre>
</div>

</div>

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt"></div>




<div class="m_jp-RenderedImage m_jp-OutputArea-output">
<img>
</div>

</div>

</div>

</div>

</div>
<div class="m_jp-Cell-inputWrapper"><div class="m_jp-InputPrompt m_jp-InputArea-prompt">
</div><div class="m_jp-RenderedHTMLCommon m_jp-RenderedMarkdown m_jp-MarkdownOutput">
<h3 id="m_Evaluación-del-modelo:-Gini-(AUC)-y-curva-ROC">Evaluación del modelo: Gini (AUC) y curva ROC<a class="m_anchor-link" href="https://mail-attachment.googleusercontent.com/attachment/u/2/?ui=2&amp;ik=5113226a7d&amp;attid=0.1&amp;permmsgid=msg-a:r489306242194221422&amp;th=17d741ad8789dc5f&amp;view=att&amp;disp=inline&amp;realattid=f_kwmzmtw65&amp;ser=1&amp;saddbat=ANGjdJ84PnBDA4LbNStn5wChHnm3K_vPuZhVllcGrlOQUI9JnKugcwg0-fy6BrktcTOolNRvffp3YhjKSWZUeUBN0XjzR8iu9Au9AZOiDd8hANRVARh4rEJ1874ffHrQ-ggOs9uc4PrvJAa_9Zun_DkI7KOEoJbTul2oB7yCSzT-QGLKEIu8Dk2vPNrbEk-yIE8ovRwsdS9VzC9ra7iSQjESxcr7NFWdethLSyyfMU_yZXXNfViq3DqMbO5ivNEXCdju7WWPTTNCYDMi3kPYhWb4XJsHW_QnPKI-8j-ld07TdYfkyz5ldItb6N6_fIh-96LGD9QfnuQHf9gM2tLk9fEjxHMZ3oCJ9ikWWoAzbRbG78iYwmasTDlC7ODuw9i85XQGFPVp6Z1WlDk-R0Lg14AIcA0Oncn9oGtwCqct1CX-iUniEuE5bIONSMmFIedePodV3RuCRZGSAfmC2Fy4sg7FurPk8e1vA506ZHTacOLdhOlPPZMef4fcFRMSQ_aYp5uCIfHR-FWyCPMUxUfkvpF42vprc5h_m5wtad4CRuPunhCZpqWuwBjIB3MRSSDKOfxGrTIhLvOtsQx-Q_B6CVuW3k2CnjG56iigBIoKGtyoZ0w4jSXFR5Zw6IakUy-Wf2r8_tS7MHka3cnK4Gbkfu03JMWKKXDYeQylCUpnlluNjhw-BBTo-SGv_RXtfdTiezgC_87gZDXCHq6IyngAjMpyY--rhsyqV4Mw0hbg17t6wYGgllFOqAVCWjWQamzuyk_QVhuMZ9LP4OcjDWrmkc1MgkQqxzZMCfVZn9LRvP9j2upoV-PDVu0r1MK4G30HprPfk8urnwHBTZ__CxQNlTHqOyjkUSp9DCvMQO0WvYzA73Rkr7ATDsHn_Dzm1eg#m__Evaluaci%C3%B3n-del-modelo:-Gini-(AUC)-y-curva-ROC" rel="noreferrer">¶</a></h3>
</div>
</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_c1"># Sacamos los Gini y la curva ROC</span>
<span class="m_nb">print</span><span class="m_p">(</span><span class="m_s2">"Gini Train: "</span><span class="m_p">,</span> <span class="m_mi">100</span><span class="m_o">*</span><span class="m_p">(</span><span class="m_mi">2</span><span class="m_o">*</span><span class="m_n">roc_auc_score</span><span class="m_p">(</span><span class="m_n">y_train</span><span class="m_p">,</span> <span class="m_n">prob_train_xgbm</span><span class="m_p">)</span><span class="m_o">-</span><span class="m_mi">1</span><span class="m_p">))</span>
<span class="m_nb">print</span><span class="m_p">(</span><span class="m_s2">"Gini Test: "</span><span class="m_p">,</span> <span class="m_mi">100</span><span class="m_o">*</span><span class="m_p">(</span><span class="m_mi">2</span><span class="m_o">*</span><span class="m_n">roc_auc_score</span><span class="m_p">(</span><span class="m_n">y_test</span><span class="m_p">,</span> <span class="m_n">prob_test_xgbm</span><span class="m_p">)</span><span class="m_o">-</span><span class="m_mi">1</span><span class="m_p">))</span>
<span class="m_n">plot_roc_curve</span><span class="m_p">(</span><span class="m_n">xgbm</span><span class="m_p">,</span> <span class="m_n">x_test</span><span class="m_p">,</span> <span class="m_n">y_test</span><span class="m_p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt"></div>


<div class="m_jp-RenderedText m_jp-OutputArea-output">
<pre>Gini Train:  66.2052178634231
Gini Test:  59.06539718833177
</pre>
</div>
</div>

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>




<div class="m_jp-RenderedText m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<pre>&lt;sklearn.metrics._plot.roc_<wbr>curve.RocCurveDisplay at 0x24ef3469580&gt;</pre>
</div>

</div>

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt"></div>




<div class="m_jp-RenderedImage m_jp-OutputArea-output">
<img>
</div>

</div>

</div>

</div>

</div>
<div class="m_jp-Cell-inputWrapper"><div class="m_jp-InputPrompt m_jp-InputArea-prompt">
</div><div class="m_jp-RenderedHTMLCommon m_jp-RenderedMarkdown m_jp-MarkdownOutput">
<p>MODELO RANDOM SEARCH</p>

</div>
</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell m_jp-mod-noOutputs">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_c1"># summarize the sonar dataset</span>
<span class="m_kn">from</span> <span class="m_nn">pandas</span> <span class="m_kn">import</span> <span class="m_n">read_csv</span>
<span class="m_kn">import</span> <span class="m_nn">pandas</span> <span class="m_k">as</span> <span class="m_nn">pd</span>

<span class="m_c1"># example of random search for function optimization</span>
<span class="m_kn">from</span> <span class="m_nn">numpy.random</span> <span class="m_kn">import</span> <span class="m_n">rand</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_kn">import</span> <span class="m_nn">numpy</span> <span class="m_k">as</span> <span class="m_nn">np</span>
<span class="m_kn">from</span> <span class="m_nn">scipy.stats</span> <span class="m_kn">import</span> <span class="m_n">randint</span>
<span class="m_kn">from</span> <span class="m_nn">sklearn.experimental</span> <span class="m_kn">import</span> <span class="m_n">enable_halving_search_cv</span>  <span class="m_c1"># noqa</span>
<span class="m_kn">from</span> <span class="m_nn">sklearn.model_selection</span> <span class="m_kn">import</span> <span class="m_n">HalvingRandomSearchCV</span>
<span class="m_kn">from</span> <span class="m_nn">sklearn.ensemble</span> <span class="m_kn">import</span> <span class="m_n">RandomForestClassifier</span>
<span class="m_kn">from</span> <span class="m_nn">sklearn.datasets</span> <span class="m_kn">import</span> <span class="m_n">make_classification</span>

<span class="m_n">rng</span> <span class="m_o">=</span> <span class="m_n">np</span><span class="m_o">.</span><span class="m_n">random</span><span class="m_o">.</span><span class="m_n">RandomState</span><span class="m_p">(</span><span class="m_mi">0</span><span class="m_p">)</span>

<span class="m_n">X</span><span class="m_p">,</span> <span class="m_n">y</span> <span class="m_o">=</span> <span class="m_n">make_classification</span><span class="m_p">(</span><span class="m_n">n_samples</span><span class="m_o">=</span><span class="m_mi"><wbr>700</span><span class="m_p">,</span> <span class="m_n">random_state</span><span class="m_o">=</span><span class="m_n">rng</span><span class="m_p">)</span>

<span class="m_n">clf</span> <span class="m_o">=</span> <span class="m_n">RandomForestClassifier</span><span class="m_p">(</span><span class="m_n">n_<wbr>estimators</span><span class="m_o">=</span><span class="m_mi">10</span><span class="m_p">,</span> <span class="m_n">random_state</span><span class="m_o">=</span><span class="m_n">rng</span><span class="m_p">)</span>

<span class="m_n">param_dist</span> <span class="m_o">=</span> <span class="m_p">{</span>
    <span class="m_s2">"max_depth"</span><span class="m_p">:</span> <span class="m_p">[</span><span class="m_mi">3</span><span class="m_p">,</span> <span class="m_kc">None</span><span class="m_p">],</span>
    <span class="m_s2">"max_features"</span><span class="m_p">:</span> <span class="m_n">randint</span><span class="m_p">(</span><span class="m_mi">1</span><span class="m_p">,</span> <span class="m_mi">11</span><span class="m_p">),</span>
    <span class="m_s2">"min_samples_split"</span><span class="m_p">:</span> <span class="m_n">randint</span><span class="m_p">(</span><span class="m_mi">2</span><span class="m_p">,</span> <span class="m_mi">11</span><span class="m_p">),</span>
    <span class="m_s2">"bootstrap"</span><span class="m_p">:</span> <span class="m_p">[</span><span class="m_kc">True</span><span class="m_p">,</span> <span class="m_kc">False</span><span class="m_p">],</span>
    <span class="m_s2">"criterion"</span><span class="m_p">:</span> <span class="m_p">[</span><span class="m_s2">"gini"</span><span class="m_p">,</span> <span class="m_s2">"entropy"</span><span class="m_p">],</span>
<span class="m_p">}</span>

<span class="m_n">rsh</span> <span class="m_o">=</span> <span class="m_n">HalvingRandomSearchCV</span><span class="m_p">(</span>
    <span class="m_n">estimator</span><span class="m_o">=</span><span class="m_n">clf</span><span class="m_p">,</span> <span class="m_n">param_distributions</span><span class="m_o">=</span><span class="m_n">param_dist</span><span class="m_p"><wbr>,</span> <span class="m_n">factor</span><span class="m_o">=</span><span class="m_mi">2</span><span class="m_p">,</span> <span class="m_n">random_state</span><span class="m_o">=</span><span class="m_n">rng</span>
<span class="m_p">)</span>
<span class="m_n">rsh</span><span class="m_o">.</span><span class="m_n">fit</span><span class="m_p">(</span><span class="m_n">X</span><span class="m_p">,</span> <span class="m_n">y</span><span class="m_p">)</span>
<span class="m_n">rsh</span><span class="m_o">.</span><span class="m_n">best_params_</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>




<div class="m_jp-RenderedText m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<pre>{'bootstrap': True,
 'criterion': 'gini',
 'max_depth': None,
 'max_features': 10,
 'min_samples_split': 10}</pre>
</div>

</div>

</div>

</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell m_jp-mod-noOutputs">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_kn">from</span> <span class="m_nn">sklearn.model_selection</span> <span class="m_kn">import</span> <span class="m_n">train_test_split</span>
<span class="m_o">&gt;&gt;&gt;</span> <span class="m_kn">from</span> <span class="m_nn">sklearn.linear_model</span> <span class="m_kn">import</span> <span class="m_n">LogisticRegression</span>
<span class="m_o">&gt;&gt;&gt;</span> <span class="m_kn">from</span> <span class="m_nn">sklearn.model_selection</span> <span class="m_kn">import</span> <span class="m_n">RandomizedSearchCV</span>
<span class="m_o">&gt;&gt;&gt;</span> <span class="m_kn">from</span> <span class="m_nn">scipy.stats</span> <span class="m_kn">import</span> <span class="m_n">uniform</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_n">pd</span><span class="m_o">.</span><span class="m_n">read_csv</span><span class="m_p">(</span><span class="m_s2">"car_loans_clean.<wbr>csv"</span><span class="m_p">,</span> <span class="m_n">encoding</span><span class="m_o">=</span><span class="m_s1">'ISO-8859â1'</span><span class="m_p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>



<div class="m_jp-RenderedHTMLCommon m_jp-RenderedHTML m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<div>

<table border="1" class="m_dataframe">
  <thead>
    <tr style="text-align:right">
      <th></th>
      <th>working_status</th>
      <th>working_industry</th>
      <th>term</th>
      <th>product</th>
      <th>car_status</th>
      <th>num_interveners</th>
      <th>type_car</th>
      <th>Downpayment_ratio</th>
      <th>bad</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>F</td>
      <td>1.0</td>
      <td>6</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>73</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>F</td>
      <td>13.0</td>
      <td>36</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>F</td>
      <td>17.0</td>
      <td>25</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>F</td>
      <td>11.0</td>
      <td>71</td>
      <td>4</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>10</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>N</td>
      <td>10.0</td>
      <td>84</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>47</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>25580</th>
      <td>F</td>
      <td>16.0</td>
      <td>49</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>39</td>
      <td>0</td>
    </tr>
    <tr>
      <th>25581</th>
      <td>F</td>
      <td>1.0</td>
      <td>49</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>23</td>
      <td>0</td>
    </tr>
    <tr>
      <th>25582</th>
      <td>F</td>
      <td>8.0</td>
      <td>49</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>19</td>
      <td>0</td>
    </tr>
    <tr>
      <th>25583</th>
      <td>N</td>
      <td>10.0</td>
      <td>27</td>
      <td>4</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>31</td>
      <td>0</td>
    </tr>
    <tr>
      <th>25584</th>
      <td>A</td>
      <td>16.0</td>
      <td>20</td>
      <td>4</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>35</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>25585 rows Ã 9 columns</p>
</div>
</div>

</div>

</div>

</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_kn">import</span> <span class="m_nn">gzip</span>
<span class="m_kn">import</span> <span class="m_nn">os</span>

<span class="m_k">with</span> <span class="m_nb">open</span><span class="m_p">(</span><span class="m_s2">"car_loans_clean.csv"</span><span class="m_p">,</span> <span class="m_s1">'rb'</span><span class="m_p">)</span> <span class="m_k">as</span> <span class="m_n">f</span><span class="m_p">:</span>
    <span class="m_n">content</span> <span class="m_o">=</span> <span class="m_n">f</span><span class="m_o">.</span><span class="m_n">read</span><span class="m_p">()</span>

<span class="m_k">for</span> <span class="m_n">level</span> <span class="m_ow">in</span> <span class="m_nb">range</span><span class="m_p">(</span><span class="m_mi">10</span><span class="m_p">):</span>
    <span class="m_k">with</span> <span class="m_n">gzip</span><span class="m_o">.</span><span class="m_n">GzipFile</span><span class="m_p">(</span><span class="m_n">filename</span><span class="m_o">=</span><span class="m_s1">'temp'</span><span class="m_p">,</span> <span class="m_n">mode</span><span class="m_o">=</span><span class="m_s1">'w'</span><span class="m_p">,</span> <span class="m_n">compresslevel</span><span class="m_o">=</span><span class="m_n">level</span><span class="m_p">)</span> <span class="m_k">as</span> <span class="m_n">f</span><span class="m_p">:</span>
        <span class="m_n">f</span><span class="m_o">.</span><span class="m_n">write</span><span class="m_p">(</span><span class="m_n">content</span><span class="m_p">)</span>
    <span class="m_nb">print</span><span class="m_p">(</span><span class="m_s1">'level=</span><span class="m_si">{}</span><span class="m_s1">, size=</span><span class="m_si">{}</span><span class="m_s1">'</span><span class="m_o">.</span><span class="m_n">format</span><span class="m_p">(</span><span class="m_n">level</span><span class="m_p">,</span> <span class="m_n">os</span><span class="m_o">.</span><span class="m_n">path</span><span class="m_o">.</span><span class="m_n">getsize</span><span class="m_p">(</span><span class="m_s1">'temp'</span><span class="m_p">)))</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt"></div>


<div class="m_jp-RenderedText m_jp-OutputArea-output">
<pre>level=0, size=598578
level=1, size=139177
level=2, size=126019
level=3, size=112573
level=4, size=109060
level=5, size=101292
level=6, size=92564
level=7, size=89821
</pre>
</div>
</div>

</div>

</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_kn">import</span> <span class="m_nn">numpy</span> <span class="m_k">as</span> <span class="m_nn">np</span>
<span class="m_kn">from</span> <span class="m_nn">scipy.stats</span> <span class="m_kn">import</span> <span class="m_n">randint</span>
<span class="m_kn">from</span> <span class="m_nn">sklearn.experimental</span> <span class="m_kn">import</span> <span class="m_n">enable_halving_search_cv</span>  <span class="m_c1"># noqa</span>
<span class="m_kn">from</span> <span class="m_nn">sklearn.model_selection</span> <span class="m_kn">import</span> <span class="m_n">HalvingRandomSearchCV</span>
<span class="m_kn">from</span> <span class="m_nn">sklearn.ensemble</span> <span class="m_kn">import</span> <span class="m_n">RandomForestClassifier</span>
<span class="m_kn">from</span> <span class="m_nn">sklearn.datasets</span> <span class="m_kn">import</span> <span class="m_n">make_classification</span>

<span class="m_n">rng</span> <span class="m_o">=</span> <span class="m_n">np</span><span class="m_o">.</span><span class="m_n">random</span><span class="m_o">.</span><span class="m_n">RandomState</span><span class="m_p">(</span><span class="m_mi">0</span><span class="m_p">)</span>

<span class="m_n">X</span><span class="m_p">,</span> <span class="m_n">y</span> <span class="m_o">=</span> <span class="m_n">make_classification</span><span class="m_p">(</span><span class="m_n">n_samples</span><span class="m_o">=</span><span class="m_mi"><wbr>700</span><span class="m_p">,</span> <span class="m_n">random_state</span><span class="m_o">=</span><span class="m_n">rng</span><span class="m_p">)</span>

<span class="m_n">clf</span> <span class="m_o">=</span> <span class="m_n">RandomForestClassifier</span><span class="m_p">(</span><span class="m_n">n_<wbr>estimators</span><span class="m_o">=</span><span class="m_mi">10</span><span class="m_p">,</span> <span class="m_n">random_state</span><span class="m_o">=</span><span class="m_n">rng</span><span class="m_p">)</span>

<span class="m_n">param_dist</span> <span class="m_o">=</span> <span class="m_p">{</span>
    <span class="m_s2">"max_depth"</span><span class="m_p">:</span> <span class="m_p">[</span><span class="m_mi">3</span><span class="m_p">,</span> <span class="m_kc">None</span><span class="m_p">],</span>
    <span class="m_s2">"max_features"</span><span class="m_p">:</span> <span class="m_n">randint</span><span class="m_p">(</span><span class="m_mi">1</span><span class="m_p">,</span> <span class="m_mi">11</span><span class="m_p">),</span>
    <span class="m_s2">"min_samples_split"</span><span class="m_p">:</span> <span class="m_n">randint</span><span class="m_p">(</span><span class="m_mi">2</span><span class="m_p">,</span> <span class="m_mi">11</span><span class="m_p">),</span>
    <span class="m_s2">"bootstrap"</span><span class="m_p">:</span> <span class="m_p">[</span><span class="m_kc">True</span><span class="m_p">,</span> <span class="m_kc">False</span><span class="m_p">],</span>
    <span class="m_s2">"criterion"</span><span class="m_p">:</span> <span class="m_p">[</span><span class="m_s2">"gini"</span><span class="m_p">,</span> <span class="m_s2">"entropy"</span><span class="m_p">],</span>
<span class="m_p">}</span>

<span class="m_n">rsh</span> <span class="m_o">=</span> <span class="m_n">HalvingRandomSearchCV</span><span class="m_p">(</span>
    <span class="m_n">estimator</span><span class="m_o">=</span><span class="m_n">clf</span><span class="m_p">,</span> <span class="m_n">param_distributions</span><span class="m_o">=</span><span class="m_n">param_dist</span><span class="m_p"><wbr>,</span> <span class="m_n">factor</span><span class="m_o">=</span><span class="m_mi">2</span><span class="m_p">,</span> <span class="m_n">random_state</span><span class="m_o">=</span><span class="m_n">rng</span>
<span class="m_p">)</span>
<span class="m_n">rsh</span><span class="m_o">.</span><span class="m_n">fit</span><span class="m_p">(</span><span class="m_n">X</span><span class="m_p">,</span> <span class="m_n">y</span><span class="m_p">)</span>
<span class="m_n">rsh</span><span class="m_o">.</span><span class="m_n">best_params_</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>




<div class="m_jp-RenderedText m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<pre>{'bootstrap': True,
 'criterion': 'gini',
 'max_depth': None,
 'max_features': 10,
 'min_samples_split': 10}</pre>
</div>

</div>

</div>

</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell m_jp-mod-noOutputs">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_c1"># Calculate the mean of a list of numbers</span>
<span class="m_k">def</span> <span class="m_nf">mean</span><span class="m_p">(</span><span class="m_n">numbers</span><span class="m_p">):</span>
	<span class="m_k">return</span> <span class="m_nb">sum</span><span class="m_p">(</span><span class="m_n">numbers</span><span class="m_p">)</span><span class="m_o">/</span><span class="m_nb">float</span><span class="m_p">(</span><span class="m_nb">len</span><span class="m_p">(</span><span class="m_n">numbers</span><span class="m_p"><wbr>))</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_kn">import</span> <span class="m_nn">pandas</span> <span class="m_k">as</span> <span class="m_nn">pd</span>

<span class="m_n">data</span> <span class="m_o">=</span> <span class="m_n">pd</span><span class="m_o">.</span><span class="m_n">read_csv</span><span class="m_p">(</span><span class="m_s2">"car_loans_clean.<wbr>csv"</span><span class="m_p">)</span>
<span class="m_n">df</span> <span class="m_o">=</span> <span class="m_n">pd</span><span class="m_o">.</span><span class="m_n">DataFrame</span><span class="m_p">(</span><span class="m_n">data</span><span class="m_p">)</span>

<span class="m_nb">print</span> <span class="m_p">(</span><span class="m_n">df</span><span class="m_p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt"></div>


<div class="m_jp-RenderedText m_jp-OutputArea-output">
<pre>      working_status  working_industry  term  product  car_status  \
0                  F               1.0     6        4           2   
1                  F              13.0    36        4           2   
2                  F              17.0    25        2           2   
3                  F              11.0    71        4           2   
4                  N              10.0    84        4           1   
...              ...               ...   ...      ...         ...   
25580              F              16.0    49        4           1   
25581              F               1.0    49        4           1   
25582              F               8.0    49        4           1   
25583              N              10.0    27        4           2   
25584              A              16.0    20        4           2   

       num_interveners  type_car  Downpayment_ratio  bad  
0                    1         2                 73    0  
1                    1         1                  0    0  
2                    1         1                  0    0  
3                    2         1                 10    0  
4                    1         1                 47    0  
...                ...       ...                ...  ...  
25580                1         1                 39    0  
25581                1         2                 23    0  
25582                1         2                 19    0  
25583                2         1                 31    0  
25584                2         1                 35    0  

[25585 rows x 9 columns]
</pre>
</div>
</div>

</div>

</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell m_jp-mod-noOutputs">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_kn">import</span> <span class="m_nn">numpy</span> <span class="m_k">as</span> <span class="m_nn">np</span>

<span class="m_n">data</span> <span class="m_o">=</span> <span class="m_n">pd</span><span class="m_o">.</span><span class="m_n">read_csv</span><span class="m_p">(</span><span class="m_s2">"car_loans_clean.<wbr>csv"</span><span class="m_p">)</span>
<span class="m_n">df</span> <span class="m_o">=</span> <span class="m_n">pd</span><span class="m_o">.</span><span class="m_n">DataFrame</span><span class="m_p">(</span><span class="m_n">data</span><span class="m_p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell m_jp-mod-noOutputs">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_kn">import</span> <span class="m_nn">scipy.stats</span> <span class="m_k">as</span> <span class="m_nn">stats</span>
<span class="m_kn">from</span> <span class="m_nn">sklearn.utils.fixes</span> <span class="m_kn">import</span> <span class="m_n">loguniform</span>
<span class="m_c1"># Specify parameters and distributions to sample from</span>
<span class="m_n">param_dist</span> <span class="m_o">=</span> <span class="m_p">{</span>
  <span class="m_s1">'C'</span><span class="m_p">:</span> <span class="m_n">stats</span><span class="m_o">.</span><span class="m_n">uniform</span><span class="m_p">(</span><span class="m_mf">0.1</span><span class="m_p">,</span> <span class="m_mf">1e4</span><span class="m_p">),</span>
  <span class="m_s1">'gamma'</span><span class="m_p">:</span> <span class="m_n">loguniform</span><span class="m_p">(</span><span class="m_mf">1e-6</span><span class="m_p">,</span> <span class="m_mf">1e+1</span><span class="m_p">),</span>
<span class="m_p">}</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell m_jp-mod-noOutputs">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_kn">from</span> <span class="m_nn">math</span> <span class="m_kn">import</span> <span class="m_n">sqrt</span>
 
<span class="m_c1"># Calculate the standard deviation of a list of numbers</span>
<span class="m_k">def</span> <span class="m_nf">stdev</span><span class="m_p">(</span><span class="m_n">numbers</span><span class="m_p">):</span>
	<span class="m_n">avg</span> <span class="m_o">=</span> <span class="m_n">mean</span><span class="m_p">(</span><span class="m_n">numbers</span><span class="m_p">)</span>
	<span class="m_n">variance</span> <span class="m_o">=</span> <span class="m_nb">sum</span><span class="m_p">([(</span><span class="m_n">x</span><span class="m_o">-</span><span class="m_n">avg</span><span class="m_p">)</span><span class="m_o">**</span><span class="m_mi">2</span> <span class="m_k">for</span> <span class="m_n">x</span> <span class="m_ow">in</span> <span class="m_n">numbers</span><span class="m_p">])</span> <span class="m_o">/</span> <span class="m_nb">float</span><span class="m_p">(</span><span class="m_nb">len</span><span class="m_p">(</span><span class="m_n">numbers</span><span class="m_p">)</span><span class="m_o">-</span><span class="m_mi">1</span><span class="m_p">)</span>
	<span class="m_k">return</span> <span class="m_n">sqrt</span><span class="m_p">(</span><span class="m_n">variance</span><span class="m_p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell m_jp-mod-noOutputs">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_c1"># Split dataset by class then calculate statistics for each row</span>
<span class="m_k">def</span> <span class="m_nf">summarize_by_class</span><span class="m_p">(</span><span class="m_n">df</span><span class="m_p">):</span>
	<span class="m_n">separated</span> <span class="m_o">=</span> <span class="m_n">separate_by_class</span><span class="m_p">(</span><span class="m_n">df</span><span class="m_p">)</span>
	<span class="m_n">summaries</span> <span class="m_o">=</span> <span class="m_nb">dict</span><span class="m_p">()</span>
	<span class="m_k">for</span> <span class="m_n">class_value</span><span class="m_p">,</span> <span class="m_n">rows</span> <span class="m_ow">in</span> <span class="m_n">separated</span><span class="m_o">.</span><span class="m_n">items</span><span class="m_p">():</span>
		<span class="m_n">summaries</span><span class="m_p">[</span><span class="m_n">class_value</span><span class="m_p">]</span> <span class="m_o">=</span> <span class="m_n">summarize_dataset</span><span class="m_p">(</span><span class="m_n">rows</span><span class="m_p">)</span>
	<span class="m_k">return</span> <span class="m_n">summaries</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_n">conda</span> <span class="m_n">install</span> <span class="m_o">-</span><span class="m_n">c</span> <span class="m_n">intel</span> <span class="m_n">scikit</span><span class="m_o">-</span><span class="m_n">learn</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt"></div>


<div class="m_jp-RenderedText m_jp-OutputArea-output">
<pre>Collecting package metadata (current_repodata.json): ...working... failed

Note: you may need to restart the kernel to use updated packages.
</pre>
</div>
</div>

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt"></div>


<div class="m_jp-RenderedText m_jp-OutputArea-output">
<pre>CondaHTTPError: HTTP 000 CONNECTION FAILED for url &lt;<a href="https://www.google.com/url?q=https://conda.anaconda.org/intel/win-64/current_repodata.json&amp;source=gmail-html&amp;ust=1660823776006000&amp;usg=AOvVaw0An3c0IouMs9zg9jd4JzYl" target="_blank" rel="noreferrer">https://conda.anaconda.org/<wbr>intel/win-64/current_repodata.<wbr>json</a>&gt;
Elapsed: -

An HTTP error occurred when trying to retrieve this URL.
HTTP errors are often intermittent, and a simple retry will get you on your way.
'<a href="https://www.google.com/url?q=https://conda.anaconda.org/intel/win-64&amp;source=gmail-html&amp;ust=1660823776006000&amp;usg=AOvVaw2BxJn7WsatdiLF_zCkcYk4" target="_blank" rel="noreferrer">https://conda.anaconda.org/<wbr>intel/win-64</a>'


</pre>
</div>
</div>

</div>

</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell m_jp-mod-noOutputs">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_kn">import</span> <span class="m_nn">numpy</span> <span class="m_k">as</span> <span class="m_nn">np</span>
<span class="m_kn">import</span> <span class="m_nn">matplotlib.pyplot</span> <span class="m_k">as</span> <span class="m_nn">plt</span>
<span class="m_kn">from</span> <span class="m_nn">matplotlib</span> <span class="m_kn">import</span> <span class="m_n">style</span>
<span class="m_n">style</span><span class="m_o">.</span><span class="m_n">use</span><span class="m_p">(</span><span class="m_s2">"ggplot"</span><span class="m_p">)</span>
<span class="m_kn">from</span> <span class="m_nn">sklearn</span> <span class="m_kn">import</span> <span class="m_n">svm</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell m_jp-mod-noOutputs">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_kn">from</span> <span class="m_nn">sklearn.model_selection</span> <span class="m_kn">import</span> <span class="m_n">GridSearchCV</span>
<span class="m_kn">from</span> <span class="m_nn">sklearn.metrics</span> <span class="m_kn">import</span> <span class="m_n">classification_report</span>
<span class="m_kn">from</span> <span class="m_nn">sklearn.svm</span> <span class="m_kn">import</span> <span class="m_n">SVC</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell m_jp-mod-noOutputs">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_k">def</span> <span class="m_nf">model</span><span class="m_p">(</span><span class="m_n">X_train</span><span class="m_p">,</span> <span class="m_n">Y_train</span><span class="m_p">,</span> <span class="m_n">X_test</span><span class="m_p">,</span> <span class="m_n">Y_test</span><span class="m_p">,</span> <span class="m_n">num_iterations</span> <span class="m_o">=</span> <span class="m_mi">2000</span><span class="m_p">,</span>     
          <span class="m_n">learning_rate</span> <span class="m_o">=</span> <span class="m_mf">0.5</span><span class="m_p">,</span> <span class="m_n">print_cost</span> <span class="m_o">=</span> <span class="m_kc">False</span><span class="m_p">):</span>
    <span class="m_n">X_train</span><span class="m_p">,</span> <span class="m_n">Y_train</span><span class="m_p">,</span> <span class="m_n">X_test</span><span class="m_p">,</span> <span class="m_n">Y_test</span><span class="m_p">,</span> <span class="m_n">classes</span> <span class="m_o">=</span> <span class="m_n">load_dataset</span><span class="m_p">()</span> 
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell m_jp-mod-noOutputs">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_kn">from</span> <span class="m_nn">sklearn.model_selection</span> <span class="m_kn">import</span> <span class="m_n">train_test_split</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell m_jp-mod-noOutputs">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_n">X_train</span><span class="m_p">,</span> <span class="m_n">X_test</span><span class="m_p">,</span> <span class="m_n">y_train</span><span class="m_p">,</span> <span class="m_n">y_test</span> <span class="m_o">=</span> <span class="m_n">train_test_split</span><span class="m_p">(</span><span class="m_n">X</span><span class="m_p">,</span> <span class="m_n">y</span><span class="m_p">,</span> <span class="m_n">test_size</span><span class="m_o">=</span><span class="m_mf">0.33</span><span class="m_p">,</span> <span class="m_n">random_state</span><span class="m_o">=</span><span class="m_mi">42</span><span class="m_p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_n">n_iter_search</span> <span class="m_o">=</span> <span class="m_mi">20</span>
<span class="m_n">random_search</span> <span class="m_o">=</span> <span class="m_n">RandomizedSearchCV</span><span class="m_p">(</span>
    <span class="m_n">SVC</span><span class="m_p">(),</span> 
    <span class="m_n">param_distributions</span><span class="m_o">=</span><span class="m_n">param_dist</span><span class="m_p"><wbr>,</span>
    <span class="m_n">n_iter</span><span class="m_o">=</span><span class="m_n">n_iter_search</span><span class="m_p">,</span> 
    <span class="m_n">refit</span><span class="m_o">=</span><span class="m_kc">True</span><span class="m_p">,</span>
    <span class="m_n">verbose</span><span class="m_o">=</span><span class="m_mi">3</span>
<span class="m_p">)</span>
<span class="m_n">random_search</span><span class="m_o">.</span><span class="m_n">fit</span><span class="m_p">(</span><span class="m_n">X_train</span><span class="m_p">,</span> <span class="m_n">y_train</span><span class="m_p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt"></div>


<div class="m_jp-RenderedText m_jp-OutputArea-output">
<pre>Fitting 5 folds for each of 20 candidates, totalling 100 fits
[CV 1/5] END ..C=5784.015611478875, gamma=0.6348098458952246; total time=   0.0s
[CV 2/5] END ..C=5784.015611478875, gamma=0.6348098458952246; total time=   0.0s
[CV 3/5] END ..C=5784.015611478875, gamma=0.6348098458952246; total time=   0.0s
[CV 4/5] END ..C=5784.015611478875, gamma=0.6348098458952246; total time=   0.0s
[CV 5/5] END ..C=5784.015611478875, gamma=0.6348098458952246; total time=   0.0s
[CV 1/5] END .C=1041.0884932688662, gamma=0.2886037144521339; total time=   0.0s
[CV 2/5] END .C=1041.0884932688662, gamma=0.2886037144521339; total time=   0.0s
[CV 3/5] END .C=1041.0884932688662, gamma=0.2886037144521339; total time=   0.0s
[CV 4/5] END .C=1041.0884932688662, gamma=0.2886037144521339; total time=   0.0s
[CV 5/5] END .C=1041.0884932688662, gamma=0.2886037144521339; total time=   0.0s
[CV 1/5] END C=7395.820511073424, gamma=1.636620248920493e-05; total time=   0.0s
[CV 2/5] END C=7395.820511073424, gamma=1.636620248920493e-05; total time=   0.0s
[CV 3/5] END C=7395.820511073424, gamma=1.636620248920493e-05; total time=   0.0s
[CV 4/5] END C=7395.820511073424, gamma=1.636620248920493e-05; total time=   0.0s
[CV 5/5] END C=7395.820511073424, gamma=1.636620248920493e-05; total time=   0.0s
[CV 1/5] END C=9349.930344046781, gamma=3.190271931756796e-05; total time=   0.0s
[CV 2/5] END C=9349.930344046781, gamma=3.190271931756796e-05; total time=   0.0s
[CV 3/5] END C=9349.930344046781, gamma=3.190271931756796e-05; total time=   0.0s
[CV 4/5] END C=9349.930344046781, gamma=3.190271931756796e-05; total time=   0.0s
[CV 5/5] END C=9349.930344046781, gamma=3.190271931756796e-05; total time=   0.0s
[CV 1/5] END C=2611.7142658134676, gamma=0.005247295566101093; total time=   0.0s
[CV 2/5] END C=2611.7142658134676, gamma=0.005247295566101093; total time=   0.0s
[CV 3/5] END C=2611.7142658134676, gamma=0.005247295566101093; total time=   0.0s
[CV 4/5] END C=2611.7142658134676, gamma=0.005247295566101093; total time=   0.0s
[CV 5/5] END C=2611.7142658134676, gamma=0.005247295566101093; total time=   0.0s
[CV 1/5] END C=3636.1475281289618, gamma=0.0038262847916735367; total time=   0.0s
[CV 2/5] END C=3636.1475281289618, gamma=0.0038262847916735367; total time=   0.0s
[CV 3/5] END C=3636.1475281289618, gamma=0.0038262847916735367; total time=   0.0s
[CV 4/5] END C=3636.1475281289618, gamma=0.0038262847916735367; total time=   0.0s
[CV 5/5] END C=3636.1475281289618, gamma=0.0038262847916735367; total time=   0.0s
[CV 1/5] END ..C=5643.756676655301, gamma=7.2139384647431415; total time=   0.0s
[CV 2/5] END ..C=5643.756676655301, gamma=7.2139384647431415; total time=   0.0s
[CV 3/5] END ..C=5643.756676655301, gamma=7.2139384647431415; total time=   0.0s
[CV 4/5] END ..C=5643.756676655301, gamma=7.2139384647431415; total time=   0.0s
[CV 5/5] END ..C=5643.756676655301, gamma=7.2139384647431415; total time=   0.0s
[CV 1/5] END C=7461.828988040585, gamma=6.2334765154271385e-06; total time=   0.0s
[CV 2/5] END C=7461.828988040585, gamma=6.2334765154271385e-06; total time=   0.0s
[CV 3/5] END C=7461.828988040585, gamma=6.2334765154271385e-06; total time=   0.0s
[CV 4/5] END C=7461.828988040585, gamma=6.2334765154271385e-06; total time=   0.0s
[CV 5/5] END C=7461.828988040585, gamma=6.2334765154271385e-06; total time=   0.0s
[CV 1/5] END C=8148.465988847073, gamma=0.0002567612523580688; total time=   0.0s
[CV 2/5] END C=8148.465988847073, gamma=0.0002567612523580688; total time=   0.0s
[CV 3/5] END C=8148.465988847073, gamma=0.0002567612523580688; total time=   0.0s
[CV 4/5] END C=8148.465988847073, gamma=0.0002567612523580688; total time=   0.0s
[CV 5/5] END C=8148.465988847073, gamma=0.0002567612523580688; total time=   0.0s
[CV 1/5] END C=3058.9683511550584, gamma=0.00047788091223949035; total time=   0.0s
[CV 2/5] END C=3058.9683511550584, gamma=0.00047788091223949035; total time=   0.0s
[CV 3/5] END C=3058.9683511550584, gamma=0.00047788091223949035; total time=   0.0s
[CV 4/5] END C=3058.9683511550584, gamma=0.00047788091223949035; total time=   0.0s
[CV 5/5] END C=3058.9683511550584, gamma=0.00047788091223949035; total time=   0.0s
[CV 1/5] END C=7996.271679755306, gamma=0.001575474169584064; total time=   0.0s
[CV 2/5] END C=7996.271679755306, gamma=0.001575474169584064; total time=   0.0s
[CV 3/5] END C=7996.271679755306, gamma=0.001575474169584064; total time=   0.0s
[CV 4/5] END C=7996.271679755306, gamma=0.001575474169584064; total time=   0.0s
[CV 5/5] END C=7996.271679755306, gamma=0.001575474169584064; total time=   0.0s
[CV 1/5] END C=989.483470278109, gamma=6.7766701776496975e-06; total time=   0.0s
[CV 2/5] END C=989.483470278109, gamma=6.7766701776496975e-06; total time=   0.0s
[CV 3/5] END C=989.483470278109, gamma=6.7766701776496975e-06; total time=   0.0s
[CV 4/5] END C=989.483470278109, gamma=6.7766701776496975e-06; total time=   0.0s
[CV 5/5] END C=989.483470278109, gamma=6.7766701776496975e-06; total time=   0.0s
[CV 1/5] END C=82.64916289705648, gamma=3.2977064407135514e-06; total time=   0.0s
[CV 2/5] END C=82.64916289705648, gamma=3.2977064407135514e-06; total time=   0.0s
[CV 3/5] END C=82.64916289705648, gamma=3.2977064407135514e-06; total time=   0.0s
[CV 4/5] END C=82.64916289705648, gamma=3.2977064407135514e-06; total time=   0.0s
[CV 5/5] END C=82.64916289705648, gamma=3.2977064407135514e-06; total time=   0.0s
[CV 1/5] END C=2987.6313141296855, gamma=8.066590548450658e-06; total time=   0.0s
[CV 2/5] END C=2987.6313141296855, gamma=8.066590548450658e-06; total time=   0.0s
[CV 3/5] END C=2987.6313141296855, gamma=8.066590548450658e-06; total time=   0.0s
[CV 4/5] END C=2987.6313141296855, gamma=8.066590548450658e-06; total time=   0.0s
[CV 5/5] END C=2987.6313141296855, gamma=8.066590548450658e-06; total time=   0.0s
[CV 1/5] END .C=73.65708767315061, gamma=0.01061302974403384; total time=   0.0s
[CV 2/5] END .C=73.65708767315061, gamma=0.01061302974403384; total time=   0.0s
[CV 3/5] END .C=73.65708767315061, gamma=0.01061302974403384; total time=   0.0s
[CV 4/5] END .C=73.65708767315061, gamma=0.01061302974403384; total time=   0.0s
[CV 5/5] END .C=73.65708767315061, gamma=0.01061302974403384; total time=   0.0s
[CV 1/5] END .C=6705.304331684204, gamma=0.11210343604000801; total time=   0.0s
[CV 2/5] END .C=6705.304331684204, gamma=0.11210343604000801; total time=   0.0s
[CV 3/5] END .C=6705.304331684204, gamma=0.11210343604000801; total time=   0.0s
[CV 4/5] END .C=6705.304331684204, gamma=0.11210343604000801; total time=   0.0s
[CV 5/5] END .C=6705.304331684204, gamma=0.11210343604000801; total time=   0.0s
[CV 1/5] END ..C=7861.511968109351, gamma=1.4755945955716254; total time=   0.0s
[CV 2/5] END ..C=7861.511968109351, gamma=1.4755945955716254; total time=   0.0s
[CV 3/5] END ..C=7861.511968109351, gamma=1.4755945955716254; total time=   0.0s
[CV 4/5] END ..C=7861.511968109351, gamma=1.4755945955716254; total time=   0.0s
[CV 5/5] END ..C=7861.511968109351, gamma=1.4755945955716254; total time=   0.0s
[CV 1/5] END ..C=5268.225920152972, gamma=0.7065375222749397; total time=   0.0s
[CV 2/5] END ..C=5268.225920152972, gamma=0.7065375222749397; total time=   0.0s
[CV 3/5] END ..C=5268.225920152972, gamma=0.7065375222749397; total time=   0.0s
[CV 4/5] END ..C=5268.225920152972, gamma=0.7065375222749397; total time=   0.0s
[CV 5/5] END ..C=5268.225920152972, gamma=0.7065375222749397; total time=   0.0s
[CV 1/5] END ..C=9191.726629358564, gamma=0.7447125438213701; total time=   0.0s
[CV 2/5] END ..C=9191.726629358564, gamma=0.7447125438213701; total time=   0.0s
[CV 3/5] END ..C=9191.726629358564, gamma=0.7447125438213701; total time=   0.0s
[CV 4/5] END ..C=9191.726629358564, gamma=0.7447125438213701; total time=   0.0s
[CV 5/5] END ..C=9191.726629358564, gamma=0.7447125438213701; total time=   0.0s
[CV 1/5] END ...C=717.1912477168623, gamma=5.152981519277561; total time=   0.0s
[CV 2/5] END ...C=717.1912477168623, gamma=5.152981519277561; total time=   0.0s
[CV 3/5] END ...C=717.1912477168623, gamma=5.152981519277561; total time=   0.0s
[CV 4/5] END ...C=717.1912477168623, gamma=5.152981519277561; total time=   0.0s
[CV 5/5] END ...C=717.1912477168623, gamma=5.152981519277561; total time=   0.0s
</pre>
</div>
</div>

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>




<div class="m_jp-RenderedText m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<pre>RandomizedSearchCV(estimator=<wbr>SVC(), n_iter=20,
                   param_distributions={'C': &lt;scipy.stats._distn_<wbr>infrastructure.rv_frozen object at 0x0000024EF5923280&gt;,
                                        'gamma': &lt;scipy.stats._distn_<wbr>infrastructure.rv_frozen object at 0x0000024EF324F0D0&gt;},
                   verbose=3)</pre>
</div>

</div>

</div>

</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_n">pd</span><span class="m_o">.</span><span class="m_n">read_csv</span><span class="m_p">(</span><span class="m_s2">"car_loans_clean.<wbr>csv"</span><span class="m_p">,</span> <span class="m_n">encoding</span><span class="m_o">=</span><span class="m_s1">'ISO-8859â1'</span><span class="m_p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>



<div class="m_jp-RenderedHTMLCommon m_jp-RenderedHTML m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<div>

<table border="1" class="m_dataframe">
  <thead>
    <tr style="text-align:right">
      <th></th>
      <th>working_status</th>
      <th>working_industry</th>
      <th>term</th>
      <th>product</th>
      <th>car_status</th>
      <th>num_interveners</th>
      <th>type_car</th>
      <th>Downpayment_ratio</th>
      <th>bad</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>F</td>
      <td>1.0</td>
      <td>6</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>73</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>F</td>
      <td>13.0</td>
      <td>36</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>F</td>
      <td>17.0</td>
      <td>25</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>F</td>
      <td>11.0</td>
      <td>71</td>
      <td>4</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>10</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>N</td>
      <td>10.0</td>
      <td>84</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>47</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>25580</th>
      <td>F</td>
      <td>16.0</td>
      <td>49</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>39</td>
      <td>0</td>
    </tr>
    <tr>
      <th>25581</th>
      <td>F</td>
      <td>1.0</td>
      <td>49</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>23</td>
      <td>0</td>
    </tr>
    <tr>
      <th>25582</th>
      <td>F</td>
      <td>8.0</td>
      <td>49</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>19</td>
      <td>0</td>
    </tr>
    <tr>
      <th>25583</th>
      <td>N</td>
      <td>10.0</td>
      <td>27</td>
      <td>4</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>31</td>
      <td>0</td>
    </tr>
    <tr>
      <th>25584</th>
      <td>A</td>
      <td>16.0</td>
      <td>20</td>
      <td>4</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>35</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>25585 rows Ã 9 columns</p>
</div>
</div>

</div>

</div>

</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell m_jp-mod-noOutputs">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_c1"># import random search, random forest, iris data, and distributions</span>
<span class="m_kn">from</span> <span class="m_nn">sklearn.model_selection</span> <span class="m_kn">import</span> <span class="m_n">RandomizedSearchCV</span>
<span class="m_kn">from</span> <span class="m_nn">sklearn</span> <span class="m_kn">import</span> <span class="m_n">datasets</span>
<span class="m_kn">from</span> <span class="m_nn">sklearn.ensemble</span> <span class="m_kn">import</span> <span class="m_n">RandomForestClassifier</span>
<span class="m_kn">from</span> <span class="m_nn">scipy.stats</span> <span class="m_kn">import</span> <span class="m_n">uniform</span><span class="m_p">,</span> <span class="m_n">truncnorm</span><span class="m_p">,</span> <span class="m_n">randint</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell m_jp-mod-noOutputs">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_n">model_params</span> <span class="m_o">=</span> <span class="m_p">{</span>
    <span class="m_c1"># randomly sample numbers from 4 to 204 estimators</span>
    <span class="m_s1">'n_estimators'</span><span class="m_p">:</span> <span class="m_n">randint</span><span class="m_p">(</span><span class="m_mi">4</span><span class="m_p">,</span><span class="m_mi">200</span><span class="m_p">),</span>
    <span class="m_c1"># normally distributed max_features, with mean .25 stddev 0.1, bounded between 0 and 1</span>
    <span class="m_s1">'max_features'</span><span class="m_p">:</span> <span class="m_n">truncnorm</span><span class="m_p">(</span><span class="m_n">a</span><span class="m_o">=</span><span class="m_mi">0</span><span class="m_p">,</span> <span class="m_n">b</span><span class="m_o">=</span><span class="m_mi">1</span><span class="m_p">,</span> <span class="m_n">loc</span><span class="m_o">=</span><span class="m_mf">0.25</span><span class="m_p">,</span> <span class="m_n">scale</span><span class="m_o">=</span><span class="m_mf">0.1</span><span class="m_p">),</span>
    <span class="m_c1"># uniform distribution from 0.01 to 0.2 (0.01 + 0.199)</span>
    <span class="m_s1">'min_samples_split'</span><span class="m_p">:</span> <span class="m_n">uniform</span><span class="m_p">(</span><span class="m_mf">0.01</span><span class="m_p">,</span> <span class="m_mf">0.199</span><span class="m_p">)</span>
<span class="m_p">}</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_c1"># create random forest classifier model</span>
<span class="m_n">rf_model</span> <span class="m_o">=</span> <span class="m_n">RandomForestClassifier</span><span class="m_p">()</span>

<span class="m_c1"># set up random search meta-estimator</span>
<span class="m_c1"># this will train 100 models over 5 folds of cross validation (500 models total)</span>
<span class="m_n">clf</span> <span class="m_o">=</span> <span class="m_n">RandomizedSearchCV</span><span class="m_p">(</span><span class="m_n">rf_model</span><span class="m_p">,</span> <span class="m_n">model_params</span><span class="m_p">,</span> <span class="m_n">n_iter</span><span class="m_o">=</span><span class="m_mi">100</span><span class="m_p">,</span> <span class="m_n">cv</span><span class="m_o">=</span><span class="m_mi">5</span><span class="m_p">,</span> <span class="m_n">random_state</span><span class="m_o">=</span><span class="m_mi">1</span><span class="m_p">)</span>

<span class="m_c1"># train the random search meta-estimator to find the best model out of 100 candidates</span>
<span class="m_n">model</span> <span class="m_o">=</span> <span class="m_n">clf</span><span class="m_o">.</span><span class="m_n">fit</span><span class="m_p">(</span><span class="m_n">X</span><span class="m_p">,</span> <span class="m_n">y</span><span class="m_p">)</span>

<span class="m_c1"># print winning set of hyperparameters</span>
<span class="m_kn">from</span> <span class="m_nn">pprint</span> <span class="m_kn">import</span> <span class="m_n">pprint</span>
<span class="m_n">pprint</span><span class="m_p">(</span><span class="m_n">model</span><span class="m_o">.</span><span class="m_n">best_estimator_</span><span class="m_o">.</span><span class="m_n">g<wbr>et_params</span><span class="m_p">())</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt"></div>


<div class="m_jp-RenderedText m_jp-OutputArea-output">
<pre>{'bootstrap': True,
 'ccp_alpha': 0.0,
 'class_weight': None,
 'criterion': 'gini',
 'max_depth': None,
 'max_features': 0.27357951242592654,
 'max_leaf_nodes': None,
 'max_samples': None,
 'min_impurity_decrease': 0.0,
 'min_impurity_split': None,
 'min_samples_leaf': 1,
 'min_samples_split': 0.02178939705901113,
 'min_weight_fraction_leaf': 0.0,
 'n_estimators': 34,
 'n_jobs': None,
 'oob_score': False,
 'random_state': None,
 'verbose': 0,
 'warm_start': False}
</pre>
</div>
</div>

</div>

</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_c1"># generate predictions using the best-performing model</span>
<span class="m_n">predictions</span> <span class="m_o">=</span> <span class="m_n">model</span><span class="m_o">.</span><span class="m_n">predict</span><span class="m_p">(</span><span class="m_n">X</span><span class="m_p">)</span>
<span class="m_nb">print</span><span class="m_p">(</span><span class="m_n">predictions</span><span class="m_p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt"></div>


<div class="m_jp-RenderedText m_jp-OutputArea-output">
<pre>[0 0 1 1 0 1 1 0 1 0 1 0 0 0 0 0 0 0 0 0 1 0 1 1 0 1 0 1 0 1 0 0 1 0 1 0 1
 0 0 1 1 1 0 0 1 0 0 1 1 0 1 1 1 0 0 0 0 1 0 0 0 0 0 1 1 1 0 0 1 0 0 1 0 0
 1 0 0 1 0 1 1 0 0 1 1 1 0 1 0 1 0 0 0 0 0 1 1 0 1 1 0 1 0 1 1 0 0 0 1 1 1
 1 0 1 0 1 0 1 1 0 1 0 1 1 0 0 0 1 0 1 1 1 0 1 0 0 1 0 0 0 1 1 1 0 0 1 0 0
 0 0 1 0 0 0 0 1 1 1 1 1 1 1 0 0 1 1 0 1 0 0 1 0 1 0 0 0 0 0 0 0 0 0 1 1 0
 1 1 1 1 1 0 0 1 0 1 1 1 0 1 1 0 0 0 1 1 1 0 0 0 0 1 1 1 0 1 1 1 0 1 0 1 0
 1 1 1 1 1 0 1 0 1 1 1 0 0 0 1 0 0 0 1 0 0 1 1 0 0 1 0 0 0 1 1 0 1 1 1 0 1
 1 0 0 0 1 0 1 0 0 0 1 0 0 0 1 0 1 1 0 1 1 1 0 0 1 1 0 0 0 0 0 1 0 0 1 0 1
 1 1 1 1 1 1 0 0 0 1 0 0 0 0 0 0 1 1 0 0 1 0 0 0 1 1 0 0 1 0 1 0 0 0 1 1 0
 0 1 1 1 0 0 1 1 0 1 1 0 0 1 0 0 1 0 1 1 0 1 1 1 0 0 0 0 1 1 0 0 1 0 0 1 0
 1 1 0 0 1 0 1 0 0 0 0 1 1 0 0 1 0 0 0 0 0 1 1 1 1 0 1 0 1 0 1 1 0 0 1 0 0
 0 0 1 1 1 1 1 0 0 0 0 0 0 0 1 1 0 1 0 1 0 1 0 1 0 1 1 0 1 1 0 0 1 0 1 0 1
 0 1 1 1 1 1 1 0 1 0 1 0 1 0 0 1 0 1 1 0 0 1 1 0 0 0 1 1 0 1 1 1 0 0 0 1 1
 1 0 1 1 1 1 1 1 1 0 0 0 0 1 0 1 1 0 0 0 1 1 1 0 1 0 0 0 0 0 0 0 1 0 0 1 0
 1 0 1 0 0 0 0 1 0 0 1 0 0 1 1 0 1 0 1 1 1 0 0 1 1 0 1 0 1 1 0 0 1 1 1 0 0
 1 1 0 1 0 1 0 0 1 0 0 0 1 1 0 1 0 0 0 0 1 0 1 0 1 0 1 0 1 1 0 1 0 1 0 0 0
 1 0 0 1 1 0 1 1 1 1 0 0 0 1 0 0 0 1 0 0 0 0 1 0 0 0 1 1 0 1 0 1 1 1 1 1 0
 1 0 0 0 1 1 1 1 0 0 0 1 1 1 1 0 1 1 1 1 1 0 1 1 0 1 1 0 0 1 1 1 0 0 1 1 1
 1 0 1 1 1 1 1 0 1 0 1 0 1 0 1 1 0 1 1 0 0 0 1 0 1 1 0 1 0 0 1 1 0 1]
</pre>
</div>
</div>

</div>

</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_o">&gt;&gt;&gt;</span> <span class="m_kn">from</span> <span class="m_nn">sklearn.model_selection</span> <span class="m_kn">import</span> <span class="m_n">GridSearchCV</span>
<span class="m_o">&gt;&gt;&gt;</span> <span class="m_kn">from</span> <span class="m_nn">sklearn.calibration</span> <span class="m_kn">import</span> <span class="m_n">CalibratedClassifierCV</span>
<span class="m_o">&gt;&gt;&gt;</span> <span class="m_kn">from</span> <span class="m_nn">sklearn.ensemble</span> <span class="m_kn">import</span> <span class="m_n">RandomForestClassifier</span>
<span class="m_o">&gt;&gt;&gt;</span> <span class="m_kn">from</span> <span class="m_nn">sklearn.datasets</span> <span class="m_kn">import</span> <span class="m_n">make_moons</span>
<span class="m_o">&gt;&gt;&gt;</span> <span class="m_n">X</span><span class="m_p">,</span> <span class="m_n">y</span> <span class="m_o">=</span> <span class="m_n">make_moons</span><span class="m_p">()</span>
<span class="m_o">&gt;&gt;&gt;</span> <span class="m_n">calibrated_forest</span> <span class="m_o">=</span> <span class="m_n">CalibratedClassifierCV</span><span class="m_p">(</span>
<span class="m_o">...</span>    <span class="m_n">base_estimator</span><span class="m_o">=</span><span class="m_n">RandomForestCla<wbr>ssifier</span><span class="m_p">(</span><span class="m_n">n_estimators</span><span class="m_o">=</span><span class="m_mi">10</span><span class="m_p">))</span>
<span class="m_o">&gt;&gt;&gt;</span> <span class="m_n">param_grid</span> <span class="m_o">=</span> <span class="m_p">{</span>
<span class="m_o">...</span>    <span class="m_s1">'base_estimator__max_depth'</span><span class="m_p">:</span> <span class="m_p">[</span><span class="m_mi">2</span><span class="m_p">,</span> <span class="m_mi">4</span><span class="m_p">,</span> <span class="m_mi">6</span><span class="m_p">,</span> <span class="m_mi">8</span><span class="m_p">]}</span>
<span class="m_o">&gt;&gt;&gt;</span> <span class="m_n">search</span> <span class="m_o">=</span> <span class="m_n">GridSearchCV</span><span class="m_p">(</span><span class="m_n">calibrated_forest</span><span class="m_p"><wbr>,</span> <span class="m_n">param_grid</span><span class="m_p">,</span> <span class="m_n">cv</span><span class="m_o">=</span><span class="m_mi">5</span><span class="m_p">)</span>
<span class="m_o">&gt;&gt;&gt;</span> <span class="m_n">search</span><span class="m_o">.</span><span class="m_n">fit</span><span class="m_p">(</span><span class="m_n">X</span><span class="m_p">,</span> <span class="m_n">y</span><span class="m_p">)</span>
<span class="m_n">GridSearchCV</span><span class="m_p">(</span><span class="m_n">cv</span><span class="m_o">=</span><span class="m_mi">5</span><span class="m_p">,</span>
             <span class="m_n">estimator</span><span class="m_o">=</span><span class="m_n">CalibratedClassifier<wbr>CV</span><span class="m_p">(</span><span class="m_o">...</span><span class="m_p">),</span>
             <span class="m_n">param_grid</span><span class="m_o">=</span><span class="m_p">{</span><span class="m_s1">'base_estimator__<wbr>max_depth'</span><span class="m_p">:</span> <span class="m_p">[</span><span class="m_mi">2</span><span class="m_p">,</span> <span class="m_mi">4</span><span class="m_p">,</span> <span class="m_mi">6</span><span class="m_p">,</span> <span class="m_mi">8</span><span class="m_p">]})</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt">Out[&nbsp;]:</div>




<div class="m_jp-RenderedText m_jp-OutputArea-output m_jp-OutputArea-executeResult">
<pre>GridSearchCV(cv=5, estimator=<wbr>CalibratedClassifierCV(base_<wbr>estimator=Ellipsis),
             param_grid={'base_estimator__<wbr>max_depth': [2, 4, 6, 8]})</pre>
</div>

</div>

</div>

</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell m_jp-mod-noOutputs">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_c1"># set up random search meta-estimator</span>
<span class="m_c1"># this will train 100 models over 5 folds of cross validation (500 models total)</span>
<span class="m_n">clf</span> <span class="m_o">=</span> <span class="m_n">RandomizedSearchCV</span><span class="m_p">(</span><span class="m_n">rf_model</span><span class="m_p">,</span> <span class="m_n">model_params</span><span class="m_p">,</span> <span class="m_n">n_iter</span><span class="m_o">=</span><span class="m_mi">100</span><span class="m_p">,</span> <span class="m_n">cv</span><span class="m_o">=</span><span class="m_mi">5</span><span class="m_p">,</span> <span class="m_n">random_state</span><span class="m_o">=</span><span class="m_mi">1</span><span class="m_p">)</span>

<span class="m_c1"># train the random search meta-estimator to find the best model out of 100 candidates</span>
<span class="m_n">model</span> <span class="m_o">=</span> <span class="m_n">clf</span><span class="m_o">.</span><span class="m_n">fit</span><span class="m_p">(</span><span class="m_n">X</span><span class="m_p">,</span> <span class="m_n">y</span><span class="m_p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="m_jp-Cell m_jp-CodeCell m_jp-Notebook-cell">
<div class="m_jp-Cell-inputWrapper">
<div class="m_jp-InputArea m_jp-Cell-inputArea">
<div class="m_jp-InputPrompt m_jp-InputArea-prompt">In&nbsp;[&nbsp;]:</div>
<div class="m_jp-CodeMirrorEditor m_jp-Editor m_jp-InputArea-editor">
     <div class="m_CodeMirror m_cm-s-jupyter">
<div class="m_highlight m_hl-ipython3"><pre><span></span><span class="m_n">pprint</span><span class="m_p">(</span><span class="m_n">model</span><span class="m_o">.</span><span class="m_n">best_estimator_</span><span class="m_o">.</span><span class="m_n">g<wbr>et_params</span><span class="m_p">())</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="m_jp-Cell-outputWrapper">


<div class="m_jp-OutputArea m_jp-Cell-outputArea">

<div class="m_jp-OutputArea-child">

    
    <div class="m_jp-OutputPrompt m_jp-OutputArea-prompt"></div>


<div class="m_jp-RenderedText m_jp-OutputArea-output">
<pre>{'bootstrap': True,
 'ccp_alpha': 0.0,
 'class_weight': None,
 'criterion': 'gini',
 'max_depth': None,
 'max_features': 0.31856683723468987,
 'max_leaf_nodes': None,
 'max_samples': None,
 'min_impurity_decrease': 0.0,
 'min_impurity_split': None,
 'min_samples_leaf': 1,
 'min_samples_split': 0.04819925956924866,
 'min_weight_fraction_leaf': 0.0,
 'n_estimators': 120,
 'n_jobs': None,
 'oob_score': False,
 'random_state': None,
 'verbose': 0,
 'warm_start': False}
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="m_jp-Cell-inputWrapper"><div class="m_jp-InputPrompt m_jp-InputArea-prompt">
</div><div class="m_jp-RenderedHTMLCommon m_jp-RenderedMarkdown m_jp-MarkdownOutput">
<h3 id="m_Evaluación-del-modelo:-Gini-(AUC)-y-curva-ROC">Evaluación del modelo: Gini (AUC) y curva ROC<a class="m_anchor-link" href="https://mail-attachment.googleusercontent.com/attachment/u/2/?ui=2&amp;ik=5113226a7d&amp;attid=0.1&amp;permmsgid=msg-a:r489306242194221422&amp;th=17d741ad8789dc5f&amp;view=att&amp;disp=inline&amp;realattid=f_kwmzmtw65&amp;ser=1&amp;saddbat=ANGjdJ84PnBDA4LbNStn5wChHnm3K_vPuZhVllcGrlOQUI9JnKugcwg0-fy6BrktcTOolNRvffp3YhjKSWZUeUBN0XjzR8iu9Au9AZOiDd8hANRVARh4rEJ1874ffHrQ-ggOs9uc4PrvJAa_9Zun_DkI7KOEoJbTul2oB7yCSzT-QGLKEIu8Dk2vPNrbEk-yIE8ovRwsdS9VzC9ra7iSQjESxcr7NFWdethLSyyfMU_yZXXNfViq3DqMbO5ivNEXCdju7WWPTTNCYDMi3kPYhWb4XJsHW_QnPKI-8j-ld07TdYfkyz5ldItb6N6_fIh-96LGD9QfnuQHf9gM2tLk9fEjxHMZ3oCJ9ikWWoAzbRbG78iYwmasTDlC7ODuw9i85XQGFPVp6Z1WlDk-R0Lg14AIcA0Oncn9oGtwCqct1CX-iUniEuE5bIONSMmFIedePodV3RuCRZGSAfmC2Fy4sg7FurPk8e1vA506ZHTacOLdhOlPPZMef4fcFRMSQ_aYp5uCIfHR-FWyCPMUxUfkvpF42vprc5h_m5wtad4CRuPunhCZpqWuwBjIB3MRSSDKOfxGrTIhLvOtsQx-Q_B6CVuW3k2CnjG56iigBIoKGtyoZ0w4jSXFR5Zw6IakUy-Wf2r8_tS7MHka3cnK4Gbkfu03JMWKKXDYeQylCUpnlluNjhw-BBTo-SGv_RXtfdTiezgC_87gZDXCHq6IyngAjMpyY--rhsyqV4Mw0hbg17t6wYGgllFOqAVCWjWQamzuyk_QVhuMZ9LP4OcjDWrmkc1MgkQqxzZMCfVZn9LRvP9j2upoV-PDVu0r1MK4G30HprPfk8urnwHBTZ__CxQNlTHqOyjkUSp9DCvMQO0WvYzA73Rkr7ATDsHn_Dzm1eg#m__Evaluaci%C3%B3n-del-modelo:-Gini-(AUC)-y-curva-ROC" rel="noreferrer">¶</a></h3>
</div>
</div>
<div class="m_jp-Cell-inputWrapper"><div class="m_jp-InputPrompt m_jp-InputArea-prompt">
</div><div class="m_jp-RenderedHTMLCommon m_jp-RenderedMarkdown m_jp-MarkdownOutput">
<p>Como conclusion, podemos decir que entre algunos modelos existe gran paridad entre los resultados, ya que no tenemos un modelo que sea significativamente mejor que el otro.
El modelo que mejor se comporta es el de Regresion lineal ya que cuenta con valores de TRAIN = 68.17, y de TEST = 62.63. Con respecto al AUC no sa un resultado de 0.81, frente a 0.80 de Random Forest y de XGBOOST.</p>
<p>Por otra parte, ingresamos algunos resultados del modelo Random Search pero no se llego a resultados concluyentes al respecto para determinar si este modelo es superior al resto de los modelos evaluados.</p>

</div>
</div>
<div class="m_jp-Cell-inputWrapper"><div class="m_jp-InputPrompt m_jp-InputArea-prompt">
</div><div class="m_jp-RenderedHTMLCommon m_jp-RenderedMarkdown m_jp-MarkdownOutput">

</div>
</div>
</div>








</body></html>